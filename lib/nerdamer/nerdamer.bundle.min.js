var _Mathceil=Math.ceil,_MathE=Math.E,_Mathlog2=Math.log10,_Mathatanh=Math.atanh,_Mathacosh=Math.acosh,_Mathasinh=Math.asinh,_Mathtanh=Math.tanh,_Mathsinh=Math.sinh,_Mathcosh=Math.cosh,_Mathsign=Math.sign,_Mathlog=Math.log,_MathPI=Math.PI,_Mathexp=Math.exp,_Mathtan=Math.tan,_Mathcos=Math.cos,_Mathsin=Math.sin,_Mathround=Math.round,_Mathpow=Math.pow,_Mathmin=Math.min,_Mathmax=Math.max,_Mathfloor=Math.floor,_Mathsqrt=Math.sqrt,_Mathabs=Math.abs,nerdamer=function(u){'use strict';function h(yt,ht,ft){var bt='hash'===ht,vt='decimals'===ht||'decimal'===ht,wt=bt?void 0:ht;if(Oe(yt)){var xt='',St='',qt='',Et=yt.group||ft,Pt=yt.value;if(!bt){var Ct=vt?yt.multiplier.valueOf():yt.multiplier.toString();'-1'==Ct&&(qt='-',Ct='1'),'1'!=Ct&&(xt=Ct);var Ot=yt.power?vt?yt.power.valueOf():yt.power.toString():'';'1'!=Ot&&(Oe(Ot)?St=h(Ot,wt):St=Ot)}switch(Et){case ee:xt='',Pt='-1'==yt.multiplier?'1':vt?yt.valueOf():yt.multiplier.toString(),St='';break;case oe:Pt=yt.collectSymbols(h,wt).join('+').replace(/\+\-/g,'-');break;case ne:Pt=yt.collectSymbols(h,wt).join('+').replace(/\+\-/g,'-');break;case re:Pt=yt.collectSymbols(function(Lt){var Ut=Lt.group;return(Ut===oe||Ut===ne)&&Lt.power.equals(1)&&Lt.multiplier.equals(1)?Ue(h(Lt,wt)):h(Lt,wt)}).join('*');break;case ie:var At=yt.previousGroup,jt=yt.power.group;At===oe&&(Pt=yt.collectSymbols(h,wt).join('+').replace('+-','-')),At===ee||At===le||At===se||bt||(Pt=Ue(Pt)),(jt===ne||jt===re||jt===oe||'1'!=yt.power.multiplier.toString())&&St&&(St=Ue(St));}Et===se&&vt&&(Pt=yt.fname+Ue(yt.args.map(function(Lt){return h(Lt,wt)}).join(','))),!St||De(St)||Et===ie||vt||(St=Ue(St)),((Et===ne||Et===oe)&&(xt&&'1'!=xt||'-'==qt)||(Et===re||Et===ne||Et===oe)&&St&&'1'!=St||!bt&&Et===te&&-1==Pt||yt.fname===pe)&&(Pt=Ue(Pt));var Rt=qt+xt;!xt||De(xt)||vt||(Rt=Ue(Rt)),0>St&&(St=Ue(St)),xt&&(Rt+='*'),St&&(St='^'+St),Et===ie&&'-'===Pt.charAt(0)&&(Pt=Ue(Pt));var Mt=Rt+Pt;return yt.parens&&(Mt=Ue(Mt)),Mt+St}if(je(yt)){for(var Nt=yt.elements.length,Rt=[],Dt=0;Dt<Nt;Dt++)Rt.push(yt.elements[Dt].text());return'['+Rt.join(',')+']'}try{return yt.toString()}catch(Lt){return''}}function O(yt){this.symbol=yt}function R(yt){if(yt instanceof R)return yt;if(void 0===yt)return this;if(De(yt))this.num=Y(yt),this.den=Y(1);else{var ht=at.convert(yt);this.num=new Y(ht[0]),this.den=new Y(ht[1])}}function D(yt){return this instanceof D?(isNaN(yt)||'Infinity'===yt?(this.group=le,Se(yt),this.value=yt,this.multiplier=new R(1),this.imaginary=yt===$.IMAGINARY):(this.group=ee,this.value=ae,this.multiplier=new R(yt)),this.power=new R(1),this):new D(yt)}function L(yt){if(Pe(yt))return[yt];for(var ht=yt,ft=1,bt=[];ft<ht;){var wt=yt/ft,xt=_Mathfloor(wt);2.220446049250313e-16>=wt-xt&&1<ft&&(-1!==J.indexOf(ft)&&bt.push(ft),ht=xt),ft++}return bt.sort(function(qt,Et){return qt-Et})}function U(yt,ht,ft,bt,vt,wt,xt){this.val=yt,this.fn=ht,this.precedence=ft,this.left_assoc=bt,this.is_prefix=vt,this.is_postfix=wt||!1,this.operation=xt,this.is_operator=!0}function T(yt,ht,ft,bt){this.val=yt,this.bracket_id=ht,this.open=!!ft,this.fn=bt}function I(yt){this.operation=yt.operation,this.val=yt.val,this.is_prefix_operator=!0}function G(){function yt(ll){return $.PARSE2NUMBER?ll:Ht.symfunction('parens',[ll])}function ht(ll){if(ll.multiplier.lessThan(0)&&ll.multiplier.negate(),Me(ll)||We(ll.power))return ll;if(ll.isComposite()){var il=[];ll.each(function(nl){il.push(nl.multiplier)});var ol=nt.QGCD.apply(null,il);ol.lessThan(0)&&(ll.multiplier=ll.multiplier.multiply(new R(-1)),ll.distributeMultiplier())}return Ht.symfunction(ce,[ll])}function ft(ll){var il;return $.PARSE2NUMBER&&ll.isConstant()?(il=De(ll)?nt.bigfactorial(ll):nt.gamma(ll.multiplier.toDecimal()+1),Et(il)):Ht.symfunction(ge,[ll])}function wt(ll){if(''===ll.fname&&ll.power.equals(1)&&(ll=ll.args[0]),$.PARSE2NUMBER&&ll.isConstant()&&!ll.multiplier.lessThan(0))return new D(_Mathsqrt(ll.multiplier.toDecimal()));var il,ol,nl=ll.isConstant();if(ll.group===re&&ll.isLinear()){var al=wt(D(ll.multiplier));for(var pl in ll.symbols){var ul=ll.symbols[pl];al=Ht.multiply(al,wt(ul))}ol=al}else if(ll.fname===me){var pl=ll.args[0];pl.setPower(ll.power.multiply(new R(0.25))),ol=pl}else if(!ll.power.isInteger())ll.setPower(ll.power.multiply(new R(0.5))),ol=ll;else{nl&&ll.multiplier.lessThan(0)&&(il=D.imaginary(),ll.multiplier=ll.multiplier.abs());var al,ml=ll.multiplier.toDecimal(),cl=_Mathabs(ml),gl=_Mathsqrt(cl);if(De(gl))al=new D(gl);else if(De(ml)){var dl=nt.ifactor(ml),yl=1;for(var ul in dl){var hl=dl[ul],fl=hl-hl%2;if(fl){var bl=_Mathpow(ul,fl);yl*=_Mathpow(ul,fl/2),ml/=bl}}al=Ht.multiply(Ht.symfunction(me,[new D(ml)]),new D(yl))}else{var hl=ll.multiplier.num.toString(),vl=ll.multiplier.den.toString(),wl=_Mathsqrt(hl),xl=_Mathsqrt(vl);al=Ht.multiply('1'===hl?new D(1):De(wl)?new D(wl):Ht.symfunction(me,[new D(hl)]),'1'===vl?new D(1):De(xl)?new D(xl).invert():Ht.symfunction(me,[new D(vl)]).invert())}ll=ll.toUnitMultiplier(!0),ol=ll.isOne()?ll:We(ll.power.toString())?Ht.pow(ll.clone(),new D(0.5)):Ht.symfunction(me,[ll]),al&&(ol=Ht.multiply(al,ol)),il&&(ol=Ht.multiply(il,ol))}return ol}function xt(ll){var il=new D(1);if(ll.isConstant()){var ol=ll.multiplier.toDecimal();if(De(ol)){var nl=nt.ifactor(ol);for(var al in nl){var pl=nl[al];il=Ht.multiply(il,Ht.symfunction('parens',[new D(al).setPower(pl)]))}}else{var ul=xt(new D(ll.multiplier.num)),ml=xt(new D(ll.multiplier.den));il=Ht.multiply(Ht.symfunction('parens',[ul]),Ht.symfunction('parens',[ml]).invert())}}return il}function St(ll){var il;if(ll.equals(0)&&we('log(0) is undefined!'),ll.group===ie&&ll.power.multiplier.lessThan(0)||'-1'===ll.power.toString())ll.power.negate(),il=St(ll).negate();else if('e'===ll.value&&ll.multiplier.equals(1)){var ol=ll.power;il=Oe(ol)?ol:new D(ol)}else if(ll.group===se&&'exp'===ll.fname){var nl=ll.args[0];il=ll.multiplier.equals(1)?Ht.multiply(nl,new D(ll.power)):Ht.symfunction('log',[ll])}else if($.PARSE2NUMBER&&Me(ll)){var al;ll.multiplier.lessThan(0)&&(ll.negate(),al=Ht.multiply(new D(_MathPI),new D('i'))),il=new D(_Mathlog(ll.multiplier.toDecimal())),al&&(il=Ht.add(il,al))}else{var nl;ll.power.equals(1)||(nl=ll.group===ie?ll.power:new D(ll.power),ll.toLinear()),il=Ht.symfunction('log',[ll]),nl&&(il=Ht.multiply(nl,il))}return il}function qt(ll){var ol,il=ll%2;return 0>il&&(il=2+il),ol=0<=il&&0.5>=il?1:0.5<il&&1>=il?2:1<il&&1.5>=il?3:4,ol}function Et(ll){if(Oe(ll))return ll;'number'==typeof ll&&(ll=R.simple(ll));var il=new D(0);return il.multiplier=ll,il}function Mt(ll){if(!ll.symbols)return ll;var il=ll.clone();try{var ol=ll.power,nl=ll.multiplier,al=+ol;if(!ll.symbols)return ll;for(var pl in ll.symbols){var ul=ll.symbols[pl];ll.symbols[pl]=Mt(ul)}if(ll=Ht.parse(ll),De(ol)&&0<al&&ll.isComposite()){ll=ll.toLinear().toUnitMultiplier();for(var gl,ml=ll.clone(),cl=0;cl<al-1;cl++){for(var pl in gl=new D(0),ll.symbols){var ul=ll.symbols[pl];for(var dl in ml.symbols){var yl=ml.symbols[dl],hl=Ht.expand(Ht.multiply(ul.clone(),yl.clone())),fl=+hl.power;(hl.group===re&&1!=fl||hl.group===oe&&1!=fl)&&(hl=Mt(hl)),gl=Ht.add(gl,hl)}}ml=gl}if(!nl.equals(1))for(var pl in ml.symbols){var ul=ml.symbols[pl];ul.multiplier=ul.multiplier.multiply(nl),ul.isComposite()&&ul.distributeMultiplier(),ll.symbols[pl]=ul}return ml}if(ll.group===re){var bl=!1,vl=ll.power;for(var ul in ll.symbols){var wl=ll.symbols[ul];if(wl.isComposite()){bl=!0;break}Oe(wl.power)||Oe(vl)?(wl.power=Ht.multiply(wl.power,D(vl)),wl.group=ie):wl.power=wl.power.multiply(vl)}if(ll.toLinear(),ll=Ht.parse(ll.text()),!bl)return ll;var ml=new D(0),xl=[],Sl=new D(ll.multiplier);for(var pl in ll.symbols){var ul=ll.symbols[pl];if(ul.isComposite()){var ol=ul.power,ql=!1;De(ol)&&0>ol&&(ul.power.negate(),ql=!0),ql?(ul.power.negate(),Sl=Ht.multiply(Sl,ul)):xl.push(ul)}else Sl=Ht.multiply(Sl,ul)}var El=xl.length;ml=xl[0];for(var cl=1;cl<El;cl++){var gl=new D(0),pl=xl[cl];for(var Pl in ml.symbols){var ul=ml.symbols[Pl];for(var dl in pl.symbols){var yl=pl.symbols[dl],Cl=Ht.multiply(ul.clone(),yl.clone());gl=Ht.add(gl,Cl)}}ml=gl}var Ol=new D(0);for(var pl in ml.symbols){var ul=ml.symbols[pl];Ol=Ht.add(Ol,Mt(Ht.multiply(Sl,ul)))}ll=Ol}}catch(Al){return il}return ll}function Tt(){return new Z([].slice.call(arguments))}function It(){return H.fromArray(arguments)}function Ft(ll,il){return je(ll)&&je(il)?ll.dot(il):void we('function dot expects 2 vectors')}function Gt(ll){return Re(ll)?ll.transpose():void we('function transpose expects a matrix')}function Vt(ll){return Re(ll)?ll.invert():void we('invert expects a matrix')}function Zt(ll){if(!Oe(ll.power)&&ll.power.absEquals(0.5)){var il=ll.power.sign();return wt(ll.group===te?new D(ll.value):ll.toLinear()).setPower(new R(il))}return ll}function zt(ll){if(ll.group===te){var il=ll.group===ee?ll.multiplier.toDecimal():ll.value,ol=L(il)[0],nl=new R(_Mathlog(il)/_Mathlog(ol)),al=nl.multiply(ll.power);if(al.den>ll.power.den)return ll;ll=De(al)?D(_Mathpow(ol,al)):new D(ol).setPower(al)}return ll}var Ht=this,Qt={},Xt=this.constants={PI:_MathPI,E:_MathE},Yt={e:_MathE,pi:_MathPI},Wt=this.operators={'^':new U('^','pow',6,!1,!1),'!!':new U('!!','dfactorial',5,!1,!1,!0,function(ll){return Ht.symfunction(de,[ll])}),'!':new U('!','factorial',5,!1,!1,!0,function(ll){return Ht.symfunction(ge,[ll])}),'!+':new U('!+','factadd',3,!0,!0,!1),'!!+':new U('!!+','dfactadd',3,!0,!0,!1),'!-':new U('!-','factsub',3,!0,!0,!1),'!!-':new U('!!-','dfactsub',3,!0,!0,!1),'*':new U('*','multiply',4,!0,!1),'/':new U('/','divide',4,!0,!1),'+':new U('+','add',3,!0,!0,!1,function(ll){return ll}),'-':new U('-','subtract',3,!0,!0,!1,function(ll){return ll.negate()}),'=':new U('=','equals',2,!1,!1),'==':new U('==','eq',1,!1,!1),'<':new U('<','lt',1,!1,!1),'<=':new U('<=','lte',1,!1,!1),'>':new U('>','gt',1,!1,!1),'>=':new U('>=','gte',1,!1,!1),',':new U(',','comma',0,!0,!1)},Jt={'(':new T('(',0,!0),')':new T(')',0,!1),'[':new T('[',1,!0,function(){return'vector'}),']':new T(']',1,!1)},Kt=this.functions={cos:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(_Mathcos(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier.abs();if(ll.multiplier=al,ll.isPi()&&ll.isLinear())if(De(al))il=new D(We(al)?1:-1);else{var pl=al.num,ul=al.den;2==ul?il=new D(0):3==ul?(il=Ht.parse('1/2'),ol=!0):4==ul?(il=Ht.parse('1/sqrt(2)'),ol=!0):6==ul?(il=Ht.parse('sqrt(3)/2'),ol=!0):il=Ht.symfunction('cos',[ll])}return ol&&(2===nl||3===nl)&&il.negate(),il||(il=Ht.symfunction('cos',[ll])),il},1],sin:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(_Mathsin(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier.sign(),pl=ll.multiplier.abs();if(ll.multiplier=pl,ll.isPi()&&ll.isLinear())if(De(pl))il=new D(0);else{var ul=pl.num,ml=pl.den;2==ml?(il=new D(1),ol=!0):3==ml?(il=Ht.parse('sqrt(3)/2'),ol=!0):4==ml?(il=Ht.parse('1/sqrt(2)'),ol=!0):6==ml?(il=Ht.parse('1/2'),ol=!0):il=Ht.symfunction('sin',[ll])}return il||(il=Ht.multiply(new D(al),Ht.symfunction('sin',[ll]))),ol&&(3===nl||4===nl)&&il.negate(),il},1],tan:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(_Mathtan(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier;if(ll.multiplier=al,ll.isPi()&&ll.isLinear())if(De(al))il=new D(0);else{var pl=al.num,ul=al.den;2==ul?we('tan is undefined for '+ll.toString()):3==ul?(il=Ht.parse('sqrt(3)'),ol=!0):4==ul?(il=new D(1),ol=!0):6==ul?(il=Ht.parse('1/sqrt(3)'),ol=!0):il=Ht.symfunction('tan',[ll])}return il||(il=Ht.symfunction('tan',[ll])),ol&&(2===nl||4===nl)&&il.negate(),il},1],sec:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(nt.sec(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier.abs();if(ll.multiplier=al,ll.isPi()&&ll.isLinear())if(De(al))il=new D(We(al)?1:-1);else{var pl=al.num,ul=al.den;2==ul?we('sec is undefined for '+ll.toString()):3==ul?(il=new D(2),ol=!0):4==ul?(il=Ht.parse('sqrt(2)'),ol=!0):6==ul?(il=Ht.parse('2/sqrt(3)'),ol=!0):il=Ht.symfunction('sec',[ll])}return ol&&(2===nl||3===nl)&&il.negate(),il||(il=Ht.symfunction('sec',[ll])),il},1],csc:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(nt.csc(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier.abs();if(ll.multiplier=al,ll.isPi()&&ll.isLinear())if(De(al))we('csc is undefined for '+ll.toString());else{var pl=al.num,ul=al.den;2==ul?(il=new D(1),ol=!0):3==ul?(il=Ht.parse('2/sqrt(3)'),ol=!0):4==ul?(il=Ht.parse('sqrt(2)'),ol=!0):6==ul?(il=new D(2),ol=!0):il=Ht.symfunction('csc',[ll])}return il||(il=Ht.symfunction('csc',[ll])),ol&&(3===nl||4===nl)&&il.negate(),il},1],cot:[function(ll){if($.PARSE2NUMBER&&ll.isConstant())return new D(nt.cot(ll.valueOf()));var il,ol=!1,nl=qt(ll.multiplier.toDecimal()),al=ll.multiplier;if(ll.multiplier=al,ll.isPi()&&ll.isLinear())if(De(al))we('cot is undefined for '+ll.toString());else{var pl=al.num,ul=al.den;2==ul?il=new D(0):3==ul?(il=Ht.parse('1/sqrt(3)'),ol=!0):4==ul?(il=new D(1),ol=!0):6==ul?(il=Ht.parse('sqrt(3)'),ol=!0):il=Ht.symfunction('cot',[ll])}return il||(il=Ht.symfunction('cot',[ll])),ol&&(2===nl||4===nl)&&il.negate(),il},1],acos:[,1],asin:[,1],atan:[,1],sinh:[,1],cosh:[,1],tanh:[,1],asinh:[,1],acosh:[,1],atanh:[,1],log10:[,1],exp:[,1],min:[,-1],max:[,-1],erf:[,1],floor:[,1],ceil:[,1],Si:[,1],step:[,1],rect:[,1],sinc:[,1],tri:[,1],sign:[,1],Ci:[,1],fib:[,1],fact:[ft,1],factorial:[ft,1],dfactorial:[,1],round:[,1],mod:[function(ll,il){if(ll.isConstant()&&il.isConstant()){var ol=new D(1);return ol.multiplier=ol.multiplier.multiply(ll.multiplier.mod(il.multiplier)),ol}return Ht.symfunction('mod',[ll,il])},2],pfactor:[xt,1],vector:[Tt,-1],matrix:[It,-1],parens:[yt,-1],sqrt:[wt,1],log:[St,1],expand:[Mt,1],abs:[ht,1],invert:[Vt,1],transpose:[Gt,1],dot:[Ft,2],cross:[function(ll,il){return je(ll)&&je(il)?ll.cross(il):void we('function cross expects 2 vectors')},2],vecget:[function(ll,il){return ll.elements[il]},2],vecset:[function(ll,il,ol){return ll.elements[il]=ol,ll},3],matget:[function(ll,il,ol){return ll.elements[il][ol]},3],matset:[function(ll,il,ol,nl){return ll.elements[il][ol]=nl,ll},4],imatrix:[function(ll){return H.identity(ll)},1],IF:[function(ll,il,ol){return'boolean'!=typeof ll&&Me(ll)&&(ll=!!+ll),ll?il:ol},3]};this.error=we;var $t=function(ll){for(var al,il=$.FUNCTION_MODULES,ol=il.length,nl=0;nl<ol;nl++)if(al=il[nl],ll in al)return al[ll];we('The function '+ll+' is undefined!')},tl=function(ll){for(var il=0;il<ll.length;il++)if(ll[il].group!==ee)return!1;return!0};this.override=function(ll,il){Qt[ll]||(Qt[ll]=[]),Qt[ll].push(this[ll]),this[ll]=il},this.restore=function(ll){this[ll]&&(this[ll]=Qt[ll].pop())},this.extend=function(ll,il,ol){var nl=this,al=this[ll];if('function'==typeof al&&'function'==typeof il){var pl=this[ll];this[ll]=function(ul,ml){return Oe(ul)&&Oe(ml)&&!ol?pl.call(nl,ul,ml):il.call(nl,ul,ml,pl)}}},this.symfunction=function(ll,il){var ol=new D(ll);return ol.group=se,'object'==typeof il&&(il=[].slice.call(il)),ol.args=il,ol.fname=ll===pe?'':ll,ol.updateHash(),ol},this.callfunction=function(ll,il){var ol=Kt[ll];ol||we('Nerdamer currently does not support the function '+ll);var pl,nl=ol[1],al=ol[0];if(il instanceof Array||(il=void 0===il?[]:[il]),-1!==nl){var ul=Ne(nl),ml=ul?nl[0]:nl,cl=ul?nl[1]:nl,gl=il.length,dl=ll+' requires a {0} of {1} arguments. {2} provided!';gl<ml&&we(ke(dl,'minimum',ml,gl)),gl>cl&&we(ke(dl,'maximum',cl,gl))}return al?pl=al.apply(al,il):(al=$t(ll),pl=$.PARSE2NUMBER&&tl(il)?Et(al.apply(al,il)):Ht.symfunction(ll,il)),pl},this.parseTree=function(ll){for(var al,il=[],ol=ll.length,nl=0;nl<ol;nl++){if(al=ll[nl],al.is_prefix_operator||al.is_postfix){il.push(al.operation(il.pop()));continue}if(al.is_operator){var pl=il.pop(),ul=il.pop();il.push(this[al.fn](ul,pl))}else if(al.value in Kt)il.push(Ht.callfunction(al.value,il.pop()));else if(''===al)il.push(new D(0));else{var ml=al;al in Xt?al=new D(Xt[al]):al in Yt?al=Yt[al].clone():al in he&&(al=he[al].clone()),al.unsubbed=ml,il.push(al)}}return il[0]||new D(0)},this.parse=function(ll,il,ol){if(il){for(var nl in il)il[nl]=Ht.parse(il[nl]);Yt=il}else Yt={};$.PARSE2NUMBER&&(Yt.e=new D(_MathE),Yt.pi=new D(_MathPI));for(var xl,Sl,Pl,al=(ll+'').split(' ').join('').replace(/\d+\.*\d*e\+?\-?\d+/gi,function(Gl){return Ee(Gl)}).replace(/([\+\-\/\*]*[0-9]+)([a-z_]+[\+\-\/\*]*)/gi,function(){var Gl=arguments[4],Vl=arguments[1],Zl=arguments[2],zl=arguments[3],Hl=Gl.charAt(zl),Ql='',Xl='*';return Hl.match(/[\+\-\/\*]/)||(Ql=Gl.charAt(zl-1)),Ql.match(/[a-z]/i)&&(Xl=''),Vl+Xl+Zl}).replace(/([a-z0-9]+)(\()|(\))([a-z0-9]+)/gi,function(Gl,Vl,Zl,zl,Hl){var Ql=Vl||zl,Xl=Zl||Hl;return(Ql in Kt)?Ql+Xl:Ql+'*'+Xl}).replace(/\)\(/g,')*(')||'0',pl=al.length,ul=[],ml=[],cl=0,gl=[0,0],dl=[],yl=!0,hl=function(Gl){Gl!==cl&&(xl=new D(al.substring(cl,Gl)),ul.push(xl),yl=!1)},fl=function(Gl){Gl.is_prefix||we(Gl+' is not a valid prefix operator')},bl=function(Gl,Vl){return Vl?Gl.val===Vl.val?new I(Wt['+']):new I(Wt['-']):Gl},vl=function(Gl){var Vl=ml.length;Vl&&ml[Vl-1].is_prefix_operator&&ml.push(bl(Gl,ml.pop())),ml.push(Gl)},wl=function(Gl){if(dl.length){for(var Vl=dl.pop();dl.length;)Vl=bl(Vl,dl.pop());Gl?ul.push(Vl):ml.push(Vl)}},El=0,El=0;El<pl;El++)if(Pl=al.charAt(El),Pl in Wt){hl(El);for(var Cl=El;al.charAt(El+1)in Wt;)El++;for(var Ol=El+1,Al=al.substring(Cl,Ol);!(Al in Wt);){var jl=Al.length,Rl=jl-1,Ml=Wt[Al.charAt(Rl)];Al=Al.substring(0,Rl);try{fl(Ml),dl.push(new I(Ml))}catch(Gl){for(var Dl,Nl=Al.length,Ll=0;Ll<Nl;Ll++)Dl=Wt[Al.charAt(Ll)],Dl&&(!Dl||Dl.is_postfix)||we(Gl.message);var Ul='';do{if(''===Al)break;if(Al in Wt)ul.push(Wt[Al]),Al=Ul,Ul='';else{var Rl=Al.length-1;Ul+=Al.charAt(Rl),Al=Al.substring(0,Rl)}}while(!0);Al=Ml.val;break}}for(Sl=Wt[Al],cl=Ol;;){for(var _l=ml.length,Tl=ml[_l-1];void 0!==Tl&&Tl.is_prefix_operator;)Tl=ml[--_l-1];if(0===_l||!(Sl.left_assoc&&Sl.precedence<=Tl.precedence||!Sl.left_assoc&&Sl.precedence<Tl.precedence))break;ul.push(ml.pop())}if(yl){fl(Sl);for(var Ml=new I(Sl);dl.length;)Ml=bl(Ml,dl.pop());vl(Ml)}else{var _l=ml.length;_l&&ml[_l-1].is_prefix_operator&&Sl.left_assoc&&ul.push(ml.pop()),ml.push(Sl),wl()}}else if(Pl in Jt){var Il=Jt[Pl];if(Il.open){if(gl[Il.bracket_id]++,cl!=El){var kl=new D(al.substring(cl,El));kl.is_function=!0,ml.push(kl)}yl=!0,ml.push(Il),cl=El+1}else{for(gl[Il.bracket_id]--,hl(El);;){var Fl=ml.pop();if(void 0===Fl&&we('Unmatched open bracket for bracket \''+Il+'\'!'),Fl.bracket_id===Il.bracket_id)break;else ul.push(Fl)}var _l=ml.length;_l&&ml[_l-1].is_function&&ul.push(ml.pop()),cl=El+1}}for(hl(pl);ml.length;)ul.push(ml.pop());for(var El=0;El<gl.length;El++)if(0<gl[El]){var Bl;for(Il in Jt)Jt[Il].bracket_id!==El||Jt[Il].open||(Bl=Jt[Il]);we('Unmatched close bracket for bracket '+Bl+'!')}return ol?ul:this.parseTree(ul)},this.expand=Mt,this.ext={log:St,sqrt:wt,abs:ht,vector:Tt,matrix:It,parens:yt,determinant:function(ll){return Re(ll)?ll.determinant():ll},dot:Ft,invert:Vt,transpose:Gt},this.mapped_function=function(){for(var ll={},il=this.params,ol=0;ol<il.length;ol++)ll[il[ol]]=arguments[ol];return Ht.parse(this.body,ll)},this.add=function(ll,il){var ol=Oe(ll),nl=Oe(il);if(ol&&nl){if(ll.multiplier.equals(0))return il;if(il.multiplier.equals(0))return ll;if(ll.isConstant()&&il.isConstant()&&$.PARSE2NUMBER)return new D(ll.multiplier.add(il.multiplier).valueOf());var al=ll.group,pl=il.group,ul=ll.power.toString(),ml=il.power.toString();if(al<pl||al===pl&&ul>ml&&0<ml)return this.add(il,ll);if(al===re&&pl===oe&&ll.value===il.value){var cl=ll;ll=il,il=cl,al=ll.group,pl=il.group,ul=ll.power.toString(),ml=il.power.toString()}var bl,vl,wl,gl=ul===ml,dl=ll.value,yl=il.value,hl=ll.isComposite(),fl=il.isComposite();if(hl&&(bl=h(ll,'hash')),fl&&(vl=h(il,'hash')),al===ne&&pl===ne&&il.isLinear()&&!ll.isLinear()&&bl!==vl)return this.add(ll,il);al===oe&&pl===oe&&(dl=bl,yl=vl);var xl=al===te&&pl===ee,Sl=ll.value===il.multiplier.toString(),ql=dl===yl||bl===vl&&void 0===!bl||xl&&Sl;if(ql&&gl&&al===pl){if(xl&&(il=il.convert(te)),al===oe&&(pl===le||pl===te))ll.distributeMultiplier(),wl=ll.attach(il);else if(wl=ll,ll.multiplier.isOne()&&il.multiplier.isOne()&&al===ne)for(var El in il.symbols){var Pl=il.symbols[El];wl.attach(Pl)}else wl.multiplier=wl.multiplier.add(il.multiplier);}else if(ql&&al!==oe)wl=D.shell(oe).attach([ll,il]),wl.value=al===oe?bl:dl;else if(hl&&ll.isLinear()){var Cl=al==pl,Ol=al==oe&&pl==oe;if(Ol&&(Cl=ll.value===il.value),ll.distributeMultiplier(),il.isComposite()&&il.isLinear()&&Cl){for(var El in il.distributeMultiplier(),il.symbols){var Pl=il.symbols[El];ll.attach(Pl)}wl=ll}else Ol&&ll.value!==vl||al===oe&&!ql?(wl=D.shell(ne).attach([ll,il]),wl.updateHash()):wl=ll.attach(il)}else{if(al===se&&ll.fname===me&&pl!==ie&&il.power.equals(0.5)){var Al=il.multiplier.clone();il=wt(il.toUnitMultiplier().toLinear()),il.multiplier=Al}wl=D.shell(ne).attach([ll,il]),wl.updateHash()}if(wl.multiplier.equals(0)&&(wl=new D(0)),1===wl.length){var Al=wl.multiplier;wl=Be(wl.symbols),wl.multiplier=wl.multiplier.multiply(Al)}return wl}if(nl&&!ol){var cl=ll;ll=il,il=cl,cl=nl,nl=ol,ol=cl}var jl=Re(il);if(ol&&jl)il.eachElement(function(Nl){return Ht.add(ll.clone(),Nl)});else if(Re(ll)&&jl)il=ll.add(il);else if(ol&&je(il))il.each(function(Nl,Dl){Dl--,il.elements[Dl]=Ht.add(ll.clone(),il.elements[Dl])});else if(je(ll)&&je(il))il.each(function(Nl,Dl){Dl--,il.elements[Dl]=Ht.add(ll.elements[Dl],il.elements[Dl])});else{if(je(ll)&&Re(il))return Ht.add(il,ll);if(Re(ll)&&je(il)){if(il.elements.length===ll.rows()){var Rl=new H,Ml=ll.cols();return il.each(function(Nl,Dl){for(var Ll=[],Ul=0;Ul<Ml;Ul++)Ll.push(Ht.add(ll.elements[Dl-1][Ul].clone(),Nl.clone()));Rl.elements.push(Ll)}),Rl}we('Dimensions must match!')}}return il},this.subtract=function(ll,il){var al,ol=ol=Oe(ll),nl=Oe(il);if(ol&&nl)return this.add(ll,il.negate());if(nl&&(al=il,il=ll,ll=al,ol=nl),ol&&je(il))il=il.map(function(ml){return Ht.subtract(ml,ll.clone())});else if(je(ll)&&je(il))ll.dimensions()===il.dimensions()?il=ll.subtract(il):Ht.error('Unable to subtract vectors. Dimensions do not match.');else if(Re(ll)&&je(il)){if(il.elements.length===ll.rows()){var pl=new H,ul=ll.cols();return il.each(function(ml,cl){for(var gl=[],dl=0;dl<ul;dl++)gl.push(Ht.subtract(ll.elements[cl-1][dl].clone(),ml.clone()));pl.elements.push(gl)}),pl}we('Dimensions must match!')}else{if(je(ll)&&Re(il)){var pl=il.clone().negate();return Ht.add(pl,ll)}Re(ll)&&Re(il)&&(il=ll.subtract(il))}return il},this.multiply=function(ll,il){var ol=Oe(ll),nl=Oe(il);if(ol&&nl){if(ll.isConstant()&&il.isConstant()&&$.PARSE2NUMBER)return new D(ll.multiplier.multiply(il.multiplier).valueOf());if(ll.isOne())return il.clone();if(il.isOne())return ll.clone();if(ll.multiplier.equals(0)||il.multiplier.equals(0))return new D(0);if(il.group>ll.group&&il.group!==ne)return this.multiply(il,ll);if(ll.group===re&&il.group===oe&&ll.value===il.value){var al=ll;ll=il,il=al}var pl=ll.group,ul=il.group,ml=il.multiplier.num,cl=il.multiplier.den;if(pl===se&&ll.fname===me&&!il.isConstant()&&ll.args[0].value===il.value){var gl=ll.power;ll=ll.args[0].clone(),ll.setPower(new R(0.5).multiply(gl)),pl=ll.group}var dl=ll.value,yl=il.value,hl=new R(ll.multiplier.lessThan(0)?-1:1),fl=pl===te&&ul===ee&&il.multiplier.equals(ll.value),bl=fl?new R(1).multiply(ll.multiplier).abs():ll.multiplier.multiply(il.multiplier).abs(),vl=ll.clone().toUnitMultiplier();if(il=il.clone().toUnitMultiplier(!0),dl===yl&&pl===oe&&pl===ul&&(dl=ll.text('hash'),yl=il.text('hash')),ul===ie&&il.previousGroup===oe&&pl===oe&&(dl=h(ll,'hash',ie)),(dl===yl||fl)&&(pl!==oe||ul!==le&&ul!==te&&ul!==se)&&(pl!==oe||ul!==re)){var wl=ll.power,xl=il.power,Sl=Oe(wl),ql=Oe(xl),El=Sl||ql;if(vl.power=El?Ht.add(Oe(wl)?wl:new D(wl),Oe(xl)?xl:new D(xl)):pl===ee?wl:wl.add(xl),vl.power.equals(0)&&(vl=vl.convert(ee)),El&&vl.convert(ie),ll.imaginary&&il.imaginary){var Pl=We(vl.power%2);Pl&&(vl=new D(1),bl.negate())}vl.group!==ie&&vl.previousGroup&&(vl.previousGroup=void 0),vl.multiplier=vl.multiplier.multiply(il.multiplier)}else if(!(pl===re&&ll.isLinear()))pl===ee?vl=il.clone().toUnitMultiplier():pl===re?(vl.distributeExponent(),vl.combine(il)):!il.isOne()&&(vl=D.shell(re).combine([vl,il]));else if(ul===re&&il.distributeExponent(),ul===re&&il.isLinear()){for(var Cl in il.symbols){var Ol=il.symbols[Cl];vl=vl.combine(Ol)}vl.multiplier=vl.multiplier.multiply(il.multiplier)}else vl.combine(il);if(vl.group===te){var Al=_Mathlog(vl.value),jl=_Mathlog(ml)/Al,Rl=_Mathlog(cl)/Al,Ml=bl.num/ml,Nl=bl.den/cl;0!=jl&&De(jl)&&De(Ml)&&(vl.power=vl.power.add(new R(jl)),bl.num/=ml),0!=Rl&&De(Rl)&&De(Nl)&&(vl.power=vl.power.subtract(new R(Rl)),bl.den/=cl)}if(1===vl.length){var al=vl.multiplier;vl=Be(vl.symbols),vl.multiplier=vl.multiplier.multiply(al)}var Dl=vl.power.toString();if(We(Dl)&&vl.fname===me){var Ll=vl.power;vl=vl.args[0],vl=Ht.multiply(new D(bl),Ht.pow(vl,new D(Ll.divide(new R(2)))))}else vl.multiplier=vl.multiplier.multiply(bl).multiply(hl);return vl.group===te&&De(vl.power.toDecimal())&&(vl=vl.convert(ee)),vl}nl&&!ol&&(al=ll,ll=il,il=al,al=nl,nl=ol,ol=al);var Ul=Re(il),_l=Re(ll);if(ol&&Ul)il.eachElement(function(kl){return Ht.multiply(ll.clone(),kl)});else if(_l&&Ul)il=ll.multiply(il);else if(ol&&je(il))il.each(function(kl,Fl){Fl--,il.elements[Fl]=Ht.multiply(ll.clone(),il.elements[Fl])});else if(je(ll)&&je(il))il.each(function(kl,Fl){Fl--,il.elements[Fl]=Ht.multiply(ll.elements[Fl],il.elements[Fl])});else{if(je(ll)&&Re(il))return this.multiply(il,ll);if(Re(ll)&&je(il)){if(il.elements.length===ll.rows()){var Tl=new H,Il=ll.cols();return il.each(function(kl,Fl){for(var Bl=[],Gl=0;Gl<Il;Gl++)Bl.push(Ht.multiply(ll.elements[Fl-1][Gl].clone(),kl.clone()));Tl.elements.push(Bl)}),Tl}we('Dimensions must match!')}}return il},this.divide=function(ll,il){var ol=Oe(ll),nl=Oe(il);if(ol&&nl){var al;return ll.isConstant()&&il.isConstant()?(il.equals(0)&&we('Division by zero not allowed!'),al=ll.clone(),al.multiplier=al.multiplier.divide(il.multiplier)):(il.invert(),al=Ht.multiply(ll,il)),al}var pl=je(ll),ul=je(il);if(ol&&ul)il=il.map(function(gl){return Ht.divide(ll.clone(),gl)});else if(pl&&nl)il=ll.map(function(gl){return Ht.divide(gl,il.clone())});else if(pl&&ul)ll.dimensions()===il.dimensions()?il=il.map(function(gl,dl){return Ht.divide(ll.elements[--dl],gl)}):Ht.error('Cannot divide vectors. Dimensions do not match!');else{var ml=Re(ll),cl=Re(il);ml&&nl?(ll.eachElement(function(gl){return Ht.divide(gl,il.clone())}),il=ll):ml&&cl?ll.rows()===il.rows()&&ll.cols()===il.cols()?ll.eachElement(function(gl,dl,yl){return Ht.divide(gl,il.elements[dl][yl])}):Ht.error('Dimensions do not match!'):ml&&ul&&(ll.cols()===il.dimensions()?(ll.eachElement(function(gl,dl){return Ht.divide(gl,il.elements[dl].clone())}),il=ll):Ht.error('Unable to divide matrix by vector.'))}return il},this.pow=function(ll,il){var ol=Oe(ll),nl=Oe(il);if(ol&&nl){ll.equals(0)&&il.equals(0)&&we('0^0 is undefined!');var al=il.isConstant(),pl=ll.isConstant(),ul=il.isInteger(),ml=ll.multiplier,cl=ll.clone();if(cl.toUnitMultiplier(),cl.group===se&&cl.fname===me&&!al){var gl=cl.args[0];gl.multiplyPower(new D(0.5)),gl.multiplier.multiply(cl.multiplier),gl.multiplyPower(il),cl=gl}else{var dl=ml.sign();Je(il)&&0>dl&&(cl.negate(),cl=Ht.symfunction(pe,[cl]),cl.negate()),cl.multiplyPower(il)}if(pl&&al&&$.PARSE2NUMBER){var yl=ll.multiplier.toDecimal(),hl=il.multiplier.toDecimal(),dl=new D(1);if(il.multiplier.den.isOdd()){var fl=_Mathabs(yl);dl=new D(yl/fl),yl=fl}We(hl)&&(dl=new D(1)),cl=Ht.multiply(new D(_Mathpow(yl,hl)),dl)}else if(ul&&!ml.equals(1)){var bl=il.multiplier.toDecimal(),vl=new R(_Mathpow(ml.num,bl)/_Mathpow(ml.den,bl));cl.multiplier=cl.multiplier.multiply(vl)}else{var dl=ll.sign();if(il.isConstant()&&ll.isConstant()&&We(il.multiplier.den)&&0>dl){var wl=ll.clone();wl.multiplier.negate(),cl=Ht.pow(Ht.symfunction(pe,[new D(-1)]),il.clone());var xl=Ht.pow(new D(wl.multiplier.num),il.clone()),Sl=Ht.pow(new D(wl.multiplier.den),il.clone()),ql=Ht.divide(xl,Sl);cl=Ht.multiply(cl,ql)}else{var El=ll.group===ee&&0>dl,Pl=Zt(new D(El?ml.num:_Mathabs(ml.num)).setPower(il.clone())),Cl=Zt(new D(ml.den).setPower(il.clone()).invert());if(ll.imaginary){var Ol=il.multiplier.multiply(R.quick(1,2)),Al=_Mathpow(-1,Ol.num);cl=We(Ol.den)?new D(-1).setPower(Ol,!0):new D(Al)}if(0>dl&&!El&&cl.negate(),al&&ll.group!==ie){var jl=We(il.multiplier.den),Rl=We(ll.power),Ml=cl.power.toDecimal(),Nl=We(Ml);if(jl&&Rl&&!Nl)if(1===Ml)cl=Ht.symfunction(ce,[cl]);else if(!De(Ml)){var bl=cl.power;cl=Ht.symfunction(ce,[cl.toLinear()]).setPower(bl)}else cl=Ht.multiply(Ht.symfunction(ce,[cl.clone().toLinear()]),cl.clone().setPower(new R(Ml-1)))}}}if(cl=Zt(cl),Pl&&Cl&&(cl=Ht.multiply(cl,zt(Ht.multiply(Pl,Cl)))),cl.fname===me){var Dl=cl.group===ie,Ll=Dl?cl.power.multiplier.toString():cl.power.toString();if(We(Ll)){var Ul=Dl?Ht.divide(cl.power,new D(2)):new D(cl.power.divide(new R(2))),ml=cl.multiplier;cl=Ht.pow(cl.args[0],Ul),cl.multiplier=cl.multiplier.multiply(ml)}}else if(cl.isE()&&cl.group===ie&&cl.power.contains('pi')&&cl.power.contains($.IMAGINARY)){var _l=cl.multiplier,Tl=cl.power.multiplier;cl=new D(We(Tl)?_l:_l.negate())}return cl}return je(ll)&&nl?ll=ll.map(function(Il){return Ht.pow(Il,il.clone())}):Re(ll)&&nl&&ll.eachElement(function(Il){return Ht.pow(Il,il.clone())}),ll},this.comma=function(ll,il){return ll instanceof Array?ll.push(il):ll=[ll,il],ll},this.equals=function(ll,il){return ll.group===le||ll.isLinear()||we('Cannot set equality for '+ll.toString()),he[ll.value]=il.clone(),il},this.eq=function(ll,il){return ll.equals(il)},this.gt=function(ll,il){return ll.gt(il)},this.gte=function(ll,il){return ll.gte(il)},this.lt=function(ll,il){return ll.lt(il)},this.lte=function(ll,il){return ll.lte(il)},this.factorial=function(ll){return this.symfunction(ge,[ll])},this.dfactorial=function(ll){return this.symfunction(de,[ll])},this.factadd=function(ll,il){return Ht.add(this.symfunction(ge,[ll]),il)},this.dfactadd=function(ll,il){return Ht.add(this.symfunction(de,[ll]),il)},this.factsub=function(ll,il){return Ht.subtract(this.symfunction(ge,[ll]),il)},this.dfactsub=function(ll,il){return Ht.subtract(this.symfunction(de,[ll]),il)}}function Z(yt){this.elements=je(yt)?yt.items.slice(0):Ne(yt)?yt.slice(0):[].slice.call(arguments)}function H(){var ft,yt=arguments,ht=yt.length,bt=[];if(Re(yt))for(ft=0;ft<ht;ft++)bt.push(yt[ft].slice(0));else{var vt,wt,xt;for(ft=0;ft<ht;ft++)vt=yt[ft],je(vt)&&(vt=vt.elements),Ne(vt)||(vt=[vt]),xt=vt.length,wt&&wt!==xt&&we('Unable to create Matrix. Row dimensions do not match!'),bt.push(vt),wt=xt}this.elements=bt}var X=new G,Y=u.bigInt,W={},J=[],K={},$={init_primes:1e3,exclude:[],suppress_errors:!1,PARSE2NUMBER:!1,SAFE:!1,IMAGINARY:'i',FUNCTION_MODULES:[Math],ALLOW_CHARS:['\u03C0']},ee=W.N=1,te=W.P=2,le=W.S=3,ie=W.EX=4,se=W.FN=5,oe=W.PL=6,re=W.CB=7,ne=W.CP=8,ae=$.CONST_HASH='#',pe=$.PARENTHESIS='parens',ue=$.VECTOR='vector',me=$.SQRT='sqrt',ce=$.ABS='abs',ge=$.FACTORIAL='factorial',de=$.DOUBLEFACTORIAL='dfactorial',ye=[],he={},fe=[],be='',ve=K.isReserved=function(yt){return-1!==fe.indexOf(yt)},we=function(yt){if(!$.suppress_errors)throw new Error(yt)},Se=K.validateName=function(yt,ht){if(ht=ht||'variable',-1===$.ALLOW_CHARS.indexOf(yt)){var ft=/^[a-z_][a-z\d\_]*$/gi;if(!ft.test(yt))throw new Error(yt+' is not a valid '+ht+' name')}},qe=K.intersection=function(yt,ht,ft){var bt=[];if(yt.length>ht.length){var vt=yt;yt=ht,ht=vt}ht=ht.slice();for(var qt,wt=yt.length,xt=ht.length,St=0;St<wt;St++){qt=yt[St];for(var Pt,Et=0;Et<xt;Et++)if(Pt=ht[Et],void 0!==Pt){var Ct=ft?ft(qt,Pt):qt===Pt;if(Ct){ht[Et]=void 0,bt.push(qt);continue}}}return bt},Ee=K.scientificToDecimal=function(yt){if(/\d+\.?\d*e[\+\-]*\d+/i.test(yt)){var ht='0',ft=(yt+'').toLowerCase().split('e'),bt=ft.pop(),vt=_Mathabs(bt),wt=bt/vt,xt=ft[0].split('.');if(-1==wt)yt=ht+'.'+Array(vt).join(ht)+xt.join('');else{var St=xt[1];St&&(vt-=St.length),yt=xt.join('')+Array(vt+1).join(ht)}}return yt},Pe=K.isPrime=function(yt){for(var ht=_Mathfloor(_Mathsqrt(yt)),ft=2;ft<=ht;ft++)if(0==yt%ft)return!1;return!0},Ce=K.isFraction=function(yt){return Oe(yt)?Ce(yt.multiplier.toDecimal()):0!=yt%1},Oe=K.isSymbol=function(yt){return yt instanceof D},Ae=K.isExpression=function(yt){return yt instanceof O},je=K.isVector=function(yt){return yt instanceof Z},Re=K.isMatrix=function(yt){return yt instanceof H},Me=K.isNumericSymbol=function(yt){return yt.group===ee},Ne=K.isArray=function(yt){return yt instanceof Array},De=K.isInt=function(yt){return 0==yt%1},Le=K.isNegative=function(yt){return Oe(yt)&&(yt=yt.multiplier),yt.lessThan(0)},Ue=K.inBrackets=function(yt){return'('+yt+')'},_e=K.stringReplace=function(yt,ht,ft,bt){return yt.substr(0,ht)+bt+yt.substr(ft,yt.length)},Te=K.customType=function(yt){return void 0!==yt&&yt.custom},Ie=K.sameSign=function(yt,ht){return 0>yt==0>ht},ke=K.format=function(){var yt=[].slice.call(arguments),ht=yt.shift(),ft=ht.replace(/{(\d+)}/g,function(bt,vt){var wt=yt[vt];return'function'==typeof wt?wt():wt});return ft},Fe=K.keys=Object.keys,Be=K.firstObject=function(yt){for(var ht in yt)break;return yt[ht]},Ge=K.compare=function(yt,ht,ft){for(var wt,vt={},xt=0;xt<ft.length;xt++)vt[ft[xt]]=new D(_Mathfloor(5*Math.random())+1);return tt('PARSE2NUMBER',function(){wt=X.parse(yt,vt).equals(X.parse(ht,vt))}),wt},Ve=K.arrayMax=function(yt){return _Mathmax.apply(void 0,yt)},Ze=K.arrayMin=function(yt){return _Mathmin.apply(void 0,yt)},ze=K.arrayClone=function(yt){for(var ht=[],ft=yt.length,bt=0;bt<ft;bt++)ht[bt]=yt[bt].clone();return ht},He=K.comboSort=function(yt,ht){for(var ft=yt.length,bt=[],vt=0;vt<yt.length;vt++)bt.push([yt[vt],ht[vt]]);bt.sort(function(St,qt){return St[0]-qt[0]});var wt=[],xt=[];for(vt=0;vt<ft;vt++)wt.push(bt[vt][0]),xt.push(bt[vt][1]);return[wt,xt]},Qe=K.round=function(yt,ht){return ht=ht||14,_Mathround(yt*_Mathpow(10,ht))/_Mathpow(10,ht)},Xe=K.variables=function(yt,ht,ft){if(ft=ft||{c:[],add:function(St){-1===this.c.indexOf(St)&&isNaN(St)&&this.c.push(St)}},Oe(yt)){var bt=yt.group,vt=yt.previousGroup;if(bt===ie&&Xe(yt.power,ht,ft),bt===ne||bt===re||vt===ne||vt===re)for(var wt in yt.symbols)Xe(yt.symbols[wt],ht,ft);else if(bt===le||vt===le)'e'===yt.value||'pi'===yt.value||ft.add(yt.value);else if(bt===oe||vt===oe)Xe(Be(yt.symbols),ht,ft);else if(bt===ie)isNaN(yt.value)||ft.add(yt.value),Xe(yt.power,ht,ft);else if(bt===se&&!ht)for(var xt=0;xt<yt.args.length;xt++)Xe(yt.args[xt],ht,ft)}return ft.c.sort()},Ye=K.each=function(yt,ht){if(Ne(yt))for(var ft=yt.length,bt=0;bt<ft;bt++)ht.call(yt,bt);else for(var vt in yt)yt.hasOwnProperty(vt)&&ht.call(yt,vt)},We=K.even=function(yt){return 0==yt%2},Je=K.evenFraction=function(yt){return 0==1/(yt%1)%2},Ke=K.arrayUnique=function(yt){for(var vt,ht=yt.length,ft=[],bt=0;bt<ht;bt++)vt=yt[bt],-1===ft.indexOf(vt)&&ft.push(vt);return ft},$e=K.reserveNames=function(yt){var ht=function(ft){-1===fe.indexOf(ft)&&fe.push(ft)};'string'==typeof yt?ht(yt):Ye(yt,function(ft){ht(ft)})},et=K.remove=function(yt,ht){var ft;return Ne(yt)?ft=yt.splice(ht,1)[0]:(ft=yt[ht],delete yt[ht]),ft},tt=K.block=function(yt,ht,ft,bt){var vt=$[yt];$[yt]=void 0===ft||!!ft;var wt=ht.call(bt);return $[yt]=vt,wt},lt=K.arguments2Array=function(yt){return[].slice.call(yt)},it=K.getCoeffs=function(yt,ht){var ft=[];yt.each(function(vt){if(vt.contains(ht))var wt=vt.stripVar(ht),xt=X.divide(vt.clone(),wt.clone()),St=xt.power.toDecimal();else wt=vt,St=0;var qt=ft[St];ft[St]=qt?X.add(qt,wt):wt},!0);for(var bt=0;bt<ft.length;bt++)ft[bt]||(ft[bt]=new D(0));return ft},rt=K.generatePrimes=function(yt){for(var ht=J[J.length-1]||2,ft=ht;ft<yt;ft++)Pe(ft)&&J.push(ft)},nt={csc:function(yt){return 1/_Mathsin(yt)},sec:function(yt){return 1/_Mathcos(yt)},cot:function(yt){return 1/_Mathtan(yt)},erf:function(yt){var ht=1/(1+0.5*_Mathabs(yt)),ft=1-ht*_Mathexp(-yt*yt-1.26551223+ht*(1.00002368+ht*(0.37409196+ht*(0.09678418+ht*(-0.18628806+ht*(0.27886807+ht*(-1.13520398+ht*(1.48851587+ht*(-0.82215223+0.17087277*ht)))))))));return 0<=yt?ft:-ft},bigpow:function(yt,ht){yt=R.simple(yt);for(var ft=yt.clone(),bt=0;bt<ht-1;bt++)ft=ft.multiply(yt);return ft},gamma:function(yt){var ht=7,ft=[0.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-0.13857109526572012,0.000009984369578019572,1.5056327351493116e-7];if(0.5>yt)return _MathPI/(_Mathsin(_MathPI*yt)*gamma(1-yt));yt-=1;for(var bt=ft[0],vt=1;vt<ht+2;vt++)bt+=ft[vt]/(yt+vt);var wt=yt+ht+0.5;return _Mathsqrt(2*_MathPI)*_Mathpow(wt,yt+0.5)*_Mathexp(-wt)*bt},bigfactorial:function(yt){for(var ht=new R(1),ft=2;ft<=yt;ft++)ht=ht.multiply(new R(ft));return ht},factorial:function(yt){if(0>yt)throw new Error('factorial not defined for negative numbers');for(var ht=1,ft=2;ft<=yt;ft++)ht*=ft;return ht},dfactorial:function(yt){var ht=0==yt%2,ft=ht?yt/2:(yt+1)/2,bt=new R(1);if(ht)for(var vt=1;vt<=ft;vt++)bt=bt.multiply(new R(2).multiply(new R(vt)));else for(var vt=1;vt<=ft;vt++)bt=bt.multiply(new R(2).multiply(new R(vt)).subtract(new R(1)));return bt},GCD:function(){for(var bt,yt=Ke([].slice.call(arguments).map(function(vt){return _Mathabs(vt)})).sort(),ht=_Mathabs(yt.shift()),ft=yt.length;0<ft--;)for(bt=_Mathabs(yt.shift());;){if(ht%=bt,0===ht){ht=bt;break}if(bt%=ht,0===bt)break}return ht},QGCD:function(){for(var yt=[].slice.call(arguments),ht=yt[0],ft=1;ft<yt.length;ft++){var bt=yt[ft],vt=ht.isNegative()&&bt.isNegative()?-1:1;ht=bt.gcd(ht),0>vt&&ht.negate()}return ht},LCM:function(yt,ht){return yt*ht/nt.GCD(yt,ht)},pow:function(yt,ht){return 0>yt&&1>_Mathabs(ht)?0==1/ht%2?NaN:-_Mathpow(_Mathabs(yt),ht):_Mathpow(yt,ht)},factor:function(yt){var ht=nt.ifactor(yt),ft=new D;for(var bt in ft.symbols={},ft.group=re,ht){var vt=new D(1);vt.group=te,vt.value=bt,vt.power=new D(ht[bt]),ft.symbols[bt]=vt}return ft.updateHash(),ft},ifactor:function(yt,ht){ht=ht||{};var ft=_Mathfloor(_Mathsqrt(yt)),bt=J[J.length-1];ft>bt&&1e6>yt&&rt(ft);for(var xt,vt=J.length,wt=0;wt<vt;wt++)for(xt=J[wt];0==yt%xt;)yt/=xt,ht[xt]=(ht[xt]||0)+1;return 1<yt&&(ht[yt]=1),ht},boxfactor:function(yt,ht){ht=ht||200;for(var ft,bt,vt=_Mathfloor(5/12*yt),wt=0,xt=!1;ft=_Mathfloor(yt/vt),bt=yt%vt,0!=bt;){if(xt)return[yt,1];vt=_Mathmax(bt,vt-bt),wt++,xt=wt>ht}return[ft,vt,wt]},fib:function(yt){for(var ht=0,ft=1,bt=1,vt=2;vt<=yt;vt++)bt=ht+ft,ht=ft,ft=bt;return bt},mod:function(yt,ht){return yt%ht},Ci:function(yt){for(var wt,ft=0.5772156649015329,bt=0,vt=1;20>vt;vt++)wt=2*vt,bt+=_Mathpow(-1,vt)*_Mathpow(yt,wt)/(wt*nt.factorial(wt));return _Mathlog(yt)+ft+bt},Si:function(yt){for(var vt,ft=0,bt=0;20>bt;bt++)vt=2*bt,ft+=_Mathpow(-1,bt)*_Mathpow(yt,vt+1)/((vt+1)*nt.factial(vt+1));return ft},step:function(yt){return 0<yt?1:0>yt?0:0.5},rect:function(yt){var yt=_Mathabs(yt);return 0.5===yt?yt:0.5<yt?0:1},sinc:function(yt){return 0===yt?1:_Mathsin(yt)/yt},tri:function(yt){return yt=_Mathabs(yt),1<=yt?0:1-yt}};$.FUNCTION_MODULES.push(nt),$.FUNCTION_MODULES.push(nt),_Mathsign=_Mathsign||function(yt){return yt=+yt,0===yt||isNaN(yt)?yt:0<yt?1:-1},_Mathcosh=_Mathcosh||function(yt){var ht=_Mathexp(yt);return(ht+1/ht)/2},_Mathsinh=_Mathsinh||function(yt){var ht=_Mathexp(yt);return(ht-1/ht)/2},_Mathtanh=_Mathtanh||function(yt){if(yt===Infinity)return 1;if(yt===-Infinity)return-1;var ht=_Mathexp(2*yt);return(ht-1)/(ht+1)},_Mathasinh=_Mathasinh||function(yt){return yt===-Infinity?yt:_Mathlog(yt+_Mathsqrt(yt*yt+1))},_Mathacosh=_Mathacosh||function(yt){return _Mathlog(yt+_Mathsqrt(yt*yt-1))},_Mathatanh=_Mathatanh||function(yt){return _Mathlog((1+yt)/(1-yt))/2},_Mathlog2=_Mathlog2||function(yt){return _Mathlog(yt)*Math.LOG10E},$e(nt),K.text=h,O.getExpression=function(yt){'last'!==yt&&yt||(yt=ye.length),'first'===yt&&(yt=1);var ft=yt-1,bt=ye[ft],vt=bt?new O(bt):bt;return vt},O.prototype={text:function(yt){return yt=yt||'decimals',this.symbol.text_?this.symbol.text_(yt):h(this.symbol,yt)},latex:function(yt){return this.symbol.latex_?this.symbol.latex_(yt):ut.latex(this.symbol,yt)},valueOf:function(){return this.symbol.valueOf()},evaluate:function(){var ht,yt=arguments[0],ft=1;'string'==typeof yt?ht='%'===yt.charAt(0)?O.getExpression(yt.substr(1)).text():yt:yt instanceof O||Oe(yt)?ht=yt.text():(ht=this.symbol.text(),ft--);var bt=arguments[ft]||{};return new O(tt('PARSE2NUMBER',function(){return X.parse(ht,bt)},!0))},buildFunction:function(yt){return ct(this.symbol,yt)},isNumber:function(){return Me(this.symbol)},isInfinity:function(){return _Mathabs(this.symbol.multiplier)===Infinity},variables:function(){return Xe(this.symbol)},toString:function(){try{return Ne(this.symbol)?'['+this.symbol.toString()+']':this.symbol.toString()}catch(yt){return''}},toDecimal:function(){return this.symbol.toDecimal()},isFraction:function(){return Ce(this.symbol)},isPolynomial:function(){return this.symbol.isPoly()},sub:function(yt,ht){return new O(this.symbol.sub(X.parse(yt),X.parse(ht)))},operation:function(yt,ht){return Ae(ht)?ht=ht.symbol:!Oe(ht)&&(ht=X.parse(ht)),new O(X[yt](this.symbol.clone(),ht.clone()))},add:function(yt){return this.operation('add',yt)},subtract:function(yt){return this.operation('subtract',yt)},multiply:function(yt){return this.operation('multiply',yt)},divide:function(yt){return this.operation('divide',yt)},pow:function(yt){return this.operation('pow',yt)},expand:function(){return new O(X.expand(this.symbol))},each:function(yt){if(this.symbol.each)this.symbol.each(yt);else if(Ne(this.symbol))for(var ht=0;ht<this.symbol.length;ht++)yt.call(this.symbol[ht],ht);else yt.call(this.symbol)}},O.prototype.toTeX=O.prototype.latex,R.isFrac=function(yt){return yt instanceof R},R.quick=function(yt,ht){var ft=new R;return ft.num=new Y(yt),ft.den=new Y(ht),ft},R.simple=function(yt){for(var ft=(yt+'').split('.'),bt=ft.join(''),vt=1,wt=(ft[1]||'').length,xt=0;xt<wt;xt++)vt+='0';var St=R.quick(bt,vt);return St.simplify()},R.prototype={multiply:function(yt){if(this.isOne())return yt.clone();if(yt.isOne())return this.clone();var ht=this.clone();return ht.num=ht.num.multiply(yt.num),ht.den=ht.den.multiply(yt.den),ht.simplify()},divide:function(yt){if(yt.equals(0))throw new Error('Division by zero not allowed!');return this.clone().multiply(yt.clone().invert()).simplify()},subtract:function(yt){return this.clone().add(yt.clone().neg())},neg:function(){return this.num=this.num.multiply(-1),this},add:function(yt){var ht=this.den,ft=yt.den,bt=this.clone(),vt=bt.num,wt=yt.num;return ht.equals(ft)?bt.num=vt.add(wt):(bt.num=vt.multiply(ft).add(wt.multiply(ht)),bt.den=ht.multiply(ft)),bt.simplify()},mod:function(yt){var ht=this.clone(),ft=yt.clone();return ht.num=ht.num.multiply(ft.den),ht.den=ht.den.multiply(ft.den),ft.num=ft.num.multiply(this.den),ft.den=ft.den.multiply(this.den),ht.num=ht.num.mod(ft.num),ht.simplify()},simplify:function(){var yt=Y.gcd(this.num,this.den);return this.num=this.num.divide(yt),this.den=this.den.divide(yt),this},clone:function(){var yt=new R;return yt.num=new Y(this.num),yt.den=new Y(this.den),yt},toDecimal:function(){return this.num/this.den},qcompare:function(yt){return[this.num.multiply(yt.den),yt.num.multiply(this.den)]},equals:function(yt){isNaN(yt)||(yt=new R(yt));var ht=this.qcompare(yt);return ht[0].equals(ht[1])},absEquals:function(yt){isNaN(yt)||(yt=new R(yt));var ht=this.qcompare(yt);return ht[0].abs().equals(ht[1])},greaterThan:function(yt){isNaN(yt)||(yt=new R(yt));var ht=this.qcompare(yt);return ht[0].gt(ht[1])},lessThan:function(yt){isNaN(yt)||(yt=new R(yt));var ht=this.qcompare(yt);return ht[0].lt(ht[1])},isInteger:function(){return this.den.equals(1)},negate:function(){return this.num=this.num.multiply(-1),this},invert:function(){var yt=this.den,ht=this.num.isNegative();return this.den=this.num.abs(),this.num=yt,ht&&(this.num=this.num.multiply(-1)),this},isOne:function(){return this.num.equals(1)&&this.den.equals(1)},sign:function(){return this.num.isNegative()?-1:1},abs:function(){return this.num=this.num.abs(),this},gcd:function(yt){return R.quick(Y.gcd(yt.num,this.num),Y.lcm(yt.den,this.den))},toString:function(){return this.den.equals(1)?this.num.toString():this.num.toString()+'/'+this.den.toString()},valueOf:function(){return this.num/this.den},isNegative:function(){return 0>this.toDecimal()}},D.imaginary=function(){var yt=new D($.IMAGINARY);return yt.isImaginary=!0,yt},D.shell=function(yt,ht){var ft=new D(ht);return ft.group=yt,ft.symbols={},ft.length=0,ft},D.unwrapSQRT=function(yt,ht){var ft=yt.power;if(yt.fname===me&&(yt.isLinear()||ht)){var bt=yt.args[0].clone();bt.power=bt.power.multiply(new R(1/2)),bt.multiplier=bt.multiplier.multiply(yt.multiplier),yt=bt,ht&&(yt.power=ft.multiply(new R(1/2)))}return yt},D.prototype={equals:function(yt){return Oe(yt)||(yt=new D(yt)),this.value===yt.value&&this.power.equals(yt.power)&&this.multiplier.equals(yt.multiplier)},gt:function(yt){return Oe(yt)||(yt=new D(yt)),this.isConstant()&&yt.isConstant()&&this.multiplier.greaterThan(yt.multiplier)},gte:function(yt){return Oe(yt)||(yt=new D(yt)),this.equals(yt)||this.isConstant()&&yt.isConstant()&&this.multiplier.greaterThan(yt.multiplier)},lt:function(yt){return Oe(yt)||(yt=new D(yt)),this.isConstant()&&yt.isConstant()&&this.multiplier.lessThan(yt.multiplier)},lte:function(yt){return Oe(yt)||(yt=new D(yt)),this.equals(yt)||this.isConstant()&&yt.isConstant()&&this.multiplier.lessThan(yt.multiplier)},isPoly:function(yt){var ht=this.group,ft=this.power;if(!De(ft)||0>ft)return!1;if(ht===ee||ht===le)return!0;if(this.isComposite()||ht===re&&yt){if(!yt&&1<Xe(this))return!1;for(var bt in this.symbols)if(!this.symbols[bt].isPoly(yt))return!1}else return!1;return!0},stripVar:function(yt){var ht;return(this.group===oe||this.group===le)&&this.value===yt?ht=new D(this.multiplier):this.group===re&&this.isLinear()?(ht=new D(1),this.each(function(ft){ft.contains(yt,!0)||(ht=X.multiply(ht,ft.clone()))}),ht.multiplier=ht.multiplier.multiply(this.multiplier)):this.group!==ne||this.isLinear()?this.group===ne&&this.isLinear()?(ht=new D(0),this.each(function(ft){if(!ft.contains(yt)){var bt=ft.clone();bt.multiplier=bt.multiplier.multiply(this.multiplier),ht=X.add(ht,bt)}})):this.group===se&&this.contains(yt)?ht=new D(this.multiplier):ht=this.clone():ht=new D(this.multiplier),ht},toArray:function(yt,ht){ht=ht||{arr:[],add:function(St,qt){var Et=this.arr[qt];this.arr[qt]=Et?X.add(Et,St):St}};var ft=this.group;if(ft===le&&this.contains(yt))ht.add(new D(this.multiplier),this.power);else if(ft===re){var bt=this.stripVar(yt),vt=X.divide(this.clone(),bt.clone()),wt=vt.isConstant()?0:vt.power;ht.add(bt,wt)}else if(ft===oe&&this.value===yt)this.each(function(St,qt){ht.add(St.stripVar(yt),qt)});else if(ft===ne)this.each(function(St){St.toArray(yt,ht)});else if(this.contains(yt))throw new Error('Cannot convert to array! Exiting');else ht.add(this.clone(),0);ht=ht.arr;for(var xt=0;xt<ht.length;xt++)ht[xt]||(ht[xt]=new D(0));return ht},hasFunc:function(yt){var ht=this.group===se||this.group===ie;if(ht&&!yt||ht&&this.contains(yt))return!0;if(this.symbols)for(var ft in this.symbols)if(this.symbols[ft].hasFunc(yt))return!0;return!1},sub:function(yt,ht){yt=Oe(yt)?yt.clone():X.parse(yt),ht=Oe(ht)?ht.clone():X.parse(ht),(yt.group===ee||yt.group===te)&&we('Cannot substitute a number. Must be a variable');var wt,ft=!1,bt=yt.multiplier.equals(1),vt=this.multiplier.clone();if(this.value===yt.value&&(this.group!==oe&&yt.group!==oe||this.group===oe&&yt.group===oe))(bt||yt.multiplier.equals(this.multiplier))&&(yt.isLinear()?wt=ht:yt.power.equals(this.power)&&(wt=ht,ft=!0),yt.multiplier.equals(this.multiplier)&&(vt=new R(1)));else if(this.group===re||this.previousGroup===re)wt=new D(1),this.each(function(Et){wt=X.multiply(wt,Et.sub(yt,ht))});else if(this.isComposite())wt=new D(0),this.each(function(Et){wt=X.add(wt,Et.sub(yt,ht))});else if(this.group===ie)wt=X.parse(this.value).sub(yt,ht);else if(this.group===se){for(var xt=[],St=0;St<this.args.length;St++)xt.push(this.args[St].sub(yt,ht));wt=X.symfunction(this.fname,xt)}if(wt){if(!ft){var qt=this.group===ie?this.power.sub(yt,ht):X.parse(this.power);wt=X.pow(wt,qt)}return wt.multiplier=wt.multiplier.multiply(vt),wt}return this.clone()},isMonomial:function(){if(this.group===le)return!0;if(this.group===re){for(var yt in this.symbols)if(this.symbols[yt].group!==le)return!1;}else return!1;return!0},isPi:function(){return this.group===le&&'pi'===this.value},sign:function(){return this.multiplier.sign()},isE:function(){return'e'===this.value},isSQRT:function(){return this.fname===me},isConstant:function(){return this.value===ae},isInteger:function(){return this.isConstant()&&this.multiplier.isInteger()},isLinear:function(yt){if(yt){if(this.isConstant())return!0;if(this.group===le)return this.value!==yt||this.power.equals(1);if(this.isComposite()&&this.power.equals(1)){for(var ht in this.symbols)if(!this.symbols[ht].isLinear(yt))return!1;return!0}return this.group===re&&this.symbols[yt]&&this.symbols[yt].isLinear(yt)}return this.power.equals(1)},containsFunction:function(yt){if('string'==typeof yt&&(yt=[yt]),this.group===se&&-1!==yt.indexOf(this.fname))return!0;if(this.symbols)for(var ht in this.symbols)if(this.symbols[ht].hasIntegral(yt))return!0;return!1},multiplyPower:function(yt){if(this.group===ee&&this.multiplier.equals(1))return this;var ht=this.power;if(this.group!==ie&&yt.group===ee){var ft=yt.multiplier;this.group!==ee||ft.isInteger()||this.convert(te),this.power=ht.equals(1)?ft.clone():ht.multiply(ft),this.group===te&&De(this.power)&&(this.value=_Mathpow(this.value,this.power),this.toLinear(),this.convert(ee))}else this.group!==ie&&(ht=new D(ht),this.convert(ie)),this.power=X.multiply(ht,yt);return this},setPower:function(yt,ht){if(this.group===ee&&this.multiplier.equals(1))return this;if(this.group===ie&&!Oe(yt))this.group=this.previousGroup,delete this.previousGroup,this.power=yt;else{var bt=!1;Oe(yt)&&(yt.group===ee?yt=yt.multiplier:bt=!0);var vt=bt?ie:te;this.power=yt,this.group===ee&&vt&&this.convert(vt,ht)}return this},isInverse:function(){return this.group===ie?this.power.multiplier.lessThan(0):0>this.power},clone:function(yt){var vt,ht=yt||new D(0),ft=['value','group','length','previousGroup','imaginary','fname','args'],bt=ft.length;if(this.symbols)for(var wt in ht.symbols={},this.symbols)ht.symbols[wt]=this.symbols[wt].clone();for(vt=0;vt<bt;vt++)void 0!==this[ft[vt]]&&(ht[ft[vt]]=this[ft[vt]]);return ht.power=this.power.clone(),ht.multiplier=this.multiplier.clone(),ht},toUnitMultiplier:function(yt){return this.multiplier.num=new Y(this.multiplier.num.isNegative()&&yt?-1:1),this.multiplier.den=new Y(1),this},toLinear:function(){return this.setPower(new R(1)),this},each:function(yt,ht){if(!this.symbols)yt.call(this,this,this.value);else for(var ft in this.symbols){var bt=this.symbols[ft];if(bt.group===oe&&ht)for(var vt in bt.symbols)yt.call(ft,bt.symbols[vt],vt);else yt.call(this,bt,ft)}},valueOf:function(){return this.group===ee?this.multiplier.valueOf():0===this.power?1:0===this.multiplier?0:h(this,'decimals')},contains:function(yt,ht){var ft=this.group;if(this.value===yt)return!0;if(this.symbols)for(var bt in this.symbols)if(this.symbols[bt].contains(yt,ht))return!0;if(ft===se||this.previousGroup===se)for(var vt=0;vt<this.args.length;vt++)if(this.args[vt].contains(yt,ht))return!0;if(ft===ie){if(ht&&this.power.contains(yt,ht))return!0;if(this.value===yt)return!0}return this.value===yt},negate:function(){return this.multiplier.negate(),(this.group===ne||this.group===oe)&&this.distributeMultiplier(),this},invert:function(yt){return yt||(this.multiplier=this.multiplier.invert()),Oe(this.power)?this.power.negate():this.power&&this.group!==ee&&this.power.negate(),this},distributeMultiplier:function(){if(this.symbols&&this.power.equals(1)&&this.group!==re&&!this.multiplier.equals(1)){for(var yt in this.symbols){var ht=this.symbols[yt];ht.multiplier=ht.multiplier.multiply(this.multiplier),ht.distributeMultiplier()}this.toUnitMultiplier()}return this},distributeExponent:function(){if(1!==this.power){var yt=this.power;for(var ht in this.symbols){var ft=this.symbols[ht];ft.group===ie?ft.power=X.multiply(ft.power,new D(yt)):this.symbols[ht].power=this.symbols[ht].power.multiply(yt)}this.toLinear()}return this},convert:function(yt,ht){if(yt>se){var ft=this.clone();this.symbols={},yt===re?ft.toUnitMultiplier():this.toUnitMultiplier(),this.group===se&&(ft.args=this.args,delete this.args,delete this.fname),this.isImgSymbol&&delete this.isImgSymbol,this.toLinear(),this.symbols[ft.keyForGroup(yt)]=ft,this.group=yt,this.length=1}else if(yt===ie)this.group===ee&&this.multiplier.equals(1)||(this.group!==ie&&(this.previousGroup=this.group),this.group===ee?(this.value=this.multiplier.num.toString(),this.toUnitMultiplier()):this.value=h(this,'hash'),this.group=ie);else if(yt===ee){var bt=this.multiplier.toDecimal();this.symbols&&(this.symbols=void 0),new D(this.group===te?bt*_Mathpow(this.value,this.power):bt).clone(this)}else yt==te&&this.group===ee&&('1'!==this.multiplier.den.toString()&&we('Attempting conversion of group N with non-unit denominator!'),this.value=ht?this.multiplier.num.toString():_Mathabs(this.multiplier.num.toString()),this.toUnitMultiplier(!ht),this.group=te);return this},insert:function(yt,ht){if(Oe(yt)||we('Object '+yt+' is not of type Symbol!'),this.symbols){var ft=this.group;if(ft>se){var bt=yt.keyForGroup(ft),vt=!!(bt in this.symbols)&&this.symbols[bt];if('add'===ht){var wt=bt;vt?(this.symbols[wt]=X.add(vt,yt),this.symbols[wt].multiplier.equals(0)&&(delete this.symbols[wt],this.length--,0===this.length&&(this.convert(ee),this.multiplier=new R(0)))):(this.symbols[bt]=yt,this.length++)}else yt.group===te&&De(yt.power)&&yt.convert(ee),yt.group===ie?(yt.parens=yt.multiplier.lessThan(0),this.multiplier=this.multiplier.multiply(yt.multiplier.clone().abs()),yt.toUnitMultiplier(!0)):(this.multiplier=this.multiplier.multiply(yt.multiplier),yt.toUnitMultiplier()),vt&&(yt=X.multiply(et(this.symbols,bt),yt),yt.isConstant()&&(this.multiplier=this.multiplier.multiply(yt.multiplier),yt=new D(1)),this.length--),yt.isOne(!0)?yt.multiplier.lessThan(0)&&this.negate():(this.symbols[bt]=yt,this.length++);0===this.length&&this.convert(ee),(this.group===ne||this.group===re)&&this.updateHash()}}return this},attach:function(yt){if(Ne(yt)){for(var ht=0;ht<yt.length;ht++)this.insert(yt[ht],'add');return this}return this.insert(yt,'add')},combine:function(yt){if(Ne(yt)){for(var ht=0;ht<yt.length;ht++)this.insert(yt[ht],'multiply');return this}return this.insert(yt,'multiply')},updateHash:function(){if(this.group!==ee)if(this.group===se){for(var yt='',ht=this.args,ft=this.fname===pe,bt=0;bt<ht.length;bt++)yt+=(0===bt?'':',')+h(ht[bt]);var vt=ft?'':this.fname;this.value=vt+(ft?yt:Ue(yt))}else this.group!==le&&this.group!==oe&&(this.value=h(this,'hash'))},keyForGroup:function(yt){var ft,ht=this.group;if(ht===ee)ft=this.value;else if(ht===le||ht===te)ft=yt===oe?this.power.toDecimal():this.value;else if(ht===se)ft=yt===oe?this.power.toDecimal():h(this,'hash');else{if(ht===oe)return ft=yt===re?h(this,'hash'):yt===ne?this.power.equals(1)?this.value:Ue(h(this,'hash'))+'^'+this.power.toDecimal():yt===oe?this.power.toString():this.value,ft;ht===ne?(yt===ne&&(ft=h(this,'hash')),ft=yt===oe?this.power.toDecimal():this.value):ht===re?ft=yt===oe?this.power.toDecimal():h(this,'hash'):ht===ie&&(ft=yt===oe?h(this.power):h(this,'hash'))}return ft},collectSymbols:function(yt,ht,ft,bt){var vt=[];if(!this.symbols)vt.push(this);else for(var wt in this.symbols){var xt=this.symbols[wt];bt&&(xt.group===oe||xt.group===ne)?vt=vt.concat(xt.collectSymbols()):vt.push(yt?yt(xt,ht):xt)}return null===ft&&(ft=void 0),vt.sort(ft)},latex:function(yt){return ut.latex(this,yt)},text:function(yt){return h(this,yt)},isOne:function(yt){var ht=yt?'absEquals':'equals';return this.group===ee?this.multiplier[ht](1):this.power.equals(0)},isComposite:function(){var yt=this.group,ht=this.previousGroup;return yt===ne||yt===oe||ht===oe||ht===ne},isCombination:function(){var yt=this.group,ht=this.previousGroup;return yt===re||ht===re},lessThan:function(yt){return this.multiplier.lessThan(yt)},getDenom:function(){if(this.power.lessThan(0))return this.clone();if(this.group===re)var yt=new D(1);for(var ht in this.symbols)0>this.symbols[ht].power&&(yt=X.multiply(yt,this.symbols[ht].clone()));return yt},getNum:function(){if(this.power.lessThan(0))return new D(this.multiplier.num);if(this.group===re){var yt=new D(1);for(var ht in this.symbols)0<this.symbols[ht].power&&(yt=X.multiply(yt,this.symbols[ht].clone()));return yt}return this.clone()},toString:function(){return this.text()}},U.prototype.toString=function(){return this.val},T.prototype.toString=function(){return this.val},I.prototype.toString=function(){return'`'+this.val};var at={convert:function(yt){var ft;if(0===yt)ft=[0,1];else if(1e-6>yt||1e20<yt){var bt=this.quickConversion(+yt);if(1e20>=bt[1]){var vt=_Mathabs(yt);ft=this.fullConversion(vt.toFixed((bt[1]+'').length-1)),ft[0]*=yt/vt}else ft=bt}else ft=this.fullConversion(yt);return ft},quickConversion:function(yt){var ht=(yt.toExponential()+'').split('e'),ft=ht[0].split('.')[1],bt=ft?ft.length:0;return[_Mathpow(10,bt)*ht[0],_Mathpow(10,_Mathabs(ht[1])+bt)]},fullConversion:function(yt){for(var ht=!1,ft=0,bt=1,vt=1,wt=0,xt=0,St=yt,qt=1e-16;!ht;){xt++,1e4<xt&&(ht=!0);var Et=_Mathfloor(St),Pt=ft+Et*vt,Ct=bt+Et*wt,Ot=St-Et;Ot<qt&&(ht=!0),St=1/Ot,ft=vt,bt=wt,vt=Pt,wt=Ct,(_Mathabs(Pt/Ct-yt)<qt||30<xt)&&(ht=!0)}return[Pt,Ct]}},ut={space:'~',dot:' \\cdot ',latex:function(yt,ht){if(Ne(yt)){for(var ft=[],bt=0;bt<yt.length;bt++)ft.push(this.latex(yt[bt]));return this.brackets(ft.join(', '),'square')}if(Re(yt)){for(var vt='\\begin{pmatrix}\n',bt=0;bt<yt.elements.length;bt++){for(var wt=[],xt=yt.elements[bt],St=0;St<xt.length;St++)wt.push(this.latex(xt[St]));vt+=wt.join(' & ')+'\\\\\n'}return vt+='\\end{pmatrix}',vt}yt=yt.clone();var qt='decimal'===ht,Et=yt.power,Pt=Le(Et),Ct=yt.multiplier.lessThan(0);if(yt.group===te&&qt)return yt.multiplier.toDecimal()*_Mathpow(yt.value,yt.power.toDecimal())+'';yt.multiplier=yt.multiplier.abs();var Ot;if(qt){var At=yt.multiplier.toDecimal()+'';'1'!=At||qt||(At=''),Ot=[At,'']}else Ot=[yt.multiplier.num,yt.multiplier.den];var Rt,jt=this.value(yt,Pt,ht,Ct);Pt&&Et.negate(),qt?(Rt=Oe(Et)?ut.latex(Et,ht):Et.toDecimal()+'','1'==Rt&&(Rt='')):Oe(Et)?Rt=this.latex(Et,ht):Rt=this.formatFrac(Et,!0);var Mt=['',''],Nt=Pt?1:0;Mt[Nt]=Rt;var Dt=(Ct?'-':'')+this.set(Ot,jt,Mt,yt.group===re);return Dt.replace(/\+\-/gi,'-')},greek:{alpha:'\\alpha',beta:'\\beta',gamma:'\\gamma',delta:'\\delta',epsilon:'\\epsilon',zeta:'\\zeta',eta:'\\eta',theta:'\\theta',iota:'\\iota',kappa:'\\kappa',lambda:'\\lambda',mu:'\\mu',nu:'\\nu',xi:'\\xi',omnikron:'\\omnikron',pi:'\\pi',rho:'\\rho',sigma:'\\sigma',tau:'\\tau',upsilon:'\\upsilon',phi:'\\phi',chi:'\\chi',psi:'\\psi',omega:'\\omega',Gamma:'\\Gamma',Delta:'\\Delta',Epsilon:'\\Epsilon',Theta:'\\Theta',Lambda:'\\Lambda',Xi:'\\Xi',Pi:'\\Pi',Sigma:'\\Sigma',Phi:'\\Phi',Psi:'\\Psi',Omega:'\\Omega'},value:function(yt,ht,ft,bt){var vt=yt.group,wt=yt.previousGroup,xt=['',''],St=ht?1:0;if(vt===le||vt===te||wt===le||wt===te||wt===ee){var qt=yt.value,Et=this.greek[qt];Et&&(qt=Et),xt[St]=qt}else if(vt===se||wt===se){for(var Pt,Ct=[],Ot=yt.fname,At=0;At<yt.args.length;At++){var Rt,jt=yt.args[At];Rt='string'==typeof jt?jt:this.latex(jt,ft),Ct.push(Rt)}if(Ot===me)xt[St]='\\sqrt'+this.braces(Ct.join(','));else if(Ot===ce)xt[St]=this.brackets(Ct.join(','),'abs');else if(Ot===pe)xt[St]=this.brackets(Ct.join(','),'parens');else if('integrate'===Ot)xt[St]='\\int'+this.braces(Ct[0])+this.braces('d'+Ct[1]);else if(Ot===ge||Ot===de){var jt=yt.args[0];jt.power.equals(1)&&(jt.isComposite()||jt.isCombination())&&(Ct[0]=this.brackets(Ct[0])),xt[St]=Ct[0]+(Ot===ge?'!':'!!')}else{var Pt='\\mathrm'+this.braces(Ot);xt[St]=Pt+this.brackets(Ct.join(','),'parens')}}else if(yt.isComposite()){for(var Mt=yt.collectSymbols().sort(vt===ne||wt===ne?function(Bt,Gt){return Gt.group-Bt.group}:function(Bt,Gt){var Vt=Oe(Bt.power)?-1:Bt.power,Zt=Oe(Gt.power)?-1:Gt.power;return Zt-Vt}),Nt=[],Dt=Mt.length,At=0;At<Dt;At++)Nt.push(ut.latex(Mt[At],ft));var qt=Nt.join('+');xt[St]=!(yt.isLinear()&&yt.multiplier.equals(1))||bt?this.brackets(qt,'parens'):qt}else if(vt===re||wt===ie){var Lt=[],Ut=[],_t=[],Tt=[],It=0,kt=0,Ft=function(Bt,Gt,Vt){if(1<Vt&&0<Gt.length)for(var Zt=Gt.length,zt=0;zt<Zt;zt++){var Ht=Gt[zt],Qt=Bt[Ht];/^\\left\(.+\\right\)\^\{.+\}$/g.test(Qt)||/^\\left\(.+\\right\)$/g.test(Qt)||(Bt[Ht]=ut.brackets(Qt,'parens'))}return Bt};yt.each(function(Bt){var Vt,Gt=Le(Bt.power);Gt?(Vt=ut.latex(Bt.invert(),ft),kt++,Bt.isComposite()&&(1!=yt.multiplier.den&&1==_Mathabs(Bt.power)&&(Vt=ut.brackets(Vt,'parens')),_t.push(Lt.length)),Lt.push(Vt)):(Vt=ut.latex(Bt,ft),It++,Bt.isComposite()&&(1!=yt.multiplier.num&&1==_Mathabs(Bt.power)&&(Vt=ut.brackets(Vt,'parens')),Tt.push(Ut.length)),Ut.push(Vt))}),Ft(Ut,Tt,It),xt[0]=Ut.join(this.dot),Ft(Lt,_t,kt),xt[1]=Lt.join(this.dot)}return xt},set:function(yt,ht,ft,bt){var vt=function(At){return /^\\left\(.+\\right\)$/.test(At)};if(ft&&(ft=this.formatP(ft)),bt){var wt=ft[0];ft[0]=''}ht=this.merge(ht,ft);var xt=yt[0],St=yt[1],qt=ht[0],Et=ht[1];qt&&1==xt&&(xt=''),1==St&&(St='');var Pt=this.join(xt,qt,vt(qt)?'':this.dot),Ct=this.join(St,Et,vt(Et)?'':this.dot);if(Pt&&Ct){var Ot=this.frac(Pt,Ct);return bt&&wt&&(Ot=this.brackets(Ot)+wt),Ot}return Pt},merge:function(yt,ht){for(var ft=[],bt=0;2>bt;bt++)ft[bt]=yt[bt]+ht[bt];return ft},join:function(yt,ht,ft){return yt||ht?yt&&!ht?yt:ht&&!yt?ht:yt+ft+ht:''},formatP:function(yt){for(var ft,ht=0;2>ht;ht++)ft=yt[ht],ft&&(yt[ht]='^'+this.braces(ft));return yt},formatFrac:function(yt,ht){var ft=yt.num.toString(),bt=yt.den.toString();return ht&&'1'===ft&&'1'===bt?'':'1'===bt?ft:this.frac(ft,bt)},frac:function(yt,ht){return'\\frac'+this.braces(yt)+this.braces(ht)},braces:function(yt){return'{'+yt+'}'},brackets:function(yt,ht){ht=ht||'parens';var bt={parens:['(',')'],square:['[',']'],brace:['{','}'],abs:['|','|'],angle:['\\langle','\\rangle']}[ht];return'\\left'+bt[0]+yt+'\\right'+bt[1]}};Z.arrayPrefill=function(yt,ht){var ft=[];ht=ht||0;for(var bt=0;bt<yt;bt++)ft[bt]=ht;return ft},Z.fromArray=function(yt){var ht=new Z;return ht.elements=yt,ht},Z.prototype={custom:!0,e:function(yt){return 1>yt||yt>this.elements.length?null:this.elements[yt-1]},set:function(yt,ht){this.elements[yt]=new D(ht)},dimensions:function(){return this.elements.length},modulus:function(){return tt('SAFE',function(){return X.pow(this.dot(this.clone()),new D(0.5))},void 0,this)},eql:function(yt){var ht=this.elements.length,ft=yt.elements||yt;if(ht!==ft.length)return!1;do if(_Mathabs(X.subtract(this.elements[ht-1],ft[ht-1]).valueOf())>PRECISION)return!1;while(--ht);return!0},clone:function(){for(var yt=new Z,ht=this.elements.length,ft=0;ft<ht;ft++)yt.elements.push(this.elements[ft].clone());return yt},map:function(yt){var ht=[];return this.each(function(ft,bt){ht.push(yt(ft,bt))}),new Z(ht)},each:function(yt){var bt,ht=this.elements.length,ft=ht;do bt=ft-ht,yt(this.elements[bt],bt+1);while(--ht)},toUnitVector:function(){return tt('SAFE',function(){var yt=this.modulus();return 0===yt.valueOf()?this.clone():this.map(function(ht){return X.divide(ht,yt)})},void 0,this)},angleFrom:function(yt){return tt('SAFE',function(){var ht=yt.elements||yt,ft=this.elements.length;if(ft!==ht.length)return null;var bt=new D(0),vt=new D(0),wt=new D(0);this.each(function(Et,Pt){bt=X.add(bt,X.multiply(Et,ht[Pt-1])),vt=X.add(vt,X.multiply(Et,Et)),wt=X.add(wt,X.multiply(ht[Pt-1],ht[Pt-1]))}),vt=X.pow(vt,new D(0.5)),wt=X.pow(wt,new D(0.5));var xt=X.multiply(vt,wt);if(0===xt.valueOf())return null;var St=X.divide(bt,xt),qt=St.valueOf();return-1>qt&&(St=-1),1<qt&&(St=1),new D(Math.acos(St))},void 0,this)},isParallelTo:function(yt){var ht=this.angleFrom(yt).valueOf();return null===ht?null:ht<=PRECISION},isAntiparallelTo:function(yt){var ht=this.angleFrom(yt).valueOf();return null===ht?null:_Mathabs(ht-_MathPI)<=Sylvester.precision},isPerpendicularTo:function(yt){var ht=this.dot(yt);return null===ht?null:_Mathabs(ht)<=Sylvester.precision},add:function(yt){return tt('SAFE',function(){var ht=yt.elements||yt;return this.elements.length===ht.length?this.map(function(ft,bt){return X.add(ft,ht[bt-1])}):null},void 0,this)},subtract:function(yt){return tt('SAFE',function(){var ht=yt.elements||yt;return this.elements.length===ht.length?this.map(function(ft,bt){return X.subtract(ft,ht[bt-1])}):null},void 0,this)},multiply:function(yt){return this.map(function(ht){return ht.clone()*yt.clone()})},x:function(yt){return this.multiply(yt)},dot:function(yt){return tt('SAFE',function(){var ht=yt.elements||yt,ft=new D(0),bt=this.elements.length;if(bt!==ht.length)return null;do ft=X.add(ft,X.multiply(this.elements[bt-1],ht[bt-1]));while(--bt);return ft},void 0,this)},cross:function(yt){var ht=yt.elements||yt;if(3!==this.elements.length||3!==ht.length)return null;var ft=this.elements;return tt('SAFE',function(){return new Z([X.subtract(X.multiply(ft[1],ht[2]),X.multiply(ft[2],ht[1])),X.subtract(X.multiply(ft[2],ht[0]),X.multiply(ft[0],ht[2])),X.subtract(X.multiply(ft[0],ht[1]),X.multiply(ft[1],ht[0]))])},void 0,this)},max:function(){var bt,yt=0,ht=this.elements.length,ft=ht;do bt=ft-ht,_Mathabs(this.elements[bt].valueOf())>_Mathabs(yt.valueOf())&&(yt=this.elements[bt]);while(--ht);return yt},indexOf:function(yt){var vt,ht=null,ft=this.elements.length,bt=ft;do vt=bt-ft,null==ht&&this.elements[vt].valueOf()===yt.valueOf()&&(ht=vt+1);while(--ft);return ht},text:function(){return h(this)},toString:function(){return this.text()},latex:function(yt){var ht=[];for(var ft in this.elements)ht.push(ut.latex.call(ut,this.elements[ft],yt));return'['+ht.join(', ')+']'}},H.identity=function(yt){for(var ht=new H,ft=0;ft<yt;ft++){ht.elements.push([]);for(var bt=0;bt<yt;bt++)ht.set(ft,bt,ft===bt?new D(1):new D(0))}return ht},H.fromArray=function(yt){function ht(ft){return H.apply(this,ft)}return ht.prototype=H.prototype,new ht(yt)},H.zeroMatrix=function(yt,ht){for(var ft=new H,bt=0;bt<yt;bt++)ft.elements.push(Z.arrayPrefill(ht,new D(0)));return ft},H.prototype={custom:!0,get:function(yt,ht){return this.elements[yt]?this.elements[yt][ht]:void 0},set:function(yt,ht,ft){this.elements[yt]||(this.elements[yt]=[]),this.elements[yt][ht]=Oe(ft)?ft:new D(ft)},cols:function(){return this.elements[0].length},rows:function(){return this.elements.length},row:function(yt){return!yt||yt>this.cols()?[]:this.elements[yt-1]},col:function(yt){var ht=this.rows(),ft=[];if(yt>this.cols()||!yt)return ft;for(var bt=0;bt<ht;bt++)ft.push(this.elements[bt][yt-1]);return ft},eachElement:function(yt){var bt,vt,ht=this.rows(),ft=this.cols();for(bt=0;bt<ht;bt++)for(vt=0;vt<ft;vt++)this.elements[bt][vt]=yt.call(this,this.elements[bt][vt],bt,vt)},determinant:function(){if(!this.isSquare())return null;var vt,yt=this.toRightTriangular(),ht=yt.elements[0][0],ft=yt.elements.length-1,bt=ft;do vt=bt-ft+1,ht=X.multiply(ht,yt.elements[vt][vt]);while(--ft);return ht},isSquare:function(){return this.elements.length===this.elements[0].length},isSingular:function(){return this.isSquare()&&0===this.determinant()},augment:function(yt){var ht=this.rows(),ft=yt.rows();ht!==ft&&we('Cannot augment matrix. Rows don\'t match.');for(var bt=0;bt<ht;bt++)this.elements[bt]=this.elements[bt].concat(yt.elements[bt]);return this},clone:function(){for(var yt=this.rows(),ht=this.cols(),ft=new H,bt=0;bt<yt;bt++){ft.elements[bt]=[];for(var wt,vt=0;vt<ht;vt++)wt=this.elements[bt][vt],ft.elements[bt][vt]=Oe(wt)?wt.clone():wt}return ft},invert:function(){return this.isSquare()||we('Matrix is not square!'),tt('SAFE',function(){var ft,bt,xt,qt,Et,Pt,Ot,yt=this.elements.length,ht=yt,vt=H.identity(yt),wt=this.augment(vt).toRightTriangular(),St=wt.elements[0].length,Ct=[];do{ft=yt-1,Et=[],xt=St,Ct[ft]=[],Pt=wt.elements[ft][ft];do qt=St-xt,Ot=X.divide(wt.elements[ft][qt],Pt.clone()),Et.push(Ot),qt>=ht&&Ct[ft].push(Ot);while(--xt);for(wt.elements[ft]=Et,bt=0;bt<ft;bt++){Et=[],xt=St;do qt=St-xt,Et.push(X.subtract(wt.elements[bt][qt].clone(),X.multiply(wt.elements[ft][qt].clone(),wt.elements[bt][ft].clone())));while(--xt);wt.elements[bt]=Et}}while(--yt);return H.fromArray(Ct)},void 0,this)},toRightTriangular:function(){return tt('SAFE',function(){var ht,ft,bt,xt,St,Et,yt=this.clone(),vt=this.elements.length,wt=vt,qt=this.elements[0].length;do{if(xt=wt-vt,ft=yt.elements[xt][xt],0===ft.valueOf())for(var Pt=xt+1;Pt<wt;Pt++)if(bt=yt.elements[Pt][xt],bt&&0!==bt.valueOf()){ht=[],St=qt;do Et=qt-St,ht.push(X.add(yt.elements[xt][Et].clone(),yt.elements[Pt][Et].clone()));while(--St);yt.elements[xt]=ht;break}var ft=yt.elements[xt][xt];if(0!==ft.valueOf())for(Pt=xt+1;Pt<wt;Pt++){var Ct=X.divide(yt.elements[Pt][xt].clone(),yt.elements[xt][xt].clone());ht=[],St=qt;do Et=qt-St,ht.push(Et<=xt?new D(0):X.subtract(yt.elements[Pt][Et].clone(),X.multiply(yt.elements[xt][Et].clone(),Ct.clone())));while(--St);yt.elements[Pt]=ht}}while(--vt);return yt},void 0,this)},transpose:function(){var vt,wt,xt,yt=this.elements.length,ht=this.elements[0].length,ft=new H,bt=ht;do{vt=ht-bt,ft.elements[vt]=[],wt=yt;do xt=yt-wt,ft.elements[vt][xt]=this.elements[xt][vt].clone();while(--wt)}while(--bt);return ft},canMultiplyFromLeft:function(yt){var ht=Re(yt)?yt.elements.length:yt.length;return this.elements[0].length===ht},sameSize:function(yt){return this.rows()===yt.rows()&&this.cols()===yt.cols()},multiply:function(yt){return tt('SAFE',function(){var ht=yt.elements||yt;if(!this.canMultiplyFromLeft(ht)){if(this.sameSize(yt)){for(var wt,ft=new H,bt=this.rows(),vt=0;vt<bt;vt++)wt=X.multiply(new Z(this.elements[vt]),new Z(yt.elements[vt])),ft.elements[vt]=wt.elements;return ft}return null}var vt,qt,Pt,At,jt,Rt,xt=this.elements.length,St=xt,Et=ht[0].length,Ct=this.elements[0].length,Ot=[];do{vt=St-xt,Ot[vt]=[],qt=Et;do{Pt=Et-qt,At=new D(0),jt=Ct;do Rt=Ct-jt,At=X.add(At,X.multiply(this.elements[vt][Rt],ht[Rt][Pt]));while(--jt);Ot[vt][Pt]=At}while(--qt)}while(--xt);return H.fromArray(Ot)},void 0,this)},add:function(yt){var ht=new H;return this.sameSize(yt)&&this.eachElement(function(ft,bt,vt){ht.set(bt,vt,X.add(ft.clone(),yt.elements[bt][vt]))}),ht},subtract:function(yt){var ht=new H;return this.sameSize(yt)&&this.eachElement(function(ft,bt,vt){ht.set(bt,vt,X.subtract(ft.clone(),yt.elements[bt][vt]))}),ht},negate:function(){return this.each(function(yt){return yt.negate()}),this},toVector:function(){if(1===this.rows()||1===this.cols()){var yt=new Z;return yt.elements=this.elements,yt}return this},toString:function(yt){var ht=this.rows(),ft=[];yt=void 0===yt?'\n':yt;for(var bt=0;bt<ht;bt++)ft.push('['+this.elements[bt].map(function(vt){return void 0===vt?'':vt.toString()}).join(',')+']');return'matrix'+Ue(ft.join(','))},text:function(){return'matrix('+this.toString('')+')'},latex:function(yt){var ht=this.cols(),ft=this.elements;return ke('\\begin{vmatrix}{0}\\end{vmatrix}',function(){var bt=[];for(var vt in ft){for(var wt=[],xt=0;xt<ht;xt++)wt.push(ut.latex.call(ut,ft[vt][xt],yt));bt.push(wt.join(' & '))}return bt.join(' \\cr ')})}},H.prototype.each=H.prototype.eachElement;var ct=K.build=function(yt,ht){var ft=Xe(yt),bt=[],vt=function(qt,Et){Et=Et||[];var Pt=[],Ct=qt.group,Ot='',At=function(Dt){var Lt=Dt===re?'*':'+',Ut=[];for(var _t in qt.symbols)Ut.push(vt(qt.symbols[_t],Et)[0]);var Tt=Ut.join(Lt);return Tt&&!qt.multiplier.equals(1)?Ue(Tt):Tt},jt=function(Dt){var Lt;return Dt in Math?Lt='Math.'+Dt:(-1===bt.indexOf(Dt)&&(Et.push('var '+Dt+' = '+nt[Dt].toString()+'; '),bt.push(Dt)),Lt=Dt),Lt+=Ue(qt.args.map(function(Ut){return vt(Ut,Et)[0]}).join(',')),Lt};Ct===ee?Pt.push(qt.multiplier.toDecimal()):qt.multiplier.equals(-1)?Ot='-':!qt.multiplier.equals(1)&&Pt.push(qt.multiplier.toDecimal());var Rt;if(Ct===le||Ct===te)Rt=qt.value;else if(Ct===se)Rt=jt(qt.fname);else if(Ct===ie){var Mt=qt.previousGroup;Rt=Mt===ee||Mt===le?qt.value:Mt===se?jt(qt.fname):At(qt.previousGroup)}else Rt=At(qt.group);if(qt.group!==ee&&!qt.power.equals(1)){var Nt=vt(X.parse(qt.power));Et.push(Nt[1]),Rt='Math.pow'+Ue(Rt+','+Nt[0])}return Rt&&Pt.push(Ot+Rt),[Pt.join('*'),Et.join('').replace(/\n+\s+/g,' ')]};if(ht){ft.length!==ht.length&&we('Argument array contains wrong number of arguments');for(var xt,wt=0;wt<ft.length;wt++)xt=ft[wt],-1===ht.indexOf(xt)&&we(xt+' not found in argument array');ft=ht}var St=vt(yt);return new Function(ft,St[1]+' return '+St[0]+';')};(function(){$e(X.constants),$e(X.functions),rt($.init_primes)})();var gt={Operator:U,groups:W,Symbol:D,Expression:O,Frac:R,Vector:Z,Matrix:H,Parser:G,Fraction:at,Math2:nt,LaTeX:ut,Utils:K,PRIMES:J,PARSER:X,PARENTHESIS:pe,Settings:$,VARS:he,err:we,bigInt:Y},dt=function(yt,ht,ft,bt){var vt,wt,xt;yt instanceof O&&(yt=yt.toString());var St=Ne(ft),qt='expand',Et=St?-1!==ft.indexOf('numer'):'numer'===ft;(St?-1!==ft.indexOf(qt):ft===qt)&&(yt=ke('{0}({1})',qt,yt));var Pt=tt('PARSE2NUMBER',function(){return X.parse(yt,ht)},Et||$.PARSE2NUMBER);return bt?ye[bt-1]=Pt:ye.push(Pt),vt&&dt.setVar(vt,Pt),wt&&dt.setFunction(wt,xt,Pt),new O(Pt)};return dt.rpn=function(yt){return X.parse(yt,null,!0)},dt.version=function(yt){if(yt)try{return gt[yt].version}catch(ht){return'No module named '+yt+' found!'}return'0.7.5'},dt.getWarnings=function(){return be},dt.setConstant=function(yt,ht){if(Se(yt),!ve(yt))if('delete'===ht)delete X.constants[yt];else{if(isNaN(ht))throw new Error('Constant must be a number!');X.constants[yt]=ht}return this},dt.setFunction=function(yt,ht,ft){return Se(yt),!ve(yt)&&(ht=ht||Xe(X.parse(ft)),X.functions[yt]=[X.mapped_function,ht.length,{name:yt,params:ht,body:ft}],!0)},dt.getCore=function(){return gt},dt.getExpression=dt.getEquation=O.getExpression,dt.reserved=function(yt){return yt?fe:fe.join(', ')},dt.clear=function(yt,ht){if('all'===yt)ye=[];else if('last'===yt)ye.pop();else if('first'===yt)ye.shift();else{var ft=yt?yt-1:ye.length;!0===ht?ye[ft]=void 0:et(ye,ft)}return this},dt.flush=function(){return this.clear('all'),this},dt.expressions=function(yt,ht,ft){for(var wt,bt=yt?{}:[],vt=0;vt<ye.length;vt++)wt=ht?ut.latex(ye[vt],ft):h(ye[vt],ft),yt?bt[vt+1]=wt:bt.push(wt);return bt},dt.register=function(yt){var ht=this.getCore();if(Ne(yt))for(var ft=0;ft<yt.length;ft++)yt&&this.register(yt[ft]);else if(yt&&-1===$.exclude.indexOf(yt.name)){if(yt.dependencies)for(var ft=0;ft<yt.dependencies.length;ft++)if(!ht[yt.dependencies[ft]])throw new Error(ke('{0} requires {1} to be loaded!',yt.name,yt.dependencies[ft]));var bt=yt.parent,vt=yt.build.call(ht);if(bt){ht[bt]||(ht[yt.parent]={});var wt='nerdamer'===bt?this:ht[bt];wt[yt.name]=vt}yt.visible&&(X.functions[yt.name]=[vt,yt.numargs])}},dt.validateName=Se,dt.validVarName=function(yt){try{return Se(yt),-1===fe.indexOf(yt)}catch(ht){return!1}},dt.supported=function(){return Fe(X.functions)},dt.numEquations=dt.numExpressions=function(){return ye.length},dt.setVar=function(yt,ht){return Se(yt),yt in X.constants&&we('Cannot set value for constant '+yt),'delete'===ht?delete he[yt]:he[yt]=Oe(ht)?ht:X.parse(ht),this},dt.clearVars=function(){return he={},this},dt.load=function(yt){return yt.call(this),this},dt.getVars=function(yt,ht){yt=yt||'text';var ft={};if('object'===yt)ft=he;else for(var bt in he)'latex'===yt?ft[bt]=he[bt].latex(ht):'text'==yt&&(ft[bt]=he[bt].text(ht));return ft},dt.set=function(yt,ht){-1!==['SAFE'].indexOf(yt)&&we('Cannot modify setting: '+yt),$[yt]=ht},dt.api=function(yt){var ht=function(bt){return function(){for(var vt=[].slice.call(arguments),wt=0;wt<vt.length;wt++)vt[wt]=X.parse(vt[wt]);return new O(tt('PARSE2NUMBER',function(){return X.callfunction(bt,vt)}))}};for(var ft in X.functions)(!(ft in dt)||yt)&&(dt[ft]=ht(ft))},dt.api(),dt}({bigInt:function(u){'use strict';function h(Le,Ue){this.value=Le,this.sign=Ue,this.isSmall=!1}function E(Le){this.value=Le,this.sign=0>Le,this.isSmall=!0}function O(Le){return-qe<Le&&Le<qe}function R(Le){return 1e7>Le?[Le]:1e14>Le?[Le%1e7,_Mathfloor(Le/1e7)]:[Le%1e7,_Mathfloor(Le/1e7)%1e7,_Mathfloor(Le/1e14)]}function D(Le){L(Le);var Ue=Le.length;return 4>Ue&&0>re(Le,Ee)?0===Ue?0:1===Ue?Le[0]:2===Ue?Le[0]+Le[1]*xe:Le[0]+(Le[1]+Le[2]*xe)*xe:Le}function L(Le){for(var Ue=Le.length;0===Le[--Ue];);Le.length=Ue+1}function U(Le){for(var Ue=Array(Le),_e=-1;++_e<Le;)Ue[_e]=0;return Ue}function T(Le){return 0<Le?_Mathfloor(Le):_Mathceil(Le)}function I(Le,Ue){var Be,Ge,_e=Le.length,Te=Ue.length,Ie=Array(_e),ke=0,Fe=xe;for(Ge=0;Ge<Te;Ge++)Be=Le[Ge]+Ue[Ge]+ke,ke=Be>=Fe?1:0,Ie[Ge]=Be-ke*Fe;for(;Ge<_e;)Be=Le[Ge]+ke,ke=Be===Fe?1:0,Ie[Ge++]=Be-ke*Fe;return 0<ke&&Ie.push(ke),Ie}function G(Le,Ue){return Le.length>=Ue.length?I(Le,Ue):I(Ue,Le)}function Z(Le,Ue){var ke,Fe,_e=Le.length,Te=Array(_e),Ie=xe;for(Fe=0;Fe<_e;Fe++)ke=Le[Fe]-Ie+Ue,Ue=_Mathfloor(ke/Ie),Te[Fe]=ke-Ue*Ie,Ue+=1;for(;0<Ue;)Te[Fe++]=Ue%Ie,Ue=_Mathfloor(Ue/Ie);return Te}function H(Le,Ue){var Be,Ge,_e=Le.length,Te=Ue.length,Ie=Array(_e),ke=0,Fe=xe;for(Be=0;Be<Te;Be++)Ge=Le[Be]-ke-Ue[Be],0>Ge?(Ge+=Fe,ke=1):ke=0,Ie[Be]=Ge;for(Be=Te;Be<_e;Be++){if(Ge=Le[Be]-ke,0>Ge)Ge+=Fe;else{Ie[Be++]=Ge;break}Ie[Be]=Ge}for(;Be<_e;Be++)Ie[Be]=Le[Be];return L(Ie),Ie}function Q(Le,Ue,_e){var Te;return 0<=re(Le,Ue)?Te=H(Le,Ue):(Te=H(Ue,Le),_e=!_e),Te=D(Te),'number'==typeof Te?(_e&&(Te=-Te),new E(Te)):new h(Te,_e)}function X(Le,Ue,_e){var Be,Ge,Te=Le.length,Ie=Array(Te),ke=-Ue,Fe=xe;for(Be=0;Be<Te;Be++)Ge=Le[Be]+ke,ke=_Mathfloor(Ge/Fe),Ge%=Fe,Ie[Be]=0>Ge?Ge+Fe:Ge;return Ie=D(Ie),'number'==typeof Ie?(_e&&(Ie=-Ie),new E(Ie)):new h(Ie,_e)}function Y(Le,Ue){var Be,Ge,Ve,Ze,ze,_e=Le.length,Te=Ue.length,ke=U(_e+Te),Fe=xe;for(Ve=0;Ve<_e;++Ve){Ze=Le[Ve];for(var He=0;He<Te;++He)ze=Ue[He],Be=Ze*ze+ke[Ve+He],Ge=_Mathfloor(Be/Fe),ke[Ve+He]=Be-Ge*Fe,ke[Ve+He+1]+=Ge}return L(ke),ke}function W(Le,Ue){var Fe,Be,_e=Le.length,Te=Array(_e),Ie=xe,ke=0;for(Be=0;Be<_e;Be++)Fe=Le[Be]*Ue+ke,ke=_Mathfloor(Fe/Ie),Te[Be]=Fe-ke*Ie;for(;0<ke;)Te[Be++]=ke%Ie,ke=_Mathfloor(ke/Ie);return Te}function J(Le,Ue){for(var _e=[];0<Ue--;)_e.push(0);return _e.concat(Le)}function K(Le,Ue){var _e=_Mathmax(Le.length,Ue.length);if(30>=_e)return Y(Le,Ue);_e=_Mathceil(_e/2);var Te=Le.slice(_e),Ie=Le.slice(0,_e),ke=Ue.slice(_e),Fe=Ue.slice(0,_e),Be=K(Ie,Fe),Ge=K(Te,ke),Ve=K(G(Ie,Te),G(Fe,ke)),Ze=G(G(Be,J(H(H(Ve,Be),Ge),_e)),J(Ge,2*_e));return L(Ze),Ze}function $(Le,Ue){return 0<-0.012*Le-0.012*Ue+1.5e-5*Le*Ue}function ee(Le,Ue,_e){return Le<xe?new h(W(Ue,Le),_e):new h(Y(Ue,R(Le)),_e)}function te(Le){var Ie,ke,Fe,Be,Ge,Ue=Le.length,_e=U(Ue+Ue),Te=xe;for(Fe=0;Fe<Ue;Fe++){Be=Le[Fe];for(var Ve=0;Ve<Ue;Ve++)Ge=Le[Ve],Ie=Be*Ge+_e[Fe+Ve],ke=_Mathfloor(Ie/Te),_e[Fe+Ve]=Ie-ke*Te,_e[Fe+Ve+1]+=ke}return L(_e),_e}function le(Le,Ue){var Ze,ze,He,Qe,Xe,Ye,We,_e=Le.length,Te=Ue.length,Ie=xe,ke=U(Ue.length),Fe=Ue[Te-1],Be=_Mathceil(Ie/(2*Fe)),Ge=W(Le,Be),Ve=W(Ue,Be);for(Ge.length<=_e&&Ge.push(0),Ve.push(0),Fe=Ve[Te-1],ze=_e-Te;0<=ze;ze--){for(Ze=Ie-1,Ge[ze+Te]!==Fe&&(Ze=_Mathfloor((Ge[ze+Te]*Ie+Ge[ze+Te-1])/Fe)),He=0,Qe=0,Ye=Ve.length,Xe=0;Xe<Ye;Xe++)He+=Ze*Ve[Xe],We=_Mathfloor(He/Ie),Qe+=Ge[ze+Xe]-(He-We*Ie),He=We,0>Qe?(Ge[ze+Xe]=Qe+Ie,Qe=-1):(Ge[ze+Xe]=Qe,Qe=0);for(;0!==Qe;){for(Ze-=1,He=0,Xe=0;Xe<Ye;Xe++)He+=Ge[ze+Xe]-Ie+Ve[Xe],0>He?(Ge[ze+Xe]=He+Ie,He=0):(Ge[ze+Xe]=He,He=1);Qe+=He}ke[ze]=Ze}return Ge=se(Ge,Be)[0],[D(ke),D(Ge)]}function ie(Le,Ue){for(var Be,Ge,Ve,Ze,ze,_e=Le.length,Te=Ue.length,Ie=[],ke=[],Fe=xe;_e;){if(ke.unshift(Le[--_e]),0>re(ke,Ue)){Ie.push(0);continue}Ge=ke.length,Ve=ke[Ge-1]*Fe+ke[Ge-2],Ze=Ue[Te-1]*Fe+Ue[Te-2],Ge>Te&&(Ve=(Ve+1)*Fe),Be=_Mathceil(Ve/Ze);do{if(ze=W(Ue,Be),0>=re(ze,ke))break;Be--}while(Be);Ie.push(Be),ke=H(ke,ze)}return Ie.reverse(),[D(Ie),D(ke)]}function se(Le,Ue){var ke,Fe,Be,Ge,_e=Le.length,Te=U(_e);for(Be=0,ke=_e-1;0<=ke;--ke)Ge=Be*xe+Le[ke],Fe=T(Ge/Ue),Be=Ge-Fe*Ue,Te[ke]=0|Fe;return[Te,0|Be]}function oe(Le,Ue){var _e,Fe,Te=we(Ue),Ie=Le.value,ke=Te.value;if(0===ke)throw new Error('Cannot divide by zero');if(Le.isSmall)return Te.isSmall?[new E(T(Ie/ke)),new E(Ie%ke)]:[Ne[0],Le];if(Te.isSmall){if(1===ke)return[Le,Ne[0]];if(-1==ke)return[Le.negate(),Ne[0]];var Be=_Mathabs(ke);if(Be<xe){_e=se(Ie,Be),Fe=D(_e[0]);var Ge=_e[1];return Le.sign&&(Ge=-Ge),'number'==typeof Fe?(Le.sign!==Te.sign&&(Fe=-Fe),[new E(Fe),new E(Ge)]):[new h(Fe,Le.sign!==Te.sign),new E(Ge)]}ke=R(Be)}var Ve=re(Ie,ke);if(-1===Ve)return[Ne[0],Le];if(0===Ve)return[Ne[Le.sign===Te.sign?1:-1],Ne[0]];_e=200>=Ie.length+ke.length?le(Ie,ke):ie(Ie,ke),Fe=_e[0];var Ze=Le.sign!==Te.sign,ze=_e[1],He=Le.sign;return'number'==typeof Fe?(Ze&&(Fe=-Fe),Fe=new E(Fe)):Fe=new h(Fe,Ze),'number'==typeof ze?(He&&(ze=-ze),ze=new E(ze)):ze=new h(ze,He),[Fe,ze]}function re(Le,Ue){if(Le.length!==Ue.length)return Le.length>Ue.length?1:-1;for(var _e=Le.length-1;0<=_e;_e--)if(Le[_e]!==Ue[_e])return Le[_e]>Ue[_e]?1:-1;return 0}function ne(Le){var Ue=Le.abs();return!Ue.isUnit()&&(Ue.equals(2)||Ue.equals(3)||Ue.equals(5)||(Ue.isEven()||Ue.isDivisibleBy(3)||Ue.isDivisibleBy(5)?!1:!!Ue.lesser(25)||void 0))}function ae(Le){return('number'==typeof Le||'string'==typeof Le)&&+_Mathabs(Le)<=xe||Le instanceof h&&1>=Le.value.length}function pe(Le,Ue,_e){Ue=we(Ue);for(var Te=Le.isNegative(),Ie=Ue.isNegative(),ke=Te?Le.not():Le,Fe=Ie?Ue.not():Ue,Be=[],Ge=[],Ve=!1,Ze=!1;!Ve||!Ze;)ke.isZero()?(Ve=!0,Be.push(Te?1:0)):Te?Be.push(ke.isEven()?1:0):Be.push(ke.isEven()?0:1),Fe.isZero()?(Ze=!0,Ge.push(Ie?1:0)):Ie?Ge.push(Fe.isEven()?1:0):Ge.push(Fe.isEven()?0:1),ke=ke.over(2),Fe=Fe.over(2);for(var ze=[],He=0;He<Be.length;He++)ze.push(_e(Be[He],Ge[He]));for(var Qe=bigInt(ze.pop()).negate().times(bigInt(2).pow(ze.length));ze.length;)Qe=Qe.add(bigInt(ze.pop()).times(bigInt(2).pow(ze.length)));return Qe}function ue(Le){var Ue=Le.value,_e='number'==typeof Ue?Ue|je:Ue[0]+Ue[1]*xe|Re;return _e&-_e}function me(Le,Ue){return Le=we(Le),Ue=we(Ue),Le.greater(Ue)?Le:Ue}function ce(Le,Ue){return Le=we(Le),Ue=we(Ue),Le.lesser(Ue)?Le:Ue}function ge(Le,Ue){if(Le=we(Le).abs(),Ue=we(Ue).abs(),Le.equals(Ue))return Le;if(Le.isZero())return Ue;if(Ue.isZero())return Le;for(var Te,Ie,_e=Ne[1];Le.isEven()&&Ue.isEven();)Te=_Mathmin(ue(Le),ue(Ue)),Le=Le.divide(Te),Ue=Ue.divide(Te),_e=_e.multiply(Te);for(;Le.isEven();)Le=Le.divide(ue(Le));do{for(;Ue.isEven();)Ue=Ue.divide(ue(Ue));Le.greater(Ue)&&(Ie=Ue,Ue=Le,Le=Ie),Ue=Ue.subtract(Le)}while(!Ue.isZero());return _e.isUnit()?Le:Le.multiply(_e)}function he(Le){var Ue=Le.value;return'number'==typeof Ue&&(Ue=[Ue]),1===Ue.length&&35>=Ue[0]?'0123456789abcdefghijklmnopqrstuvwxyz'.charAt(Ue[0]):'<'+Ue+'>'}function fe(Le,Ue){if(Ue=bigInt(Ue),Ue.isZero()){if(Le.isZero())return'0';throw new Error('Cannot convert nonzero numbers to base 0.')}if(Ue.equals(-1))return Le.isZero()?'0':Le.isNegative()?Array(1-Le).join('10'):'1'+Array(+Le).join('01');var _e='';if(Le.isNegative()&&Ue.isPositive()&&(_e='-',Le=Le.abs()),Ue.equals(1))return Le.isZero()?'0':_e+Array(+Le+1).join(1);for(var ke,Te=[],Ie=Le;Ie.isNegative()||0<=Ie.compareAbs(Ue);){ke=Ie.divmod(Ue),Ie=ke.quotient;var Fe=ke.remainder;Fe.isNegative()&&(Fe=Ue.minus(Fe).abs(),Ie=Ie.next()),Te.push(he(Fe))}return Te.push(he(Ie)),_e+Te.reverse().join('')}function be(Le){if(O(+Le)){var Ue=+Le;if(Ue===T(Ue))return new E(Ue);throw'Invalid integer: '+Le}var _e='-'===Le[0];_e&&(Le=Le.slice(1));var Te=Le.split(/e/i);if(2<Te.length)throw new Error('Invalid integer: '+ke.join('e'));if(2===Te.length){var Ie=Te[1];if('+'===Ie[0]&&(Ie=Ie.slice(1)),Ie=+Ie,Ie!==T(Ie)||!O(Ie))throw new Error('Invalid integer: '+Ie+' is not a valid exponent.');var ke=Te[0],Fe=ke.indexOf('.');if(0<=Fe&&(Ie-=ke.length-Fe-1,ke=ke.slice(0,Fe)+ke.slice(Fe+1)),0>Ie)throw new Error('Cannot include negative exponent part for integers');ke+=Array(Ie+1).join('0'),Le=ke}var Be=/^([0-9][0-9]*)$/.test(Le);if(!Be)throw new Error('Invalid integer: '+Le);for(var Ge=[],Ve=Le.length,Ze=Se,ze=Ve-Ze;0<Ve;)Ge.push(+Le.slice(ze,Ve)),ze-=Ze,0>ze&&(ze=0),Ve-=Ze;return L(Ge),new h(Ge,_e)}function ve(Le){return O(Le)?new E(Le):be(Le.toString())}function we(Le){return'number'==typeof Le?ve(Le):'string'==typeof Le?be(Le):Le}var xe=1e7,Se=7,qe=9007199254740992,Ee=R(qe);h.prototype.add=function(Le){var _e=we(Le);if(this.sign!==_e.sign)return this.subtract(_e.negate());var Te=this.value,Ie=_e.value;return _e.isSmall?new h(Z(Te,_Mathabs(Ie)),this.sign):new h(G(Te,Ie),this.sign)},h.prototype.plus=h.prototype.add,E.prototype.add=function(Le){var Ue=we(Le),_e=this.value;if(0>_e!==Ue.sign)return this.subtract(Ue.negate());var Te=Ue.value;if(Ue.isSmall){if(O(_e+Te))return new E(_e+Te);Te=R(_Mathabs(Te))}return new h(Z(Te,_Mathabs(_e)),0>_e)},E.prototype.plus=E.prototype.add,h.prototype.subtract=function(Le){var Ue=we(Le);if(this.sign!==Ue.sign)return this.add(Ue.negate());var _e=this.value,Te=Ue.value;return Ue.isSmall?X(_e,_Mathabs(Te),this.sign):Q(_e,Te,this.sign)},h.prototype.minus=h.prototype.subtract,E.prototype.subtract=function(Le){var Ue=we(Le),_e=this.value;if(0>_e!==Ue.sign)return this.add(Ue.negate());var Te=Ue.value;return Ue.isSmall?new E(_e-Te):X(Te,_Mathabs(_e),0<=_e)},E.prototype.minus=E.prototype.subtract,h.prototype.negate=function(){return new h(this.value,!this.sign)},E.prototype.negate=function(){var Le=this.sign,Ue=new E(-this.value);return Ue.sign=!Le,Ue},h.prototype.abs=function(){return new h(this.value,!1)},E.prototype.abs=function(){return new E(_Mathabs(this.value))},h.prototype.multiply=function(Le){var Fe,_e=we(Le),Te=this.value,Ie=_e.value,ke=this.sign!==_e.sign;if(_e.isSmall){if(0===Ie)return Ne[0];if(1===Ie)return this;if(-1===Ie)return this.negate();if(Fe=_Mathabs(Ie),Fe<xe)return new h(W(Te,Fe),ke);Ie=R(Fe)}return $(Te.length,Ie.length)?new h(K(Te,Ie),ke):new h(Y(Te,Ie),ke)},h.prototype.times=h.prototype.multiply,E.prototype._multiplyBySmall=function(Le){return O(Le.value*this.value)?new E(Le.value*this.value):ee(_Mathabs(Le.value),R(_Mathabs(this.value)),this.sign!==Le.sign)},h.prototype._multiplyBySmall=function(Le){return 0===Le.value?Ne[0]:1===Le.value?this:-1===Le.value?this.negate():ee(_Mathabs(Le.value),this.value,this.sign!==Le.sign)},E.prototype.multiply=function(Le){return we(Le)._multiplyBySmall(this)},E.prototype.times=E.prototype.multiply,h.prototype.square=function(){return new h(te(this.value),!1)},E.prototype.square=function(){var Le=this.value*this.value;return O(Le)?new E(Le):new h(te(R(_Mathabs(this.value))),!1)},h.prototype.divmod=function(Le){var Ue=oe(this,Le);return{quotient:Ue[0],remainder:Ue[1]}},E.prototype.divmod=h.prototype.divmod,h.prototype.divide=function(Le){return oe(this,Le)[0]},E.prototype.over=E.prototype.divide=h.prototype.over=h.prototype.divide,h.prototype.mod=function(Le){return oe(this,Le)[1]},E.prototype.remainder=E.prototype.mod=h.prototype.remainder=h.prototype.mod,h.prototype.pow=function(Le){var Ie,ke,Fe,Ue=we(Le),_e=this.value,Te=Ue.value;if(0===Te)return Ne[1];if(0===_e)return Ne[0];if(1===_e)return Ne[1];if(-1===_e)return Ue.isEven()?Ne[1]:Ne[-1];if(Ue.sign)return Ne[0];if(!Ue.isSmall)throw new Error('The exponent '+Ue.toString()+' is too large.');if(this.isSmall&&O(Ie=_Mathpow(_e,Te)))return new E(T(Ie));for(ke=this,Fe=Ne[1];!0&Te&&(Fe=Fe.times(ke),--Te),0!==Te;)Te/=2,ke=ke.square();return Fe},E.prototype.pow=h.prototype.pow,h.prototype.modPow=function(Le,Ue){if(Le=we(Le),Ue=we(Ue),Ue.isZero())throw new Error('Cannot take modPow with modulus 0');for(var _e=Ne[1],Te=this.mod(Ue);Le.isPositive();){if(Te.isZero())return Ne[0];Le.isOdd()&&(_e=_e.multiply(Te).mod(Ue)),Le=Le.divide(2),Te=Te.square().mod(Ue)}return _e},E.prototype.modPow=h.prototype.modPow,h.prototype.compareAbs=function(Le){var Ue=we(Le),_e=this.value,Te=Ue.value;return Ue.isSmall?1:re(_e,Te)},E.prototype.compareAbs=function(Le){var Ue=we(Le),_e=_Mathabs(this.value),Te=Ue.value;return Ue.isSmall?(Te=_Mathabs(Te),_e===Te?0:_e>Te?1:-1):-1},h.prototype.compare=function(Le){if(Le===Infinity)return-1;if(Le===-Infinity)return 1;var Ue=we(Le),_e=this.value,Te=Ue.value;return this.sign===Ue.sign?Ue.isSmall?this.sign?-1:1:re(_e,Te)*(this.sign?-1:1):Ue.sign?1:-1},h.prototype.compareTo=h.prototype.compare,E.prototype.compare=function(Le){if(Le===Infinity)return-1;if(Le===-Infinity)return 1;var Ue=we(Le),_e=this.value,Te=Ue.value;return Ue.isSmall?_e==Te?0:_e>Te?1:-1:0>_e===Ue.sign?0>_e?1:-1:0>_e?-1:1},E.prototype.compareTo=E.prototype.compare,h.prototype.equals=function(Le){return 0===this.compare(Le)},E.prototype.eq=E.prototype.equals=h.prototype.eq=h.prototype.equals,h.prototype.notEquals=function(Le){return 0!==this.compare(Le)},E.prototype.neq=E.prototype.notEquals=h.prototype.neq=h.prototype.notEquals,h.prototype.greater=function(Le){return 0<this.compare(Le)},E.prototype.gt=E.prototype.greater=h.prototype.gt=h.prototype.greater,h.prototype.lesser=function(Le){return 0>this.compare(Le)},E.prototype.lt=E.prototype.lesser=h.prototype.lt=h.prototype.lesser,h.prototype.greaterOrEquals=function(Le){return 0<=this.compare(Le)},E.prototype.geq=E.prototype.greaterOrEquals=h.prototype.geq=h.prototype.greaterOrEquals,h.prototype.lesserOrEquals=function(Le){return 0>=this.compare(Le)},E.prototype.leq=E.prototype.lesserOrEquals=h.prototype.leq=h.prototype.lesserOrEquals,h.prototype.isEven=function(){return 0==(1&this.value[0])},E.prototype.isEven=function(){return 0==(1&this.value)},h.prototype.isOdd=function(){return 1==(1&this.value[0])},E.prototype.isOdd=function(){return 1==(1&this.value)},h.prototype.isPositive=function(){return!this.sign},E.prototype.isPositive=function(){return 0<this.value},h.prototype.isNegative=function(){return this.sign},E.prototype.isNegative=function(){return 0>this.value},h.prototype.isUnit=function(){return!1},E.prototype.isUnit=function(){return 1===_Mathabs(this.value)},h.prototype.isZero=function(){return!1},E.prototype.isZero=function(){return 0===this.value},h.prototype.isDivisibleBy=function(Le){var Ue=we(Le),_e=Ue.value;return 0!==_e&&(1===_e||(2===_e?this.isEven():this.mod(Ue).equals(Ne[0])))},E.prototype.isDivisibleBy=h.prototype.isDivisibleBy,h.prototype.isPrime=function(){var Le=ne(this);if(Le!==u)return Le;for(var ke,Fe,Be,Ge,Ue=this.abs(),_e=Ue.prev(),Te=[2,3,5,7,11,13,17,19],Ie=_e;Ie.isEven();)Ie=Ie.divide(2);for(Be=0;Be<Te.length;Be++)if(Ge=bigInt(Te[Be]).modPow(Ie,Ue),!(Ge.equals(Ne[1])||Ge.equals(_e))){for(Fe=!0,ke=Ie;Fe&&ke.lesser(_e);ke=ke.multiply(2))Ge=Ge.square().mod(Ue),Ge.equals(_e)&&(Fe=!1);if(Fe)return!1}return!0},E.prototype.isPrime=h.prototype.isPrime,h.prototype.isProbablePrime=function(Le){var Ue=ne(this);if(Ue!==u)return Ue;for(var ke,_e=this.abs(),Te=Le===u?5:Le,Ie=0;Ie<Te;Ie++)if(ke=bigInt.randBetween(2,_e.minus(2)),!ke.modPow(_e.prev(),_e).isUnit())return!1;return!0},E.prototype.isProbablePrime=h.prototype.isProbablePrime,h.prototype.next=function(){var Le=this.value;return this.sign?X(Le,1,this.sign):new h(Z(Le,1),this.sign)},E.prototype.next=function(){var Le=this.value;return Le+1<qe?new E(Le+1):new h(Ee,!1)},h.prototype.prev=function(){var Le=this.value;return this.sign?new h(Z(Le,1),!0):X(Le,1,this.sign)},E.prototype.prev=function(){var Le=this.value;return Le-1>-qe?new E(Le-1):new h(Ee,!0)};for(var Ce=[1];Ce[Ce.length-1]<=xe;)Ce.push(2*Ce[Ce.length-1]);var Oe=Ce.length,Ae=Ce[Oe-1];h.prototype.shiftLeft=function(Le){if(!ae(Le))throw new Error(Le+' is too large for shifting.');if(Le=+Le,0>Le)return this.shiftRight(-Le);for(var Ue=this;Le>=Oe;)Ue=Ue.multiply(Ae),Le-=Oe-1;return Ue.multiply(Ce[Le])},E.prototype.shiftLeft=h.prototype.shiftLeft,h.prototype.shiftRight=function(Le){var Ue;if(!ae(Le))throw new Error(Le+' is too large for shifting.');if(Le=+Le,0>Le)return this.shiftLeft(-Le);for(var _e=this;Le>=Oe;){if(_e.isZero())return _e;Ue=oe(_e,Ae),_e=Ue[1].isNegative()?Ue[0].prev():Ue[0],Le-=Oe-1}return Ue=oe(_e,Ce[Le]),Ue[1].isNegative()?Ue[0].prev():Ue[0]},E.prototype.shiftRight=h.prototype.shiftRight,h.prototype.not=function(){return this.negate().prev()},E.prototype.not=h.prototype.not,h.prototype.and=function(Le){return pe(this,Le,function(Ue,_e){return Ue&_e})},E.prototype.and=h.prototype.and,h.prototype.or=function(Le){return pe(this,Le,function(Ue,_e){return Ue|_e})},E.prototype.or=h.prototype.or,h.prototype.xor=function(Le){return pe(this,Le,function(Ue,_e){return Ue^_e})},E.prototype.xor=h.prototype.xor;var je=1073741824,Re=(xe&-xe)*(xe&-xe)|je,Me=function(Le,Ue){var _e=Ne[0],Te=Ne[1],Ie=Le.length;if(2<=Ue&&36>=Ue&&Ie<=36.7368005696771/_Mathlog(Ue))return new E(parseInt(Le,Ue));Ue=we(Ue);var Fe,ke=[],Be='-'===Le[0];for(Fe=Be?1:0;Fe<Le.length;Fe++){var Ge=Le[Fe].toLowerCase(),Ve=Ge.charCodeAt(0);if(48<=Ve&&57>=Ve)ke.push(we(Ge));else if(97<=Ve&&122>=Ve)ke.push(we(Ge.charCodeAt(0)-87));else if('<'===Ge){var Ze=Fe;do Fe++;while('>'!==Le[Fe]);ke.push(we(Le.slice(Ze+1,Fe)))}else throw new Error(Ge+' is not a valid character')}for(ke.reverse(),Fe=0;Fe<ke.length;Fe++)_e=_e.add(ke[Fe].times(Te)),Te=Te.times(Ue);return Be?_e.negate():_e};h.prototype.toString=function(Le){if(Le===u&&(Le=10),10!==Le)return fe(this,Le);for(var ke,Ue=this.value,_e=Ue.length,Te=Ue[--_e]+'';0<=--_e;)ke=Ue[_e]+'',Te+='0000000'.slice(ke.length)+ke;var Fe=this.sign?'-':'';return Fe+Te},E.prototype.toString=function(Le){return Le===u&&(Le=10),10==Le?this.value+'':fe(this,Le)},h.prototype.valueOf=function(){return+this.toString()},h.prototype.toJSNumber=h.prototype.valueOf,E.prototype.valueOf=function(){return this.value},E.prototype.toJSNumber=E.prototype.valueOf;for(var Ne=function(Le,Ue){return'undefined'==typeof Le?Ne[0]:'undefined'==typeof Ue?we(Le):10==+Ue?we(Le):Me(Le,Ue)},De=0;1e3>De;De++)Ne[De]=new E(De),0<De&&(Ne[-De]=new E(-De));return Ne.one=Ne[1],Ne.zero=Ne[0],Ne.minusOne=Ne[-1],Ne.max=me,Ne.min=ce,Ne.gcd=ge,Ne.lcm=function(Le,Ue){return Le=we(Le).abs(),Ue=we(Ue).abs(),Le.divide(ge(Le,Ue)).multiply(Ue)},Ne.isInstance=function(Le){return Le instanceof h||Le instanceof E},Ne.randBetween=function(Le,Ue){Le=we(Le),Ue=we(Ue);var _e=ce(Le,Ue),Te=me(Le,Ue),Ie=Te.subtract(_e);if(Ie.isSmall)return _e.add(_Mathround(Math.random()*Ie));for(var ke=Ie.value.length-1,Fe=[],Be=!0,Ge=ke;0<=Ge;Ge--){var Ve=Be?Ie.value[Ge]:xe,Ze=T(Math.random()*Ve);Fe.unshift(Ze),Ze<Ve&&(Be=!1)}return Fe=D(Fe),_e.add('number'==typeof Fe?new E(Fe):new h(Fe,!1))},Ne}()});'undefined'!=typeof module&&(module.exports=nerdamer);var _Mathlog=Math.log,_NumberMAX_VALUE=Number.MAX_VALUE,_NumberMIN_VALUE=Number.MIN_VALUE,_Mathsqrt=Math.sqrt,_Mathmax=Math.max,_Mathfloor=Math.floor,_Mathabs=Math.abs,_Mathpow=Math.pow;'undefined'!=typeof module&&(nerdamer=require('./nerdamer.core.js'),require('./Calculus.js')),function(){'use strict';function U($,se,te){if(M.Utils.isSymbol($))this.parse($);else if(!isNaN($)){if(te=te||0,void 0===se)throw new Error('Polynomial expects a variable name when creating using order');this.coeffs=[],this.coeffs[te]=$,this.fill($)}else'string'==typeof $&&this.parse(A.parse($))}function F(){this.factors={}}function C($,se,te){this.terms=se||[],this.coeff=$,this.map=te,this.sum=new M.Frac(0),this.image=void 0}var M=nerdamer.getCore(),A=M.PARSER,D=M.groups.N,E=M.groups.P,L=M.groups.S,R=M.groups.EX,Z=M.groups.FN,V=M.groups.PL,I=M.groups.CP,B=M.groups.CB,G=M.Utils.keys,Q=M.Utils.variables,H=M.Utils.round,O=M.Frac,X=M.Utils.isInt,W=M.Symbol,Y=M.Settings.CONST_HASH;U.fromArray=function($,se){if('undefined'==typeof se)throw new Error('A variable name must be specified when creating polynomial from array');var te=new U;return te.coeffs=$,te.variable=se,te},U.fit=function($,se,te,re,ae,oe){var ie=Array(ae+1),le=te-se;ie[0]=se,ie[ae]=$,le-=$*_Mathpow(re,ae);for(var ue=ae-1;0<ue;ue--){var ne=_Mathpow(re,ue),fe=le/ne,ce=Math.sign(fe),pe=ce*_Mathfloor(_Mathabs(fe));le-=pe*ne,ie[ue]=pe}if(0!=le)return null;for(var ue=0;ue<ie.length;ue++)ie[ue]=new O(ie[ue]);return U.fromArray(ie,oe)},U.prototype={parse:function($,se){if(this.variable=Q($)[0],!$.isPoly())throw new Error('Polynomial Expected! Received '+M.Utils.text($));if(se=se||[],$.power.absEquals(1)||($=A.expand($)),$.group===M.groups.N)se[0]=$.multiplier;else if($.group===M.groups.S)se[$.power.toDecimal()]=$.multiplier;else for(var te in $.symbols){var re=$.symbols[te],ae=re.power;if(M.Utils.isSymbol(ae))throw new Error('power cannot be a Symbol');ae=re.group===D?0:ae.toDecimal(),re.symbols?this.parse(re,se):se[ae]=re.multiplier}this.coeffs=se,this.fill()},fill:function($){$=+$||0;for(var se=this.coeffs.length,te=0;te<se;te++)void 0===this.coeffs[te]&&(this.coeffs[te]=new O($));return this},trim:function(){for(var $=this.coeffs.length;$--;){var se=this.coeffs[$],te=se.equals(0);if(se&&te){if(0===$)break;this.coeffs.pop()}else break}return this},modP:function($){for(var re,se=this.coeffs.length,te=0;te<se;te++){if(re=this.coeffs[te],0>re){for(var ae,oe=te;oe<se;oe++)if(0<this.coeffs[oe]){ae=this.coeffs[oe];break}if(ae){for(oe;oe>te;oe--)this.coeffs[oe]=this.coeffs[oe].subtract(new O(1)),this.coeffs[oe-1]=this.coeffs[oe-1].add(new O($));re=this.coeffs[te]}}var ie=re.mod($),le=re.subtract(ie).divide($);if(!le.equals(0)){var ue=te+1,ne=this.coeffs[ue]||new O(0);ne=ne.add(le),this.coeffs[ue]=new O(ne),this.coeffs[te]=new O(ie)}}return this},add:function($){for(var se=_Mathmax(this.coeffs.length,$.coeffs.length),te=0;te<se;te++){var re=this.coeffs[te]||new O(0),ae=$.coeffs[te]||new O(0);this.coeffs[te]=re.add(ae)}return this},subtract:function($){for(var se=_Mathmax(this.coeffs.length,$.coeffs.length),te=0;te<se;te++){var re=this.coeffs[te]||new O(0),ae=$.coeffs[te]||new O(0);this.coeffs[te]=re.subtract(ae)}return this},divide:function($){for(var se=this.variable,te=M.Utils.arrayClone(this.coeffs),re=M.Utils.arrayClone($.coeffs),ae=te.length,oe=re.length-1,ie=[],le=0;le<ae;le++){var ue=ae-(le+1),ne=ue-oe,fe=te[ue].divide(re[oe]);if(0>ne)break;ie[ne]=fe;for(var ce=0;ce<=oe;ce++)te[ce+ne]=te[ce+ne].subtract(re[ce].multiply(fe))}var pe=U.fromArray(te,se||'x').trim(),me=U.fromArray(ie,se||'x');return[me,pe]},multiply:function($){for(var oe,se=this.coeffs.length,te=$.coeffs.length,re=[],ae=0;ae<se;ae++){oe=this.coeffs[ae];for(var ie=0;ie<te;ie++){var le=ae+ie,ue=$.coeffs[ie],ne=re[le]||new O(0);re[le]=ne.add(oe.multiply(ue))}}return this.coeffs=re,this},isZero:function(){for(var te,$=this.coeffs.length,se=0;se<$;se++)if(te=this.coeffs[se],!te.equals(0))return!1;return!0},sub:function($){for(var ae,se=new O(0),te=this.coeffs.length,re=0;re<te;re++)ae=this.coeffs[re],ae.equals(0)||(se=se.add(ae.multiply(new O(_Mathpow($,re)))));return se},clone:function(){var $=new U;return $.coeffs=this.coeffs,$.variable=this.variable,$},deg:function(){return this.trim(),this.coeffs.length-1},lc:function(){return this.coeffs[this.deg()].clone()},monic:function(){for(var $=this.lc(),se=this.coeffs.length,te=0;te<se;te++)this.coeffs[te]=this.coeffs[te].divide($);return this},gcd:function($){var re,se=this.coeffs.length-1,te=$.coeffs.length-1;if(se<te)return $.gcd(this);for(var oe,ae=this;!$.isZero();)oe=$.clone(),ae=ae.clone(),re=ae.divide(oe),$=re[1],ae=oe;var ie=M.Math2.QGCD.apply(null,ae.coeffs);if(!ie.equals(1))for(var le=ae.coeffs.length,ue=0;ue<le;ue++)ae.coeffs[ue]=ae.coeffs[ue].divide(ie);return ae},diff:function(){for(var $=[],se=this.coeffs.length,te=1;te<se;te++)$.push(this.coeffs[te].multiply(new O(te)));return this.coeffs=$,this},integrate:function(){for(var re,$=[0],se=this.coeffs.length,te=0;te<se;te++)re=new O(te+1),$[re]=this.coeffs[te].divide(re);return this.coeffs=$,this},gcf:function($){for(var ae,se=function(le){for(var ue=0;ue<le.length;ue++)if(!le[ue].equals(0))return ue},te=[],re=0;re<this.coeffs.length;re++)ae=this.coeffs[re],ae.equals(0)||-1!==te.indexOf(ae)||te.push(ae);var oe=[M.Math2.QGCD.apply(void 0,te),se(this.coeffs)].toDecimal();if($){var ie=[];ie[oe[1]-1]=oe[0],oe=U.fromArray(ie,this.variable).fill()}return oe},quad:function($){var se=[];if(3<this.coeffs.length)throw new Error('Cannot calculate quadratic order of '+(this.coeffs.length-1));if(0===this.coeffs.length)throw new Error('Polynomial array has no terms');var te=this.coeffs[2]||0,re=this.coeffs[1]||0,ae=this.coeffs[0],oe=re*re-4*te*ae;return 0>oe&&!$?se:(se[0]=(-re+_Mathsqrt(oe))/(2*te),se[1]=(-re-_Mathsqrt(oe))/(2*te),se)},squareFree:function(){for(var $=this.clone(),se=1,te=$.clone().diff(),re=$.clone().gcd(te),ae=$.divide(re)[0],oe=U.fromArray([new O(1)],$.variable);!re.equalsNumber(1);){var ie=ae.gcd(re),le=ae.divide(ie)[0];if(!le.equalsNumber(1)&&1<se){for(var ue=le.clone(),ne=1;ne<se;ne++)ue.multiply(le.clone());le=ue}oe=oe.multiply(le),se++,ae=ie,re=re.divide(ie)[0]}return[oe,ae,se]},toSymbol:function(){var $=this.coeffs.length,se=this.variable;if(0===$)return new M.Symbol(0);for(var re='',ae=0;ae<$;ae++){var oe=ae===$-1?'':'+',ie=this.coeffs[ae];ie.equals(0)||(re+=ie+'*'+se+'^'+ae+oe)}return A.parse(re)},equalsNumber:function($){return this.trim(),1===this.coeffs.length&&this.coeffs[0].toDecimal()===$},toString:function(){return this.toSymbol().toString()}},W.prototype.coeffs=function($,se){se&&!this.isPoly(!0)&&A.error('Polynomial expected when requesting coefficients with order'),$=$||[];var te=this.clone().distributeMultiplier();if(te.isComposite())for(var re in te.symbols){var ae=te.symbols[re];ae.isComposite()?ae.clone().distributeMultiplier().coeffs($,se):se?$[ae.isConstant()?0:ae.power.toDecimal()]=ae.multiplier:$.push(ae.multiplier)}else se?$[te.isConstant()?0:te.power.toDecimal()]=te.multiplier:$.push(te.multiplier);if(se)for(var oe=0;oe<$.length;oe++)void 0===$[oe]&&($[oe]=new O(0));return $},W.prototype.tBase=function($){if('undefined'==typeof $)throw new Error('Symbol.tBase requires a map object!');for(var se=[],te=this.collectSymbols(null,null,null,!0),re=te.length,ae=0;ae<re;ae++){var oe=te[ae],ie=oe.group,le=new C(oe.multiplier,[],$);if(ie===B)for(var ue in oe.symbols){var ne=oe.symbols[ue];le.terms[$[ue]]=ne.power}else le.terms[$[oe.value]]=oe.power;se.push(le.fill()),le.updateCount()}return se},W.prototype.altVar=function($){var se=this.multiplier.toString(),te=this.power.toString();return('1'===se?'':se+'*')+$+('1'===te?'':'^'+te)},W.prototype.sameVars=function($){if(!(this.symbols||this.group===$.group))return!1;for(var se in this.symbols){var te=this.symbols[se],re=$.symbols[se];if(!re)return!1;if(te.value!==re.value)return!1}return!0};F.prototype.add=function($){if($.equals(0))return this;if($.group===B){var se=this;$.each(function(ae){se.add(ae)})}else{this.preAdd&&($=this.preAdd($)),this.pFactor&&($=A.pow($,new W(this.pFactor)));var te=$.isConstant();if(te&&$.equals(1))return this;var re=te?$.value:$.text();this.factors[re]=re in this.factors?A.multiply(this.factors[re],$):$}return this},F.prototype.toSymbol=function(){var $=new W(1);for(var se in this.factors){var te=this.factors[se].power.equals(1)?A.symfunction(M.PARENTHESIS,[this.factors[se]]):this.factors[se];$=A.multiply($,te)}return $},F.prototype.merge=function($){for(var se in $)this.factors[se]=se in this.factors?A.multiply(this.factors[se],$[se]):$[se];return this},F.prototype.each=function($){for(var se in this.factors){var te=this.factors[se];te.fname===M.PARENTHESIS&&te.isLinear()&&(te=te.args[0]),$.call(this,te,se)}return this},F.prototype.count=function(){return G(this.factors).length},F.prototype.toString=function(){return this.toSymbol().toString()};C.prototype.updateCount=function(){this.count=this.count||0;for(var $=0;$<this.terms.length;$++)this.terms[$].equals(0)||this.count++;return this},C.prototype.getVars=function(){for(var $=[],se=0;se<this.terms.length;se++){var te=this.terms[se],re=this.getRevMap();te.equals(0)||$.push(this.rev_map[se])}return $.join(' ')},C.prototype.len=function(){return'undefined'==typeof this.count&&this.updateCount(),this.count},C.prototype.toSymbol=function($){$=$||this.getRevMap();for(var se=new W(this.coeff),te=0;te<this.terms.length;te++){var re=$[te],ae=this.terms[te];if(!(ae.equals(0)||re===Y)){var oe=new W(re);oe.power=ae,se=A.multiply(se,oe)}}return se},C.prototype.getRevMap=function(){if(this.rev_map)return this.rev_map;var $={};for(var se in this.map)$[this.map[se]]=se;return this.rev_map=$,$},C.prototype.generateImage=function(){return this.image=this.terms.join(' '),this},C.prototype.getImg=function(){return this.image||this.generateImage(),this.image},C.prototype.fill=function(){for(var $=this.map.length,se=0;se<$;se++)'undefined'==typeof this.terms[se]?this.terms[se]=new M.Frac(0):this.sum=this.sum.add(this.terms[se]);return this},C.prototype.divide=function($){for(var se=this.coeff.divide($.coeff),te=this.terms.length,re=new C(se,[],this.map),ae=0;ae<te;ae++)re.terms[ae]=this.terms[ae].subtract($.terms[ae]),re.sum=re.sum.add(re.terms[ae]);return re},C.prototype.multiply=function($){for(var se=this.coeff.multiply($.coeff),te=this.terms.length,re=new C(se,[],this.map),ae=0;ae<te;ae++)re.terms[ae]=this.terms[ae].add($.terms[ae]),re.sum=re.sum.add(re.terms[ae]);return re},C.prototype.isZero=function(){return this.coeff.equals(0)},C.prototype.toString=function(){return'{ coeff: '+this.coeff.toString()+', terms: ['+this.terms.join(',')+']: sum: '+this.sum.toString()+', count: '+this.count+'}'},M.Utils.toMapObj=function($){for(var ae,se=0,te={},re=0;re<$.length;re++)ae=$[re],'undefined'==typeof te[ae]&&(te[ae]=se,se++);return te.length=se,te},M.Utils.filledArray=function($,se,te){for(var re=[];se--;)re[se]=te?new te($):$;return re},M.Utils.arrSum=function($){for(var se=0,te=$.length,re=0;re<te;re++)se+=$[re];return se},M.Utils.subFunctions=function($,se){se=se||{};var te=[];return($.each(function(re){if(re.group===Z||re.previousGroup===Z){var ae=M.Utils.text(re,'hash'),oe=se[ae];if(!oe){var ie=re.fname+G(se).length;se[ae]=ie,te.push(re.altVar(ie))}else te.push(re.altVar(oe))}else re.group===B||re.group===V||re.group===I?te.push(M.Utils.subFunctions(re,se)):te.push(re.text())}),$.group===I||$.group===V)?$.altVar(M.Utils.inBrackets(te.join('+'))):$.group===B?$.altVar(M.Utils.inBrackets(te.join('*'))):$.text()},M.Utils.getFunctionsSubs=function($){var se={};for(var te in $)se[$[te]]=A.parse(te);return se};var J=M.Algebra={version:'1.4.0',init:function(){}(),proots:function($,se){function te(qe,Se,Ue){function xe(Be,ke,Ge,Qe,He,Oe){He[0]=Oe.b=Qe[0],He[1]=Oe.a=-(ke*Oe.b)+Qe[1];for(var Xe=2;Xe<Be;Xe++)He[Xe]=-(ke*Oe.a+Ge*Oe.b)+Qe[Xe],Oe.b=Oe.a,Oe.a=He[Xe]}function Fe(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye){var Je={},$e=3;return(Je.b=Je.a=0,xe(ke,Xe,We,Oe,Ye,Je),He.c=Je.a,He.d=Je.b,_Mathabs(He.c)<=100*Be*_Mathabs(Oe[ke-1])&&_Mathabs(He.d)<=100*Be*_Mathabs(Oe[ke-2]))?$e:(He.h=We*Qe,_Mathabs(He.d)>=_Mathabs(He.c)?($e=2,He.e=Ge/He.d,He.f=He.c/He.d,He.g=Xe*Qe,He.a3=He.e*(He.g+Ge)+He.h*(Qe/He.d),He.a1=-Ge+He.f*Qe,He.a7=He.h+(He.f+Xe)*Ge):($e=1,He.e=Ge/He.c,He.f=He.d/He.c,He.g=He.e*Xe,He.a3=He.e*Ge+(He.g+He.h/He.c)*Qe,He.a1=-(Ge*(He.d/He.c))+Qe,He.a7=He.g*He.d+He.h*He.f+Ge),$e)}function Ne(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye){var Je;if(3==Ge){Xe[1]=Xe[0]=0;for(var $e=2;$e<ke;$e++)Xe[$e]=We[$e-2];return}if(Je=1==Ge?He:Qe,_Mathabs(Oe.a1)>10*Be*_Mathabs(Je)){Oe.a7/=Oe.a1,Oe.a3/=Oe.a1,Xe[0]=Ye[0],Xe[1]=-(Ye[0]*Oe.a7)+Ye[1];for(var $e=2;$e<ke;$e++)Xe[$e]=-(Ye[$e-1]*Oe.a7)+We[$e-2]*Oe.a3+Ye[$e]}else{Xe[0]=0,Xe[1]=-(Ye[0]*Oe.a7);for(var $e=2;$e<ke;$e++)Xe[$e]=-(Ye[$e-1]*Oe.a7)+We[$e-2]*Oe.a3}}function we(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye,Je,$e,Ke,es,rs,as,os,is){var ls,us,ns,fs,cs,ps,ds,gs,bs;return ke.b=ke.a=0,void(3!=Be&&(2==Be?(ls=(Ge+$e)*Je+Ke,us=(Je+es)*We+rs*Ye):(ls=Ge+es*Xe+Ke*Je,us=We+(es+rs*Je)*Ye),ns=-(as[os-1]/is[os]),fs=-(as[os-2]+ns*is[os-1])/is[os],cs=rs*fs*Qe,ps=ns*Oe,ds=ns*ns*He,gs=-(ps+ds)+cs,bs=-gs+us+ns*ls,0!=bs&&(ke.a=-((es*(ds+ps)+rs*(ns*Qe+fs*Oe))/bs)+es,ke.b=rs*(1+gs/bs))))}function Ce(Be,ke,Ge,Qe){var He,Oe,Xe;return(Qe.sr=Qe.si=Qe.lr=Qe.li=0,0==Be)?void(Qe.sr=0==ke?Qe.sr:-(Ge/ke)):0==Ge?void(Qe.lr=-(ke/Be)):(He=ke/2,_Mathabs(He)<_Mathabs(Ge)?(Xe=0<=Ge?Be:-Be,Xe=-Xe+He*(He/_Mathabs(Ge)),Oe=_Mathsqrt(_Mathabs(Xe))*_Mathsqrt(_Mathabs(Ge))):(Xe=-(Be/He*(Ge/He))+1,Oe=_Mathsqrt(_Mathabs(Xe))*_Mathabs(He)),void(0<=Xe?(Oe=0<=He?-Oe:Oe,Qe.lr=(-He+Oe)/Be,Qe.sr=0==Qe.lr?Qe.sr:Ge/Qe.lr/Be):(Qe.lr=Qe.sr=-(He/Be),Qe.si=_Mathabs(Oe/Be),Qe.li=-Qe.si)))}function Me(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye,Je,$e,Ke){var rs,as,os,is,ls,us,ns,fs,cs,ps,ds,bs,es={},gs=0,hs=0;Ge.NZ=0,us=Qe,fs=He;do{if(es.li=es.lr=es.si=es.sr=0,Ce(1,us,fs,es),Ge.szr=es.sr,Ge.szi=es.si,Ge.lzr=es.lr,Ge.lzi=es.li,_Mathabs(_Mathabs(Ge.szr)-_Mathabs(Ge.lzr))>0.01*_Mathabs(Ge.lzr))break;for(xe(Xe,us,fs,Ye,Oe,We),as=_Mathabs(-(Ge.szr*We.b)+We.a)+_Mathabs(Ge.szi*We.b),ps=_Mathsqrt(_Mathabs(fs)),rs=2*_Mathabs(Oe[0]),ls=-(Ge.szr*We.b),ds=1;ds<ke;ds++)rs=rs*ps+_Mathabs(Oe[ds]);if(rs=rs*ps+_Mathabs(ls+We.a),rs=(9*rs+2*_Mathabs(ls)-7*(_Mathabs(We.a+ls)+ps*_Mathabs(We.b)))*Be,as<=20*rs){Ge.NZ=2;break}if(gs++,20<gs)break;if(2<=gs&&0.01>=is&&as>=os&&!hs){for(is=is<Be?_Mathsqrt(Be):_Mathsqrt(is),us-=us*is,fs+=fs*is,xe(Xe,us,fs,Ye,Oe,We),ds=0;5>ds;ds++)bs=Fe(Be,ke,We.a,We.b,$e,Ke,us,fs,Je),Ne(Be,ke,bs,We.a,We.b,$e,Ke,Je,Oe);hs=1,gs=0}os=as,bs=Fe(Be,ke,We.a,We.b,$e,Ke,us,fs,Je),Ne(Be,ke,bs,We.a,We.b,$e,Ke,Je,Oe),bs=Fe(Be,ke,We.a,We.b,$e,Ke,us,fs,Je),we(bs,We,We.a,$e.a1,$e.a3,$e.a7,We.b,$e.c,$e.d,$e.f,$e.g,$e.h,us,fs,Ke,ke,Ye),ns=We.a,cs=We.b,0!=cs&&(is=_Mathabs((-fs+cs)/cs),us=ns,fs=cs)}while(0!=cs)}function je(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye){var Je,$e,Ke,es,rs,as,os,is,ls,us,ns,fs=Qe-1;for(ke.NZ=ns=ls=0,os=Ge.a;;){for(as=He[0],Xe[0]=as,us=1;us<Oe;us++)Xe[us]=as=as*os+He[us];for(Ke=_Mathabs(as),es=_Mathabs(os),Je=0.5*_Mathabs(Xe[0]),us=1;us<Oe;us++)Je=Je*es+_Mathabs(Xe[us]);if(Ke<=20*Be*(2*Je-Ke)){ke.NZ=1,ke.szr=os,ke.szi=0;break}if(ns++,10<ns)break;if(2<=ns&&_Mathabs(is)<=1e-3*_Mathabs(-is+os)&&Ke>rs){ls=1,ke.a=os;break}for(rs=Ke,Ye[0]=$e=We[0],us=1;us<Qe;us++)Ye[us]=$e=$e*os+We[us];if(_Mathabs($e)>10*_Mathabs(We[fs])*Be)for(is=-(as/$e),We[0]=Xe[0],us=1;us<Qe;us++)We[us]=is*Ye[us-1]+Xe[us];else for(We[0]=0,us=1;us<Qe;us++)We[us]=Ye[us-1];for($e=We[0],us=1;us<Qe;us++)$e=$e*os+We[us];is=_Mathabs($e)>10*_Mathabs(We[fs])*Be?-(as/$e):0,os+=is}return ls}function Ae(Be,ke,Ge,Qe,He,Oe,Xe,We,Ye,Je,$e,Ke){var is,ls,us,ns,fs,cs,ps,ds,gs,bs,hs,ys,vs,qs,Ss,Us,xs,Fs,Ns,Cs,Ms,js,As,Ds,Ps,es={},rs={},as=Array(ke),os=Array(ke),ws=1;for(Ke.NZ=0,ns=us=0.25,fs=Qe,ds=He,es.b=es.a=0,xe(Ye,$e,He,We,Je,es),is=es.a,ls=es.b,rs.h=rs.g=rs.f=rs.e=rs.d=rs.c=rs.a7=rs.a3=rs.a1=0,As=Fe(Be,Xe,is,ls,rs,Oe,$e,He,as),Cs=0;Cs<Ge;Cs++){if(Fs=1,Ne(Be,Xe,As,is,ls,rs,Oe,as,Je),As=Fe(Be,Xe,is,ls,rs,Oe,$e,He,as),we(As,es,is,rs.a1,rs.a3,rs.a7,ls,rs.c,rs.d,rs.f,rs.g,rs.h,$e,He,Oe,Xe,We),Ss=es.a,xs=Us=es.b,bs=0==Oe[Xe-1]?0:-(We[Xe]/Oe[Xe-1]),hs=vs=1,0!=Cs&&3!=As&&(vs=0==xs?vs:_Mathabs((xs-ds)/xs),hs=0==bs?hs:_Mathabs((bs-fs)/bs),qs=vs<ps?vs*ps:1,ys=hs<cs?hs*cs:1,Ds=qs<ns?1:0,Ms=ys<us?1:0,Ms||Ds)){for(Ns=0;Ns<Xe;Ns++)os[Ns]=Oe[Ns];for(gs=bs,js=Ps=0;;){if(Fs&&0==(Fs=0)&&Ms&&(!Ds||ys<qs));else{if(Me(Be,Xe,Ke,Ss,Us,Je,Ye,es,We,as,rs,Oe),is=es.a,ls=es.b,0<Ke.NZ)return;if(ws=Ps=1,ns*=0.25,js||!Ms)ws=0;else for(Ns=0;Ns<Xe;Ns++)Oe[Ns]=os[Ns]}if(0!=ws){if(es.a=gs,ws=je(Be,Ke,es,Xe,We,Ye,Je,Oe,as),gs=es.a,0<Ke.NZ)return;if(js=1,us*=0.25,0!=ws){Ss=-(gs+gs),Us=gs*gs;continue}}for(Ns=0;Ns<Xe;Ns++)Oe[Ns]=os[Ns];if(!Ds||Ps)break}xe(Ye,$e,He,We,Je,es),is=es.a,ls=es.b,As=Fe(Be,Xe,is,ls,rs,Oe,$e,He,as)}ds=xs,fs=bs,ps=vs,cs=hs}}var Pe=100,Ee=qe.slice(0);if(qe.unshift(Ue),Ue>Pe)throw new Error('This utility accepts polynomials of degree up to '+Pe+'. ');var ze=[],Le={};for(Le.Degree=Ue,pe=0;pe<Ue;pe++)ze.push(0);var Re=ze.slice(0);(function(Be,ke,Ge,Qe){var as,os,is,ls,us,ns,fs,cs,ps,ds,gs,bs,hs,ys,vs,qs,Ss,Us,xs,Fs,Ns,ws,Cs,Ms,He=Be.Degree,Xe=Math.LN2,We=Be.Degree+1,Ye=Array(We),Je=Array(We),$e=Array(We),Ke=Array(We),es={},rs={};bs=1;do os=bs,bs/=2,hs=1+bs;while(1<hs);var js=_NumberMIN_VALUE/os,As=-0.06975647374412533,Ds=0.9975640502598242,Ps=0.7071067811865476,Es=-Ps;for(rs.NZ=xs=0,rs.szr=rs.szi=rs.lzr=rs.lzi=0;0==ke[He];)Ge[xs]=Qe[xs]=0,He--,xs++;for(Cs=He+1;1<=He;){if(2>=He){2>He?(Ge[Be.Degree-1]=-(ke[1]/ke[0]),Qe[Be.Degree-1]=0):(es.li=es.lr=es.si=es.sr=0,Ce(ke[0],ke[1],ke[2],es),Ge[Be.Degree-2]=es.sr,Qe[Be.Degree-2]=es.si,Ge[Be.Degree-1]=es.lr,Qe[Be.Degree-1]=es.li);break}for(fs=0,cs=_NumberMAX_VALUE,zs=0;zs<Cs;zs++)ds=_Mathabs(ke[zs]),ds>fs&&(fs=ds),0!=ds&&ds<cs&&(cs=ds);if(ps=js/cs,(1>=ps&&10<=fs||1<ps&&_NumberMAX_VALUE/ps>=fs)&&(ps=0==ps?_NumberMIN_VALUE:ps,Ns=_Mathfloor(_Mathlog(ps)/Xe+0.5),us=_Mathpow(2,Ns),1!=us))for(zs=0;zs<Cs;zs++)ke[zs]*=us;for(var zs=0;zs<Cs;zs++)Je[zs]=_Mathabs(ke[zs]);Je[He]=-Je[He],ws=He-1,ds=Math.exp((_Mathlog(-Je[He])-_Mathlog(Je[0]))/He),0!=Je[ws]&&(gs=-Je[He]/Je[ws],ds=gs<ds?gs:ds),gs=ds;do{ds=gs,gs=0.1*ds,ns=Je[0];for(var zs=1;zs<Cs;zs++)ns=ns*gs+Je[zs]}while(0<ns);ls=ds;do{is=ns=Je[0];for(var zs=1;zs<He;zs++)ns=ds*ns+Je[zs],is=ds*is+ns;ns=ds*ns+Je[He],ls=ns/is,ds-=ls}while(5e-3<_Mathabs(ls/ds));as=ds;for(var zs=1;zs<He;zs++)Ye[zs]=(He-zs)*ke[zs]/He;for(Ye[0]=ke[0],bs=ke[He],hs=ke[ws],Ms=0==Ye[ws]?1:0,Fs=0;5>Fs;Fs++)if(ys=Ye[ws],Ms){for(var zs=0;zs<ws;zs++)xs=ws-zs,Ye[xs]=Ye[xs-1];Ye[0]=0,Ms=0==Ye[ws]?1:0}else{qs=-bs/ys;for(var zs=0;zs<ws;zs++)xs=ws-zs,Ye[xs]=qs*Ye[xs-1]+ke[xs];Ye[0]=ke[0],Ms=_Mathabs(Ye[ws])<=10*(_Mathabs(hs)*os)?1:0}for(var zs=0;zs<He;zs++)Ke[zs]=Ye[zs];for(Fs=1;20>=Fs;Fs++)if(Us=-(Ds*Es)+As*Ps,Es=Ds*Ps+As*Es,Ps=Us,vs=as*Ps,Ss=-(2*vs),Ae(os,We,20*Fs,vs,as,Ye,He,ke,Cs,$e,Ss,rs),0!=rs.NZ){xs=Be.Degree-He,Ge[xs]=rs.szr,Qe[xs]=rs.szi,Cs-=rs.NZ,He=Cs-1;for(var zs=0;zs<Cs;zs++)ke[zs]=$e[zs];1!=rs.NZ&&(Ge[xs+1]=rs.lzr,Qe[xs+1]=rs.lzi);break}else for(var zs=0;zs<He;zs++)Ye[zs]=Ke[zs];if(20<Fs){Be.Degree-=He;break}}})(Le,Ee,Re,ze);var _e=ze.length;for(pe=0;pe<_e;pe++){var Ze=H(ze[pe],se+8),Ve=H(Re[pe],se);Ve=2<se-(Ve+'').length?Ve:Re[pe];var Te=0>Ze?'-':'';0===Ve&&(Ve=''),0===Ze&&(Ze=''),Ze=1===_Mathabs(Ze)?Te+'i':Ze?Ze+'*i':'';var Ie=Ve&&Ze?Ve+'+'+Ze:Ve+Ze;Re[pe]=Ie.replace(/\+\-/g,'-')}return Re}se=se||7;var ae=function(qe,Se,Ue){for(var xe=te(qe,Se,Ue),Fe=0;Fe<0;Fe++)xe.unshift(0);return xe};if($ instanceof W&&$.isPoly()){if($.group===M.groups.S)return[0];if($.group===M.groups.PL)var oe=G($.symbols),ie=M.Utils.arrayMin(oe),$=M.PARSER.divide($,M.PARSER.parse($.value+'^'+ie));for(var me,le=G($.symbols).sort().pop(),ue=$.group===M.groups.PL?$.symbols:$.symbols[le],ne=ue.group,oe=ne===L?[ue.power.toDecimal()]:G(ue.symbols),fe=[],ce=M.Utils.arrayMax(oe),pe=1;pe<=ce;pe++)me=0,-1!==oe.indexOf(pe+'')&&(ne===L?me=ue.multiplier:me=ue.symbols[pe].multiplier),fe.unshift(me);return fe.push($.symbols['#'].multiplier),ue.group===L&&(fe[0]=ue.multiplier),ae(fe,oe,ce)}if(M.Utils.isArray($)){for(var de=$,fe=[],oe=[],ge=0,pe=0;pe<de.length;pe++){for(var be=de[pe][0],he=de[pe][1],ye=he-ge-1,ve=0;ve<ye;ve++)fe.unshift(0);fe.unshift(be),0!==he&&oe.push(he),ge=he}var ce=_Mathmax.apply(void 0,oe);return ae(fe,oe,ce)}throw new Error('Cannot calculate roots. Symbol must be a polynomial!')},roots:function($){var se=J.proots($).map(function(te){return A.parse(te)});return M.Vector.fromArray(se)},froot:function($,se,te){return function(ae){for(var ie=te?te:M.Utils.build(M.Calculus.diff($.clone())),le=$ instanceof Function?$:M.Utils.build($),ne=!1,fe=0;!ne;){var ce=ae-le(ae)/ie(ae),pe=_Mathabs(ce)-_Mathabs(ae),me=_Mathabs(pe);ae=ce,me<1e-12?ne=!0:fe>1e4&&(ae=null,ne=!0),fe++}return ae}(+se)},quad:function($,se,te){var re=function(ae,oe,ie,le){return A.parse('-('+oe+'+'+le+'*sqrt(('+oe+')^2-4*('+ae+')*('+ie+')))/(2*'+ae+')')};return[re($,se,te,1),re($,se,te,-1)]},sumProd:function($,se){return J.quad(-se,$,-1).map(function(te){return te.invert()})},polyPowers:function($,se,te){te=te||[];var re=re=$.group;if(re===V&&se===$.value)te=te.concat(G($.symbols));else if(re===I)for(var ae in $.symbols){var oe=$.symbols[ae],re=oe.group,ie=oe.value;if(re===L&&se===ie)te.push(oe.power);else if(re===V||re===I)te=J.polyPowers(oe,se,te);else if(re===B&&oe.contains(se)){var le=oe.symbols[se];le&&te.push(le.power)}else(re===D||se!==ie)&&te.push(0)}return M.Utils.arrayUnique(te).sort()},Factor:{mix:function($,se){for(var te=G($),re=te.length,ae=[],oe=0;oe<re;oe++){for(var fe,ie=te[oe],le=$[ie],ue=ae.length,ne=0;ne<ue;ne++)fe=ae[ne]*ie,ae.push(fe),se&&ae.push(-fe);for(var ne=1;ne<=le;ne++)ae.push(_Mathpow(ie,ne))}return ae},factor:function($,se){if($.group===L)return $;if($.isConstant())return M.Math2.factor($);var te=$.power.clone();if(X(te)){$.toLinear(),se=se||new F;var ae,re={};$=A.parse(M.Utils.subFunctions($,re)),0<G(re).length&&(se.preAdd=function(fe){return A.parse(fe,M.Utils.getFunctionsSubs(re))}),$.isLinear()||(se.pFactor=$.power.toString(),$.toLinear());var oe=Q($),ie=1<oe.length;if(ie&&(ae=$.clone()),ie){var le=!0,ue=!0;if($.each(function(fe){fe.group!==L&&(le=!1),fe.multiplier.equals(1)||(ue=!1)}),le&&ue)return A.pow($,A.parse(te))}$=J.Factor.coeffFactor($,se),$=J.Factor.powerFactor($,se),1===oe.length?($=J.Factor.squareFree($,se),$=J.Factor.trialAndError($,se)):$=J.Factor.mfactor($,se),$=A.parse($,M.Utils.getFunctionsSubs(re)),se.add($);var ne=se.toSymbol();return ie&&!M.Utils.compare(ae,ne,oe)?ae:A.pow(ne,A.parse(te))}return $},squareFree:function($,se){if($.isConstant()||$.group===L)return $;var te=new U($),re=te.squareFree(),ae=re[2];if(1!==ae){var oe=re[1].toSymbol();return oe.power=oe.power.multiply(new O(ae)),se.add(J.Factor.factor(oe)),J.Factor.squareFree(re[0].toSymbol(),se)}return $},powerFactor:function($,se){if($.group!==V)return $;var te=M.Utils.arrayMin(G($.symbols)),re=new W(0),ae=A.parse($.value+'^'+te);return $.each(function(oe){oe=A.divide(oe,ae.clone()),re=A.add(re,oe)}),se.add(ae),re},coeffFactor:function($,se){if($.isComposite()){var te=M.Math2.QGCD.apply(null,$.coeffs());te.equals(1)||$.each(function(re){re.isComposite()?re.each(function(ae){ae.multiplier=ae.multiplier.divide(te)}):re.multiplier=re.multiplier.divide(te)}),$.updateHash(),se&&se.add(new W(te))}return $},trialAndError:function($,se){if($.isConstant()||$.group===L)return $;for(var te=new U($),re=te.coeffs[0],ae=M.Math2.ifactor(re),oe=J.proots($),ie=0;ie<oe.length;ie++){var le=oe[ie],ue=1;if(!isNaN(le)){for(var ne in ae){var fe=M.Utils.round(_Mathlog(ne)/_Mathlog(_Mathabs(le)),8);if(X(fe)){le=ne,ue=fe;break}}var ce=new O(le),pe=[new O(ce.num).negate()];pe[ue]=new O(ce.den);var me=U.fromArray(pe,te.variable).fill(),de=te.divide(me);de[1].equalsNumber(0)&&(te=de[0],se.add(me.toSymbol()))}}return te.equalsNumber(1)||(te=J.Factor.search(te,se)),te.toSymbol()},search:function($,se,te){te=te||10;var re=$.variable,ae=function(ye,ve,qe,Se){var Ue=U.fit(ye,ve,qe,te,Se,re);if(Ue&&1<Ue.coeffs.length){var xe=$.divide(Ue);if(xe[1].equalsNumber(0))return se.add(Ue.toSymbol()),[xe[0],Ue]}return null},oe=$.coeffs[0],ie=M.Math2.ifactor(oe),le=$.lc(),ue=M.Math2.ifactor(le),ne=$.sub(te),fe=J.Factor.mix(M.Math2.ifactor(ne),0>ne),ce=Math.ceil($.coeffs.length/2),pe=le.lessThan(0),me=oe.lessThan(0);for(ue[1]=1,ie[1]=1;ce--;)for(var de in ue)for(var ge in ie)for(var he,be=0;be<fe.length;be++){if(he=ae(de,ge,fe[be],ce),he)return $=he[0],M.Utils.isPrime($.sub(te))||($=J.Factor.search($,se)),$;!he&&pe?he=ae(-de,ge,fe[be],ce):!he&&me?he=ae(de,-ge,fe[be],ce):!he&&pe&&me&&(he=ae(-de,-ge,fe[be],ce))}return $},mSqfrFactor:function($,se){for(var te=Q($).reverse(),re=0;re<te.length;re++)do{var ae=J.Factor.coeffFactor(M.Calculus.diff($,te[re]));if(ae.equals(0))break;var oe=J.div($,ae.clone()),ie=oe[1].equals(0);if(oe[0].isConstant()){se.add(oe[0]);break}ie&&(se.add(oe[0]),$=ae)}while(ie);return $},mfactor:function($,se){$=J.Factor.mSqfrFactor($,se);for(var ne,te=Q($),re=$.collectSymbols(),ae={},oe={},ie=te.length,le=re.length,ue=0;ue<ie;ue++){ne=te[ue],ae[ne]=new W(0);for(var ce,fe=0;fe<le;fe++)if(ce=re[fe],ce.contains(ne)){var pe=ce.value===ne?ce.power.toDecimal():ce.symbols[ne].power.toDecimal();(!oe[ne]||pe<oe[ne])&&(oe[ne]=pe),ae[ne]=A.add(ae[ne],ce.clone())}}for(var me in ae){var de=A.parse(me+'^'+oe[me]),ge=A.expand(A.divide(ae[me],de)),be=J.div($.clone(),ge);if(be[0].equals(0))return be[1];if(be[1].equals(0)){var he=be[0];se.add(he),se.add(ge);var ye=J.div($,be[0].clone()),de=ye[0];return de.isConstant()?(se.add(de),de):J.Factor.mfactor(de,se)}}return $}},allLinear:function($){for(var se=$.length,te=0;te<se;te++)if(!J.isLinear($[te]))return!1;return!0},isLinear:function($){var se=!1,te=$.group;if(te===V||te===I)for(var re in se=!0,$.symbols){var ae=$.symbols[re],oe=ae.group;if(oe===Z||oe===R||oe===B)se=!1;else if(oe===V||oe===I)se=J.isLinear(ae);else if(ae.group!==D&&'1'!==ae.power.toString()){se=!1;break}}else te===L&&1===$.power&&(se=!0);return se},gcd:function($,se){if(($.group===Z||$.group===E)&&($=M.Utils.block('PARSE2NUMBER',function(){return A.parse($)})),se.group===Z&&(se=M.Utils.block('PARSE2NUMBER',function(){return A.parse(se)})),$.isConstant()&&se.isConstant())return M.Math2.QGCD(new O(+$),new O(+se));if($.length<se.length){var te=$;$=se,se=te}var re=Q($),ae=Q(se);if(re.length===ae.length&&1===re.length&&re[0]===ae[0])return $=new U($),se=new U(se),$.gcd(se).toSymbol();for(var oe,te;!se.equals(0);){if(te=se.clone(),$=$.clone(),oe=J.div($,te),se=oe[1],oe[0].equals(0))return new W(M.Math2.QGCD($.multiplier,se.multiplier));$=te}var ie=[];$.each(function(ue){ie.push(ue.multiplier)});var le=M.Math2.QGCD.apply(void 0,ie);return le.equals(1)||$.each(function(ue){ue.multiplier=ue.multiplier.divide(le)}),$},divide:function($,se){var te=J.div($,se),re=A.divide(te[1],se);return A.add(te[0],re)},div:function($,se){if(se.isConstant())return $.each(function(Ze){Ze.multiplier=Ze.multiplier.divide(se.multiplier)}),[$,new W(0)];if($.group===L&&se.group===I){var te=se.symbols[$.value];if(te&&se.isLinear()&&te.isLinear()&&$.isLinear())return[new W(1),A.subtract($.clone(),se.clone())]}var re=$.hasFunc(),ae=se.hasFunc(),oe=!1;if(re||ae){oe=!0;var ie={},$=A.parse(M.Utils.subFunctions($,ie)),se=A.parse(M.Utils.subFunctions(se,ie)),le=M.Utils.getFunctionsSubs(ie)}var ne,fe,ue=M.Utils.arrayUnique(Q($).concat(Q(se)));if(1===ue.length){var ce=new U($).divide(new U(se));ne=ce[0].toSymbol(),fe=ce[1].toSymbol()}else{ue.push(Y);var pe=function(Ze){for(var Ie,Ve=new W(0),Te=0;Te<Ze.length;Te++)Ie=Ze[Te].toSymbol(),Ve=A.add(Ve,Ie);return Ve},me=function(Ze,Ve){var Be,Te=_Mathmax.apply(null,Ze.terms),Ie=0;if(!Ve)for(var ke=0;ke<Ze.terms.length;ke++)if(Ze.terms[ke].equals(Te)&&(Be=ke,Ie++),1<Ie)return;if(Ve)for(ke=0;ke<Ze.terms.length;ke++)if(Ze.terms[ke].equals(Te)){Be=ke;break}return[Te,Be,Ze]},de=function(Ze,Ve){Ve=Ve||0;var Te=Ze[Ve],Ie=Ze.length;if(Te){for(var Be=me(Te),ke=Ve+1;ke<Ie;ke++){var Ge=Ze[ke],Qe=Te.sum.equals(Ge.sum);if(!Qe&&Be)break;if(Qe){for(var He,Oe,Xe,We,Ye=Te.terms.length,Je=0;Je<Ye;Je++){var $e=Te.terms[Je],Ke=Ge.terms[Je];('undefined'==typeof He||$e.greaterThan(He))&&(He=$e,Xe=Je),('undefined'==typeof Oe||Ke.greaterThan(Oe))&&(Oe=Ke,We=Je)}var es=He.subtract(Ge.terms[Xe]),rs=Oe.subtract(Te.terms[We]);if(rs>es){Be=[Oe,We,Ge];break}if(es>rs){Be=[He,Xe,Te];break}}else if(Be=me(Ge),Be)break;Be=me(Ge)}if(!Be)return me(Ze[0],!0);for(var as,os,is,ke=0;ke<ve.length;ke++){if(is=ve[ke].terms,os=Be[1],os===is.length-1)return;if(as=is[os],!as.equals(0))break}return as.equals(0)?de(Ze,++Ve):Be}},ge=M.Utils.toMapObj(ue),be=function(Ze,Ve){return Ve.sum.subtract(Ze.sum)},he=function(Ze,Ve){if(!Ze||!Ve)return!1;for(var Te=0;Te<Ze.terms.length;Te++)if(Ze.terms[Te].lessThan(Ve.terms[Te]))return!1;return!0},ye=$.tBase(ge).sort(be),ve=se.tBase(ge).sort(be),qe=he(ye[0],ve[0])&&ye[0].count>ve[0].count?ve:ye,Se=de(qe),Ue=[];if(Se){var xe=Se[1],Fe=function(Ze,Ve){return!Ze[0].sum.equals(Ve[0].sum)||Ze.length>=Ve.length},Ne=function(Ze,Ve,Te){return Te},we=function(Ze,Ve){var Te=Ze.len(),Ie=Ve.len(),Be=Ve.terms[xe],ke=Ze.terms[xe];return Ie>Te&&Be.greaterThan(ke)?Ie-Te:Be.subtract(ke)};xe=Ne(ye,ve,xe),ye.sort(we),ve.sort(we);var Ce=ve[0],Me=ye[0],je=new C(new O(1),[],Me.map);if(Ce.sum.greaterThan(Me.sum)&&1<Me.len())for(var De,Ae=0;Ae<Me.terms.length;Ae++)if(De=Ce.terms[Ae].subtract(Me.terms[Ae]),!De.equals(0)){var Pe=De.add(new O(1));je.terms[Ae]=De;for(var Ee=0;Ee<ye.length;Ee++)ye[Ee].terms[Ae]=ye[Ee].terms[Ae].add(Pe)}else je.terms[Ae]=new O(0);for(var ce,ze=he(ye[0],ve[0]);ze&&Fe(ye,ve);){ce=ye[0].divide(ve[0]),Ue.push(ce),ye.shift();for(var Ae=1;Ae<ve.length;Ae++){var Le=ve[Ae].multiply(ce).generateImage(),Re=ye.length;0===Re&&(Le.coeff=Le.coeff.neg(),ye.push(Le),ye.sort(we));for(var _e,Ee=0;Ee<Re;Ee++){if(_e=ye[Ee],_e.getImg()===Le.getImg()){_e.coeff=_e.coeff.subtract(Le.coeff),_e.coeff.equals(0)&&(M.Utils.remove(ye,Ee),Ee--);break}Ee===Re-1&&(Le.coeff=Le.coeff.neg(),ye.push(Le),ye.sort(we))}}if(ze=he(ye[0],ve[0]),!ze&&ye.length>=ve.length)for(var Ae=1;Ae<ye.length;Ae++)if(ze=he(ye[Ae],ve[0]),ze){ye.unshift(M.Utils.remove(ye,Ae));break}}}ne=pe(Ue),fe=pe(ye),'undefined'!=typeof je&&(je=je.toSymbol(),ne=A.divide(ne,je.clone()),fe=A.divide(fe,je))}return oe&&(ne=A.parse(ne.text(),le),fe=A.parse(fe.text(),le)),[ne,fe]},Classes:{Polynomial:U,Factors:F,MVTerm:C}};nerdamer.register([{name:'factor',visible:!0,numargs:1,build:function(){return J.Factor.factor}},{name:'gcd',visible:!0,numargs:2,build:function(){return J.gcd}},{name:'roots',visible:!0,numargs:-1,build:function(){return J.roots}},{name:'divide',visible:!0,numargs:2,build:function(){return J.divide}},{name:'div',visible:!0,numargs:2,build:function(){return J.div}}]),nerdamer.api()}();var _Mathmin=Math.min;'undefined'!=typeof module&&'undefined'==typeof nerdamer&&(nerdamer=require('./nerdamer.core.js'),require('./Algebra.js')),function(){'use strict';var o=nerdamer.getCore(),h=o.PARSER,C=o.Frac,T=o.Utils.isSymbol,R=o.groups.FN,E=o.Symbol,F=o.Utils.text,V=o.Utils.inBrackets,H=o.Utils.isInt,I=o.Utils.format,O=o.groups.N,D=o.groups.S,R=o.groups.FN,X=o.groups.PL,J=o.groups.CP,z=o.groups.CB,K=o.groups.EX,W=o.groups.P,Y='log',Z='abs',$='sqrt',G='sin',ee='cos',ie='tan',te='sec',re='csc',ne='cot',oe='asin',ae='acos',le='atan';E.prototype.hasIntegral=function(){return this.containsFunction('integral')},E.unwrapPARENS=function(ce){if(ce.group===R&&!ce.fname){var me=ce.args[0];return me.power=me.power.multiply(ce.power),me.multiplier=me.multiplier.multiply(ce.multiplier),me}return ce},o.Expression.prototype.hasIntegral=function(){return this.symbol.hasIntegral()},o.Utils.in_inverse_trig=function(ce){return-1!==[oe,ae,le,'acsc','asec','acot'].indexOf(ce)},o.Utils.in_trig=function(ce){return-1!==[ee,G,ie,te,re,ne].indexOf(ce)},o.Settings.integration_depth=4;var ge=o.Calculus={version:'1.3.3',sum:function(ce,me,de,ye){if(me.group!==o.groups.S)throw new Error('Index must be symbol. '+F(me)+' provided');me=me.value;var we;if(o.Utils.isNumericSymbol(de)&&o.Utils.isNumericSymbol(ye)){de=de.multiplier,ye=ye.multiplier;var fe=o.Utils.variables(ce);if(1===fe.length&&me===fe[0]){var he=o.Utils.build(ce);we=0;for(var ve=de;ve<=ye;ve++)we+=he.call(void 0,ve);we=new E(we)}else for(var he=ce.text(),be={'~':!0},we=new o.Symbol(0),ve=de;ve<=ye;ve++)be[me]=new E(ve),we=h.add(we,h.parse(he,be))}else we=h.symfunction('sum',arguments);return we},diff:function(ce,me,de){function ye(Se){return(Se.value===ve||Se.contains(ve,!0))&&(Se.multiplier=Se.multiplier.multiply(Se.power),Se.power=Se.power.subtract(new C(1)),Se.power.equals(0)&&(Se=E(Se.multiplier))),Se}function we(Se){var xe,Ce,Te,qe=Se.group;if(qe===O||qe===D&&Se.value!==ve||qe===W)Se=E(0);else if(qe===D)Se=ye(Se);else{if(qe===z){var Me=Se.multiplier.clone();Se.toUnitMultiplier();var Ae=h.multiply(he(Se),ye(Se.clone()));return Ae.multiplier=Ae.multiplier.multiply(Me),Ae}if(qe===R&&Se.power.equals(1))switch(Se.fname){case Y:Te=Se.clone(),Se=Se.args[0].clone(),Se.power=Se.power.negate(),Se.multiplier=Te.multiplier.divide(Se.multiplier);break;case ee:Se.fname=G,Se.multiplier.negate();break;case G:Se.fname=ee;break;case ie:Se.fname=te,Se.power=new C(2);break;case te:Se=fe(Se,ie);break;case re:Se=fe(Se,'-cot');break;case ne:Se.fname=re,Se.multiplier.negate(),Se.power=new C(2);break;case oe:Se=h.parse('(sqrt(1-('+F(Se.args[0])+')^2))^(-1)');break;case ae:Se=h.parse('-(sqrt(1-('+F(Se.args[0])+')^2))^(-1)');break;case le:Se=h.parse('(1+('+F(Se.args[0])+')^2)^(-1)');break;case Z:Me=Se.multiplier.clone(),Se.toUnitMultiplier(),Ce=Se.args[0].clone(),Ce.toUnitMultiplier(),Se=h.parse(V(F(Se.args[0]))+'/abs'+V(F(Ce))),Se.multiplier=Me;break;case'parens':Se=E(1);break;case'cosh':Se.fname='sinh';break;case'sinh':Se.fname='cosh';break;case'tanh':Se.fname='sech',Se.power=new C(2);break;case'sech':Se=fe(Se,'-tanh');break;case'asinh':Se=h.parse('(sqrt(1+('+F(Se.args[0])+')^2))^(-1)');break;case'acosh':Se=h.parse('(sqrt(-1+('+F(Se.args[0])+')^2))^(-1)');break;case'atanh':Se=h.parse('(1-('+F(Se.args[0])+')^2)^(-1)');break;case'Si':var Re=Se.args[0];Se=h.parse('sin('+Re+')/('+Re+')');break;case'Ci':var Re=Se.args[0];Se=h.parse('cos('+Re+')/('+Re+')');}else if(qe===K||qe===R&&T(Se.power)){var Ne;Ne=qe===K?Se.value:qe===R&&Se.contains(ve)?Se.fname+V(F(Se.args[0])):Se.value+V(F(Se.args[0])),xe=h.multiply(h.parse(Y+V(Ne)),Se.power.clone()),Ce=ge.diff(h.multiply(h.parse(Y+V(Ne)),Se.power.clone()),ve),Se=h.multiply(Se,Ce)}else if(qe===R&&!Se.power.equals(1))Ce=Se.clone(),Ce.toLinear(),Ce.toUnitMultiplier(),Se=h.multiply(ye(Se.clone(),ve),we(Ce));else if(qe===J||qe===X){var Ee=new E(0);for(var Fe in Se.symbols)Ee=h.add(Ee,ge.diff(Se.symbols[Fe].clone(),ve));Se=h.multiply(ye(Se.clone()),Ee)}}return Se.updateHash(),Se}function fe(Se,qe,xe){return h.multiply(Se,h.parse(qe+V(xe||F(Se.args[0]))))}function he(Se){for(var Me,qe=Se.collectSymbols(),xe=new E(0),Ce=qe.length,Te=0;Te<Ce;Te++){Me=ge.diff(qe[Te].clone(),ve);for(var Ae=0;Ae<Ce;Ae++)Te!==Ae&&(Me=h.multiply(Me,qe[Ae].clone()));xe=h.add(xe,Me)}return xe}var ve=T(me)?me.text():me;if(de=T(de)?de.multiplier:de||1,void 0===ve&&(ve=o.Utils.variables(ce)[0]),ce.group===R&&ce.fname===$){var be=ce.args[0],_e=ce.power.clone();(be.group!==O||be.group!==W)&&(be.power=T(be.power)?h.multiply(be.power,h.multiply(new E(1/2)),_e):be.power.multiply(new C(0.5)).multiply(_e),be.multiplier=be.multiplier.multiply(ce.multiplier)),ce=be}if(ce.group===R&&!T(ce.power)){var Le=we(ce),Ue=ge.diff(ce.args[0].clone(),ve);ce=h.multiply(Le,Ue)}else ce=we(ce);return 1<de&&(de--,ce=ge.diff(ce,me,de)),ce},integration:{u_substitution:function(ce,me){function de(Me,Ae,Re){var Ne=Re?Re(Me,Ae):h.divide(Me.clone(),ge.diff(Ae,me));return Ne.contains(me)?null:Ne}function ye(Me,Ae){var Re=ge.integrate(h.symfunction(Me,[new E(be)]),be);return Re=Re.sub(new E(be),Ae),Re.updateHash(),Re}var _e,we=ce[0].clone(),fe=ce[1].clone(),he=we.group,ve=fe.group,be='__u__';if(he===R&&ve!==R){var Le=we.args[0];if(_e=de(fe,Le.clone()),_e)return h.multiply(_e,ye(we.fname,Le));if(_e=de(fe,we),_e)return ge.integration.poly_integrate(we)}else if(ve===R&&he!==R){var Le=fe.args[0];if(_e=de(we,Le.clone()),_e)return h.multiply(_e,ye(fe.fname,Le))}else if(he===R&&he===R){if(_e=de(we.clone(),fe.clone()),_e)return h.multiply(ge.integration.poly_integrate(fe),_e);if(_e=de(fe.clone(),we.clone()),_e)return h.multiply(ge.integration.poly_integrate(fe),_e)}else{if(he===K&&ve!==K){var Ue=we.power;_e=de(fe,Ue.clone());var Se=ge.integrate(we.sub(Ue.clone(),new E(be)),be),qe=h.multiply(Se.sub(new E(be),Ue),_e);return qe}if(ve===K&&he!==K){var Ue=fe.power;_e=de(we,Ue.clone());var Se=ge.integrate(fe.sub(Ue,new E(be)),be);return h.multiply(Se.sub(new E(be),Ue),_e)}if(we.isComposite()||fe.isComposite()){var xe=function(Me,Ae){var Re=o.Algebra.Factor.factor(Me),Ne=o.Algebra.Factor.factor(ge.diff(Ae,me)),Ee=h.divide(Re,Ne);return Ee},Ce=we.isComposite()?we.clone().toLinear():we.clone(),Te=fe.isComposite()?fe.clone().toLinear():fe.clone();if(_e=de(Ce.clone(),Te.clone(),xe),_e)return h.multiply(ge.integration.poly_integrate(fe),_e);if(_e=de(Te.clone(),Ce.clone(),xe),_e)return h.multiply(ge.integration.poly_integrate(we),_e)}}},poly_integrate:function(ce){var me=ce.power.toString(),de=ce.multiplier.toString(),ye=ce.toUnitMultiplier().toLinear();return-1===+me?h.multiply(new E(de),h.symfunction(Y,[ye])):h.parse(I('({0})*({1})^(({2})+1)/(({2})+1)',de,ye,me))},stop:function(ce){throw ce=ce||'Stopping!',new Error(ce)},partial_fraction:function(ce,me,de){var ye,we,fe=new E(ce.multiplier);if(T(ce)?(we=ce.getDenom().invert(),ye=ce.getNum()):(ye=ce[0],we=ce[1]),ye.isConstant()){var he=we.clone().toLinear(),ve=he.stripVar(me),be=h.subtract(he.clone(),ve);if(be.group===D&&be.isLinear())return ge.integration.poly_integrate(ce);we.power.greaterThan(1)&&(we=h.expand(we))}var _e=o.Algebra.div(ye,we.clone()),Le=new o.Matrix,Ue=new o.Matrix,Se=_e[1].toArray(me),ye=_e[1],qe=E.unwrapPARENS(o.Algebra.Factor.factor(we)),xe=[],Ce=_e[0].equals(0)?_e[0]:ge.integrate(_e[0],me,de);if(qe.group!==J)qe.each(function(ke){ke=E.unwrapPARENS(ke),ke.isConstant()?fe=h.multiply(fe,ke):xe.push(ke)});else{if(_e[1].isComposite())_e[1].each(function(ke){var Oe=h.divide(ke.clone(),qe.clone());Ce=h.add(Ce,ge.integrate(Oe,me,de))});else{var he=qe.clone().toLinear(),Te=ge.integration.decompose_arg(he,me),Me=Te[1],ve=Te[0],Ae=Te[3];Me.isLinear()||ge.integration.stop(),qe.power.greaterThan(0)?(Ce=_e[1].isConstant()?ge.integration.poly_integrate(h.divide(_e[1],qe)):h.add(ge.integrate(h.divide(he.clone(),qe.clone()),me,de),ge.integrate(h.divide(Ae.negate(),qe.clone()),me,de)),Ce=h.divide(Ce,ve)):Ce=ge.integration.by_parts(h.divide(_e[1],qe.clone()),me,o.Settings.integration_depth)}return Ce}var Re=xe.length;if(1===Re){var Ne=h.divide(_e[1],xe[0]),Ee=ge.integrate(Ne,me,de);return Ee=h.divide(Ee,fe),Ce=h.add(Ce,Ee),Ce}for(var Pe,Fe=0;Fe<Re;Fe++){Pe=new E(1);for(var Ve=0;Ve<Re;Ve++)Fe!==Ve&&(Pe=h.multiply(Pe,xe[Ve].clone()));Pe=h.expand(Pe).toArray(me);var He=Se[Fe];Ue.elements[Fe]=He?[He]:[E(0)],Le.elements[Fe]=Pe}for(var Ie=Le.transpose().invert().multiply(Ue),Fe=0;Fe<Re;Fe++){var je=ge.integrate(h.divide(_e[1].clone(),xe[Fe]),me,de),Qe=h.expand(Ie.elements[Fe][0]),Be=h.divide(Qe,fe.clone());Ce=h.add(Ce,h.multiply(je,Be))}return Ce},by_parts:function(ce,me,de){var we,fe,he,ve,be,_e,Le,Ue,Se,qe;return we=function(xe){var Ce=[[],[],[],[],[]],Te=function(Ve){var He=Ve.group;if(He===R){var Ie=Ve.fname;o.Utils.in_trig(Ie)?Ce[3].push(Ve):o.Utils.in_inverse_trig(Ie)?Ce[1].push(Ve):Ie===Y?Ce[0].push(Ve):stop()}else He===D||Ve.isComposite()&&Ve.isLinear()||He===z&&Ve.isLinear()?Ce[2].push(Ve):He===K||Ve.isComposite()&&!Ve.isLinear()?Ce[4].push(Ve):stop()};xe.group===z?xe.each(function(Ve){Te(E.unwrapSQRT(Ve,!0))}):Te(xe);for(var Me,Ae=new E(1),Re=0;5>Re;Re++){var Ee,Ne=Ce[Re],Fe=Ne.length;if(0<Fe){if(1<Fe){Ee=new E(1);for(var Pe=0;Pe<Fe;Pe++)Ee=h.multiply(Ee,Ne[Pe].clone())}else Ee=Ne[0].clone();Me?Ae=h.multiply(Ae,Ee):(Me=Ee,Me.multiplier=Me.multiplier.multiply(xe.multiplier))}}return[Me,Ae]}(ce),fe=we[0],he=we[1],ve=E.unwrapSQRT(h.expand(ge.diff(fe.clone(),me)),!0),be=ge.integrate(he.clone(),me,de),_e=h.multiply(be.clone(),ve),Le=h.multiply(fe,be),qe=_e.multiplier.clone(),_e.toUnitMultiplier(),Se=ge.integrate(_e.clone(),me,de),Se.multiplier=Se.multiplier.multiply(qe),Ue=h.subtract(Le,Se),Ue},decompose_arg:function(ce,me){var de,ye,we,fe;if(ce.group===J){var he=h.expand(ce.clone()).stripVar(me);de=h.subtract(ce.clone(),he.clone()),fe=he}else de=ce.clone();return ye=de.stripVar(me),we=h.divide(de.clone(),ye.clone()),[ye,we,de,fe]}},integrate:function(ce,me,de){de=de||0;var he,ye=T(me)?me.toString():me,we=E.unwrapSQRT(ce.clone(),!0),fe=we.group;try{if(++de>o.Settings.integration_depth&&ge.integration.stop('Maximum depth reached. Exiting!'),!we.contains(ye,!0))he=h.multiply(we.clone(),h.parse(ye));else if(fe===D)he=ge.integration.poly_integrate(we,ye,de);else if(fe===K){if(we.contains(ye))we.power.contains(ye)?ge.integration.stop():he=ge.integration.poly_integrate(we,ye,de);else{var ve=ge.diff(we.power.clone(),ye);if(ve.contains(ye)){var be=ve.stripVar(ye),_e=h.divide(ve.clone(),be.clone());if(_e.group===D&&_e.isLinear())return be.multiplier=be.multiplier.divide(new C(2)),h.parse(I('({2})*(sqrt(pi)*erf(sqrt(-{0})*{1}))/(2*sqrt(-{0}))',be,ye,we.multiplier));ge.integration.stop()}if(we.isE())he=we;else{var Le=h.symfunction(Y,[h.parse(we.value)]);he=h.divide(we,Le)}he=h.divide(he,ve)}}else if(we.isComposite()&&we.isLinear())he=new E(0),we.each(function(Ei){he=h.add(he,ge.integrate(Ei,ye,de))});else if(fe===J){if(we.power.greaterThan(1)&&(we=h.expand(we)),we.power.equals(1))he=new E(0),we.each(function(Ei){he=h.add(he,ge.integrate(Ei,ye,de))},!0);else{var Ue=+we.power,Se=we.multiplier.clone();we.toUnitMultiplier();var qe=we.clone().toLinear(),xe=ge.integration.decompose_arg(qe,ye),Ce=xe[3],Te=xe[2],ve=xe[0],_e=xe[1];if(-1===Ue&&_e.group!==X){if(_e.group===D&&_e.power.equals(2)){var Me=function(Ei){var Fi=new E(1);return Ei.each(function(Pi){Fi=h.multiply(Fi,'abs'===Pi.fname?Pi.args[0]:Pi)}),Fi},Ae=ve.clone(),Re=Ce.clone();Ae=h.pow(Ae,new E(1/2)),Re=h.pow(Re,new E(1/2));var Le=h.multiply(Me(Re),Me(Ae)),Ne=h.symfunction(le,[h.divide(h.multiply(ve,_e.toLinear()),Le.clone())]);he=h.divide(Ne,Le)}else he=_e.group===D&&_e.isLinear()?h.divide(ge.integration.poly_integrate(we),ve):ge.integration.partial_fraction(we,ye,de);}else if(Ue!==-1/2)he=_e.isLinear()&&_e.group!==X?h.divide(ge.integration.poly_integrate(we),ve):ge.integration.partial_fraction(we,ye,de);else if(!(_e.group===D&&_e.power.equals(2)))ge.integration.stop();else if(!Te.multiplier.lessThan(0)||Ce.multiplier.lessThan(0))ge.integration.stop();else if(ve.negate(),Ce.isConstant()&&ve.isConstant()){var Le=h.symfunction($,[ve.clone()]),Ee=h.symfunction($,[h.multiply(ve.clone(),Ce)]);he=h.divide(h.symfunction(oe,[h.divide(Te.toLinear(),Ee)]),Le)}else{var Fe=h.symfunction($,[ve]),Pe=h.multiply(Fe.clone(),_e.clone().toLinear());he=h.divide(h.symfunction(le,[h.divide(Pe,h.symfunction($,[qe.clone()]))]),Fe)}he.multiplier=he.multiplier.multiply(Se)}}else if(fe===R){var Ve=we.args[0],Se=we.multiplier.clone();we.toUnitMultiplier();var xe=ge.integration.decompose_arg(Ve,ye),ve=xe[0],_e=xe[1],He=we.fname;if(He===Y||He===oe||He===ae||He===le&&_e.isLinear()){var Ue=we.power.toString();H(Ue)&&(de-=Ue),he=ge.integration.by_parts(we,ye,de)}else{if(!ve.contains(ye,!0)&&we.isLinear()){if(He===Z){var _e=h.divide(Ve.clone(),ve.clone());if(_e.group!==D||_e.power.lessThan(0))ge.integration.stop();else if(o.Utils.even(_e.power))he=ge.integrate(Ve,ye,de);else{var Ie=ge.integrate(_e,ye,de);Ie.power=Ie.power.subtract(new C(1)),he=h.multiply(h.multiply(h.symfunction(Z,[_e.toLinear()]),Ie),ve)}}else{var je=we.args[0].group;switch(je===J||je===D||je===z||ge.integration.stop(),He){case ee:he=h.symfunction(G,[Ve]);break;case G:he=h.symfunction(ee,[Ve]),he.negate();break;case ie:he=h.parse(I('log(sec({0}))',Ve));break;case te:he=h.parse(I('log(tan({0})+sec({0}))',Ve));break;case re:he=h.parse(I('-log(csc({0})+cot({0}))',Ve));break;case ne:he=h.parse(I('log(sin({0}))',Ve));break;case'erf':var Ve=we.args[0].clone(),be=Ve.stripVar(ye);he=h.parse(I('(({0})*{1}+e^(-{2}^2*{3}^2)/sqrt(pi))',Ve,he,be,ye));break;default:ge.integration.stop();}he=h.divide(he,ve)}}else if(!_e.isLinear())ge.integration.stop();else if(He===ee||He===G){var Ue=+we.power;if(0>Ue)we.fname=He===G?re:te,we.invert().updateHash(),he=ge.integrate(we,ye,de);else{var Ve=we.args[0],Qe=we.clone(),Be=we.clone(),ke=new E((Ue-1)/Ue),Oe=h.multiply(ve.clone(),new E(Ue)).invert();Qe.power=Qe.power.subtract(new C(1)),Be.power=Be.power.subtract(new C(2));var De=h.symfunction(He===ee?G:ee,[Ve.clone()]);He===G&&De.negate(),he=h.add(h.multiply(h.multiply(Oe,Qe),De),h.multiply(ke,ge.integrate(h.parse(Be),ye,de)))}}else if(He===ie||He===ne){if(we.args[0].isLinear(ye)){var Xe=we.power.subtract(new C(1)).toString(),Je=we.clone().toUnitMultiplier(),ze=h.parse(I((He===ne?'-':'')+'1/({2}*{0})*{3}({1})^({0})',Xe,Ve,ve,He));Je.power=Je.power.subtract(new C(2)),Je.power.equals(0)&&(Je=h.parse(Je)),he=h.subtract(ze,ge.integrate(Je,ye,de))}}else if(He===te||He===re){var Ke=we.power.subtract(new C(1)).toString(),We=we.power.subtract(new C(2)).toString(),Ye=He===te?ie:ne,Je=we.clone().toUnitMultiplier(),Ze=I((He===re?'-':'')+'1/({0}*{1})*{4}({3})^({2})*{5}({3})',ve,Ke,We,Ve,He,Ye),ze=h.parse(Ze);Je.power=Je.power.subtract(new C(2)),Je.power.equals(0)&&(Je=h.parse(Je)),he=h.add(ze,h.multiply(new E(We/Ke),ge.integrate(Je,ye,de)))}else ge.integration.stop();he.multiplier=he.multiplier.multiply(Se)}}else if(fe===X)he=ge.integration.partial_fraction(we,ye,de);else if(fe===z){var $e=we.stripVar(ye),Ge=h.divide(we.clone(),$e.clone());if(Ge.group!==z)he=ge.integrate(Ge,ye,de);else{var ei=Ge.collectSymbols().sort(function(Ei,Fi){return Ei.group===Fi.group?+Ei.power===+Fi.power?Ei<Fi?1:-1:Fi.power-Ei.power:Fi.group-Ei.group}).map(function(Ei){return E.unwrapSQRT(Ei,!0)}),ii=ei.length;if(2===ii){try{he=ge.integration.u_substitution(ei,ye)}catch(Ei){}if(!he){var ti=ei[0].group,ri=ei[1].group,ni=ei[0],oi=ei[1],ai=ni.fname,li=oi.fname;if(we=h.multiply(ni.clone(),oi.clone()),ti===R&&ri===R){if(ai===Y||li===Y)he=ge.integration.by_parts(we.clone(),ye,de);else{ei.sort(function(Ei,Fi){return Fi.fname>Ei.fname});var pi=ni.args[0];pi.isLinear()&&(pi.group===J||pi.group===z||pi.group===D)||ge.integration.stop();var xe=ge.integration.decompose_arg(pi,ye);_e=xe[1],ve=xe[0],_e.isLinear()||ge.integration.stop();var si=oi.args[0];if(!pi.equals(si))ge.integration.stop();else if(ai!==G||li!==ee)ai===ie&&li===te&&_e.isLinear()?ni.isLinear()&&oi.isLinear()?he=h.divide(h.symfunction(te,[pi.clone()]),ve):ge.integration.stop():ai===te&&li===ee?(ni.fname=ee,ni.invert().updateHash(),he=ge.integrate(h.multiply(ni,oi),ye,de)):ai===G&&li===re?(oi.fname=G,oi.invert().updateHash(),he=ge.integrate(h.multiply(ni,oi),ye,de)):ge.integration.stop();else if(ni.power.lessThan(0)&&ge.integration.stop(),ai===G&&ni.power.add(oi.power).equals(0))ni.fname=ie,ni.updateHash(),he=ge.integrate(ni,ye,de);else{var ui=o.Utils.even(ni.power),gi=o.Utils.even(oi.power);if(he=new E(0),!ui||!gi){var ci,Je,mi;ui?(ci=ni,Je=oi):(ci=oi,Je=ni);var di=ci.fname===ee?-1:1,Xe=Je.power,mi=h.parse('(1-'+ci.fname+o.Utils.inBrackets(pi)+'^2)^'+(Xe-1)/2),wi=h.expand(h.multiply(new E(di),h.multiply(ci.clone(),mi)));wi.each(function(Ei){he=h.add(he,ge.integration.poly_integrate(Ei.clone()))})}else{var fi=function(Ei){var Vi,Fi=Ei.power,Pi=Fi/2;return Vi=Ei.fname===ee?'((1/2)+(cos(2*('+Ei.args[0]+'))/2))^'+Pi:'((1/2)-(cos(2*('+Ei.args[0]+'))/2))^'+Pi,h.parse(Vi)},ve=fi(ni),Ce=fi(oi),De=h.multiply(ve,Ce),wi=h.expand(De);return wi.each(function(Ei){he=h.add(he,ge.integrate(Ei,ye,de))}),h.multiply(he,$e)}}}}else if(ti===R&&ri===D)he=ni.fname===ee&&oi.power.equals(-1)?h.symfunction('Ci',[ni.args[0]]):ni.fname===G&&oi.power.equals(-1)?h.symfunction('Si',[ni.args[0]]):ge.integration.by_parts(we,ye);else if(ti===K&&ri===D)he=ge.integration.by_parts(we,ye,de);else if(ti===X&&ri===D){if(oi.value===ni.value&&ni.power.equals(-1)){var hi=_Mathmin.apply(null,o.Utils.keys(ni.symbols)),vi=_Mathmin(hi,oi.power),bi=oi.clone();bi.power=new C(vi),oi=h.divide(oi,bi.clone());var De=new E(0);ni.each(function(Ei){De=h.add(De,h.divide(Ei.clone(),bi.clone()))}),De.multiplier=ni.multiplier,we=h.divide(oi,De)}he=ge.integration.partial_fraction(we,ye,de)}else if(ti===J&&ri===D){if(ni.power.equals(-1/2)){var xe=ge.integration.decompose_arg(ni.clone().toLinear(),ye),ve=xe[0].negate(),_e=xe[1],Ce=xe[3],Ue=+oi.power;if(H(Ue)&&o.Utils.even(Ue)&&_e.power.equals(2)){var _i=h.divide(h.multiply(h.pow(Ce.clone(),new E(2)),h.symfunction($,[h.divide(Ce.clone(),ve.clone())])),h.pow(ve.clone(),new E(2)));_i=h.multiply(_i,h.symfunction($,[Ce]).invert());var Li=h.parse('sin(u)');Li.power=Li.power.multiply(oi.power);var Ui=ge.integrate(Li,'u',de),Si=h.parse(oe+'('+$+'('+ve+'/'+Ce+')*'+ye+')');he=h.multiply(_i,Ui.sub(new E('u'),Si))}}else if(ni.power.equals(-1)&&oi.isLinear())he=ge.integration.partial_fraction(we,ye,de);else if(!ni.power.lessThan(0)&&H(ni.power)){var qi=h.expand(ni);he=new E(0),qi.each(function(Ei){Ei.group===X?Ei.each(function(Fi){he=h.add(he,ge.integrate(h.multiply(oi.clone(),Fi),ye,de))}):he=h.add(he,ge.integrate(h.multiply(oi.clone(),Ei),ye,de))})}else if(ni.power.lessThan(-2))he=ge.integration.by_parts(we,ye,de);else if(ni.power.lessThan(0)&&oi.power.greaterThan(1)){var xe=ge.integration.decompose_arg(ni.clone().toLinear(),ye),ve=xe[0].negate(),_e=xe[1],Ce=xe[3],qe=ni.clone().toLinear();if(_e.group!==X&&_e.isLinear()){var Ue=+oi.power,xi='_u_',ci=new E(xi),Ci=h.expand(h.divide(h.pow(h.subtract(ci.clone(),Ce.clone()),new E(Ue)),ci.clone())),Ti={};Ti[xi]=qe;var Mi=h.parse(Ci,Ti);he=ge.integrate(Mi,ye)}else he=ge.integration.partial_fraction(we,ye,de)}else he=ge.integration.partial_fraction(we,ye,de);}else if(!(ni.isComposite()&&oi.isComposite()))ti===J?(ni=h.expand(ni),he=new E(0),ni.each(function(Ei){he=h.add(he,ge.integrate(h.multiply(Ei,oi.clone()),ye,de))},!0)):he=ge.integration.by_parts(we,ye,de);else if(he=new E(0),ni.power.greaterThan(0)&&oi.power.greaterThan(0)){var wi=h.expand(we);wi.each(function(Ei){he=h.add(he,ge.integrate(Ei,ye,de))},!0)}else{var Ai=+ni.power,Ri=+oi.power;if(0>Ai&&0<Ri){var De=ni;ni=oi,oi=De}ni.each(function(Ei){he=h.add(he,ge.integrate(h.multiply(Ei,oi.clone()),ye,de))})}}}else if(3===ii&&(ei[2].group===D&&ei[2].power.lessThan(2)||ei[0].group===J)){var Ni=ei[0];if(Ni.group===J){Ni.power.greaterThan(1)&&(Ni=h.expand(Ni));var Je=h.multiply(ei[1],ei[2]);he=new E(0),Ni.each(function(Ei){var Fi=h.multiply(Ei,Je.clone()),Pi=ge.integrate(Fi,ye,de);he=h.add(he,Pi)},!0)}else he=ge.integration.by_parts(we,ye,de)}}he=h.multiply(he,$e)}if(he)return he}catch(Ei){}return h.symfunction('integrate',[ce,me])}};nerdamer.register([{name:'diff',visible:!0,numargs:[1,3],build:function(){return ge.diff}},{name:'sum',visible:!0,numargs:4,build:function(){return ge.sum}},{name:'integrate',visible:!0,numargs:2,build:function(){return ge.integrate}}]),nerdamer.api()}();var _Mathabs=Math.abs;'undefined'!=typeof module&&(nerdamer=require('./nerdamer.core.js'),require('./Calculus.js'),require('./Algebra.js')),function(){function g(T,U){if(U.isConstant()&&T.isConstant()&&!T.equals(U))throw new Error(T.toString()+' does not equal '+U.toString());this.LHS=T,this.RHS=U}var h=nerdamer.getCore(),n=h.PARSER,o=h.Algebra,s=h.Calculus,t=s.integration.decompose_arg,u=h.Utils.remove,w=h.Utils.format,A=h.Utils.build,B=h.Symbol,E=h.Utils.isSymbol,F=h.Utils.variables,G=h.groups.S,H=h.groups.CB,I=h.Utils.isArray;h.Solve={version:'1.2.1',solve:function(T,U){return new h.Vector(P(T.toString(),U?U.toString():U))}},h.Settings.solve_radius=500,h.Settings.roots_per_side=5,h.Settings.make_pi_conversions=!0,h.Symbol.prototype.hasTrig=function(){return this.containsFunction(['cos','sin','tan','cot','csc','sec'])};g.prototype={toString:function(){return this.LHS.toString()+'='+this.RHS.toString()},text_:function(T){return this.LHS.text(T)+'='+this.RHS.text(T)},toLHS:function(){return n.subtract(this.LHS.clone(),this.RHS.clone())},clone:function(){return new g(this.LHS.clone(),this.RHS.clone())},sub:function(T,U){var V=this.clone();return V.LHS=V.LHS.sub(T.clone(),U.clone()),V.RHS=V.RHS.sub(T.clone(),U.clone()),V},latex_:function(T){return[this.LHS.latex(T),this.RHS.latex(T)].join('=')}},n.equals=function(T,U){return new g(T,U)};var J=function(T){var U=T.split('=');U[1]===void 0&&(U[1]='0');var V=n.parse(U[0]),W=n.parse(U[1]);return n.subtract(V,W)},K=function(T,U){nerdamer.clearVars();for(var V=0;V<T.length;V++)T[V]=J(T[V]);var $,W=T.length,X=new h.Matrix,Y=new h.Matrix,Z=!1;if('undefined'==typeof U){o.allLinear(T)||h.err('System must contain all linear equations!'),$=F(T[0]);for(var V=1;V<W;V++)$=$.concat(F(T[V]));$=h.Utils.arrayUnique($).sort();for(var aa,V=0;V<W;V++){aa=T[V];for(var ca,ba=0;ba<W;ba++)ca=aa.symbols[$[ba]],X.set(V,ba,ca?ca.multiplier:0);var da=aa.symbols['#'];Y.set(V,0,new B(da?-da.multiplier:0))}}else for($=U,Z=!0,V=0;V<W;V++){Y.set(V,0,new B(0));for(var aa=n.expand(T[V]).collectSymbols(),ba=0;ba<U.length;ba++){X.set(V,ba,new B(0));for(var ea=U[ba],fa=0;fa<aa.length;fa++){for(var ga=aa[fa],ha=!1,ia=0;ia<U.length;ia++)ga.contains(U[ia])&&(ha&&h.err('Multiple variables found for term '+ga),ha=!0);if(ga.contains(ea)){var ja=t(u(aa,fa),ea);X.set(V,ba,n.add(X.get(V,ba),ja[0]))}}}for(fa=0;fa<aa.length;fa++)Y.set(V,0,n.add(Y.get(V,0),aa[fa]))}X=X.invert();var ka=X.multiply(Y),la=[];return ka.each(function(ma,na){la.push([$[na],(Z?n.expand(ma):ma).valueOf()])}),la},L=function(T,U,V,W){var X='-'===W?'subtract':'add',Y=n.subtract(n.pow(U.clone(),B(2)),n.multiply(n.multiply(V.clone(),T.clone()),B(4))),Z=n.pow(Y,B(0.5));return n.divide(n[X](U.clone().negate(),Z),n.multiply(new B(2),V.clone()))},M=function(T,U,V,W){var X=W.text(),Y=V.text(),Z=U.text(),$=T.text(),ba=n.parse(w('({1})^2-3*({0})*({2})',X,Y,Z)),ca=n.parse(w('((2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3}))^2-4*(({1})^2-3*({0})*({2}))^3)^(1/2)',X,Y,Z,$)),da=n.parse(w('((1/2)*(({4})+2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3})))^(1/3)',X,Y,Z,$,ca)),ea={};F(da).map(function(ha){ea[ha]=1});var fa=h.Utils.block('PARSE2NUMBER',function(){return n.parse(da,ea)});0===+ba&&0===+fa&&(da=n.parse(w('((1/2)*(-({4})+2*({1})^3-9*({0})*({1})*({2})+27*({0})^2*({3})))^(1/3)',X,Y,Z,$,ca)));var ga=['-(b/(3*a))-C/(3*a)-(((b^2-3*a*c))/(3*a*C))','-(b/(3*a))+(C*(1+i*sqrt(3)))/(6*a)+((1-i*sqrt(3))*(b^2-3*a*c))/6*a*C'.replace(/i/g,h.Settings.IMAGINARY),'-(b/(3*a))+(C*(1-i*sqrt(3)))/(6*a)+((1+i*sqrt(3))*(b^2-3*a*c))/(6*a*C)'.replace(/i/g,h.Settings.IMAGINARY)];return ga.map(function(ha){return n.parse(ha,{a:W.clone(),b:V.clone(),c:U.clone(),d:T.clone(),C:da.clone()})})},O=function(T,U){U=U.toString();var V=h.Utils.isSymbol(T)?T:J(T),W=o.Factor.factor(V),X=[];return W.each(function(Y){P(Y.arg?Y.args[0]:Y,U).map(function($){X.push($)})}),new h.Vector(X)},P=function(T,U,V){if(U=U||'x',I(T))return K.apply(void 0,arguments);V=V||[];var W={},X=function(ka,la){var ma=E(ka);if(!(void 0===ka||'number'==typeof ka&&isNaN(ka)))if(I(ka))V=V.concat(ka);else if('null'!==ka.valueOf()){if(ma||(ka=n.parse(ka)),h.Settings.make_pi_conversions&&la){var na=n.divide(ka.clone(),new B(Math.PI)),oa=na.multiplier,pa=_Mathabs(oa.num),qa=_Mathabs(oa.den);10>pa&&10>qa&&(ka=n.multiply(na,new B('pi')))}var ra=ka.toString();W[ra]||V.push(ka),W[ra]=!0}},Y=function(ka){var la=A(ka),ma=Math.round(la(0)),na=la(ma),oa=na/_Mathabs(na),pa=[],qa=h.Settings.roots_per_side;pa.push(Math.floor(ma/2));for(var sa=ma;sa<h.Settings.solve_radius;sa++){var ta=la(sa),ua=ta/_Mathabs(ta);if(isNaN(ta)||!isFinite(ta)||pa.length>qa)break;ua!=oa&&pa.push((sa-1)/2),oa=ua}for(var sa=ma-1;sa>-h.Settings.solve_radius;sa--){var ta=la(sa),ua=ta/_Mathabs(ta);if(isNaN(ta)||!isFinite(ta)||pa.length>2*qa+1)break;ua!=oa&&pa.push((sa-1)/2),oa=ua}return pa},Z=function(ka,la,ma){var qa,oa=0,pa=ka;do{if(oa++,oa>200)return;qa=pa-la(pa)/ma(pa);var ra=_Mathabs(qa-pa);pa=qa}while(ra>Number.EPSILON);return qa},aa=h.Utils.isSymbol(T)?T:J(T),ba=h.Utils.variables(aa),ca=ba.length;if(aa.group===G||aa.group===H&&aa.contains(U))return[new B(0)];var ea,da={},fa=function(ka){if(ka.symbols)for(var la in ka.symbols){var ma=ka.symbols[la],na=t(ma,U),oa=na[1].fname===h.Settings.SQRT,pa=B.unwrapSQRT(na[1]),qa=pa.power.clone();if(!E(qa))if(qa.den.gt(1)){if(oa)return ka=n.subtract(ka,ma.clone()),ka=n.add(ka,n.multiply(na[0],pa)),fa(ka);var ra=da[qa.den];da[qa.den]=ra?ra++:1}else if(-1===qa.sign()){var sa=n.parse(U+'^'+_Mathabs(qa));return ka.each(function(ta,ua){ta.contains(U)&&(ka.symbols[ua]=n.multiply(ta,sa.clone()))}),da={},fa(n.parse(ka))}}return ka};aa=fa(aa);var ga=h.Utils.keys(da);if(1===ga.length&&(ea=ga[0],aa.each(function(ka,la){if(ka.contains(U)){var ma=t(ka,U),na=ma[1],oa=na.power;oa.den.gt(1)&&(na.power=oa.multiply(new h.Frac(ea)),aa.symbols[la]=n.multiply(na,ma[0]))}}),aa=n.parse(aa)),1===ca){if(aa.isPoly(!0)){var ha=h.Utils.getCoeffs(aa,U),ia=ha.length-1;ba[0]===U&&(1==ia?X(n.divide(ha[0],ha[1].negate())):2==ia?(X(n.expand(L.apply(void 0,ha))),ha.push('-'),X(n.expand(L.apply(void 0,ha)))):3==ia?X(M.apply(void 0,ha)):o.proots(aa).map(X))}else(function(ka){for(var ra,la=ka.hasTrig(),ma=Y(ka),na=ma.length,oa=A(ka.clone()),pa=A(s.diff(ka.clone())),qa=0;qa<na;qa++)ra=ma[qa],X(Z(ra,oa,pa),la);V.sort()})(aa);}else if(!aa.hasFunc(U)&&aa.isComposite())try{var ha=h.Utils.getCoeffs(aa,U),ja=ha.length,ia=ja-1;1==ia?X(n.divide(ha[0],ha[1].negate())):2==ia?(X(L.apply(void 0,ha)),ha.push('-'),X(L.apply(void 0,ha))):3==ia?X(M.apply(void 0,ha)):void 0}catch(ka){}return ea&&(V=V.map(function(ka){return n.pow(ka,new B(ea))})),V};h.Expression.prototype.solveFor=function(T){return P(h.Utils.isSymbol(this.symbol)?this.symbol:this.symbol.toLHS(),T)},h.Expression.prototype.expand=function(){if(this.symbol instanceof g){var T=this.symbol.clone();return T.RHS=n.expand(T.RHS),T.LHS=n.expand(T.LHS),new h.Expression(T)}return new h.Expression(n.expand(this.symbol))},h.Expression.prototype.variables=function(){return this.symbol instanceof g?h.Utils.arrayUnique(F(this.symbol.LHS).concat(F(this.symbol.RHS))):F(this.symbol)};var R=function(T,U){return n.equals(T,U)};nerdamer.register([{name:'solveEquations',parent:'nerdamer',visible:!0,build:function(){return P}},{name:'solve',parent:'Solve',visible:!0,build:function(){return h.Solve.solve}},{name:'polysolve',parent:'Solve',visible:!0,build:function(){return O}},{name:'setEquation',parent:'Solve',visible:!0,build:function(){return R}}]),nerdamer.api()}();