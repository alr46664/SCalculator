importScripts('../../lib/math.min.js'),importScripts('../../lib/nerdamer/nerdamer.bundle.min.js');class Exception{constructor(c){this.msg='Exception: '+c}toString(){return this.msg}}class SimbolicException extends Exception{constructor(c){super(c),this.msg='Simbolic'+this.msg}}const mathScope={},mathTex={handler:{}};(function(){const c={ans:0,sigma:5.67037321e-8,R:8.314462175,k:1.380648813e-23,N_A:6.0221412927e23,a_0:5.291772109217e-11,c:299792458,G_0:7.748091734625e-5,u_B:9.274009682e-24,h:6.626069311e-34,h_r:1.05457172647e-34,u_o:1.2566370614e-6,u_n:5.0507835311e-27,f_0:2.06783375846e-15,r_k:25812.807443484,G:6.67428e-11,G_f:1.1663645e-5,m_e:9.109382914e-31,m_p:1.67262177774e-27,m_d:3.3435830926e-27,m_n:1.6749271613e-27,light_distance:9460730472580800,q:1.60217653e-19,e_0:8.854187817e-12,Z_0:376.730313461,ln2:0.6931471805599453,ln10:2.302585092994046,log2e:1.4426950408889634,log10e:0.4342944819032518,sqrt1_2:0.7071067811865476,sqrt2:1.4142135623730951,eqsolve:(g,i,j)=>i.parse('['+nerdamer.solveEquations(g[0].toString().replace('==','='),g[1].toString()).toString()+']',j),div:(g,i,j)=>i.parse(nerdamer.divide(g[0].toString(),g[1].toString()).toString(),j),roots:(g,i,j)=>i.parse(nerdamer.roots(g[0].toString()).toString(),j),factor:(g,i,j)=>i.parse(nerdamer.factor(g[0].toString()).toString(),j),diff:(g,i,j)=>i.parse(nerdamer.diff(g[0].toString(),g[1].toString()).toString(),j),integrate:(g,i,j)=>{const k=nerdamer.integrate(g[0].toString(),g[1].toString());if(k.hasIntegral())throw new SimbolicException('Could not perform indefinite integration in the expression');return i.parse(k.toString(),j)},int(g,i,j,k=150){const l=(g(i)+g(j))/2,m=(j-i)/k,n=math.multiply(math.range(1,k,!1),m);return m*(l+math.sum(math.add(n,i).map((o)=>g(o))))},der(g,i,j=1e-6){return(g(i+j)-g(i-j))/(2*j)},lim(g,i,j=2,k=1e-300){let l;return l=0===j?g(i-k):1===j?g(i+k):(g(i+k)+g(i-k))/2,l},eqroot(g,i,j,k=1e-6){let l=500,m=i;const n=(p,q)=>(g(p)-g(q))/(p-q),o=(p,q)=>p-g(p)/n(p,q);for(;Math.abs(g(m))>k&&0<l;)m=o(i,j),j=i,i=m,--l;return m}};c.eqsolve.rawArgs=!0,c.div.rawArgs=!0,c.roots.rawArgs=!0,c.factor.rawArgs=!0,c.diff.rawArgs=!0,c.integrate.rawArgs=!0;const d=function(g){const i=g.indexOf(':=');return-1===i?g.trim()+'(x)':g.substr(i+2).trim()};c.eqsolve.toTex=function(g,i){const[j,k]=g.args;return'\\left.'+j.toTex(i)+' = 0\\right\\rvert_{'+k.toTex(i)+'}'},c.div.toTex=function(g,i){const[j,k]=g.args;return'\\frac{'+j.toTex(i)+'}{'+k.toTex(i)+'}'},c.roots.toTex=function(g,i){const[j]=g.args;return j.toTex(i)+' = 0'},c.diff.toTex=function(g,i){const[j,k]=g.args;return'\\frac{d('+j.toTex(i)+')}{d'+k.toTex(i)+'}'},c.integrate.toTex=function(g,i){const[j,k]=g.args;return'\\int('+j.toTex(i)+') d'+k.toTex(i)},c.int.toTex=function(g,i){const[j,k,l]=g.args,m=d(j.toTex(i));return'\\int_{'+k.toTex(i)+'}^{'+l.toTex(i)+'} ('+m+') dx'},c.der.toTex=function(g,i){const[j,k]=g.args,l=d(j.toTex(i));return'\\left.\\frac{d'+l+'}{dx}\\right\\rvert_{'+k.toTex(i)+'}'},c.lim.toTex=function(g,i){const[j,k]=g.args,l=d(j.toTex(i));let m='';if(g.args[2])switch(g.args[2].toString()){case'0':m='-';break;case'1':m='+';break;case'2':m='';break;default:m=g.args[2].toTex(i);}return'\\lim_{x\\to'+m+' '+k.toTex(i)+'} '+l},c.eqroot.toTex=function(g,i){const[j,k,l]=g.args,m=d(j.toTex(i));return'\\left.'+m+' = 0\\right\\rvert_{'+k.toTex(i)+'}^{'+l.toTex(i)+'}'},math.import(c)})(),self.addEventListener('message',function(c){const{id:d,expr:g,op:i}=JSON.parse(c.data),j={id:d,expr:g,op:i,result:''};try{const k=math.parse(g,mathScope);switch(i){case'parse':j.exprLatex=k.toTex(mathTex);break;default:mathScope.ans=k.eval(mathScope),j.result=math.format(mathScope.ans,{precision:14}).toString(),j.resultLatex=math.parse(j.result,mathScope).toTex(mathTex),j.exprLatex=k.toTex(mathTex);}}catch(k){j.err=k+'',console.log(j.err)}self.postMessage(JSON.stringify(j))},!1);